import{r as j,j as e,X as Be,S as De,b as Ne,U as Re,C as qe,D as oe,c as ns,L as ge,d as ze,e as Qs,T as Ys,I as rt,f as ks,g as Hs,h as it,i as Gs,P as ct,k as Ws,V as dt,l as Js,m as Xs,n as ot,o as As,p as xt,q as Zs,s as ht,t as mt,O as is,u as ea,v as cs,w as sa,x as ds,y as os,z as aa,B as ta,E as na,F as la,G as ut,H as ce,J as L,K as Z,M as xe,N as Qe,Q as Ie,W as Ve,Y as ye,Z as Ge,_ as Ye,$ as He,a0 as Ds,a1 as ra,a2 as Fs,a3 as gt,a4 as Os,a5 as be,a6 as Se,a7 as ia,a8 as Me,a9 as fe,aa as pt,ab as Oe,ac as we,ad as Ke,ae as ca,af as qs,ag as ls,ah as da,ai as Ce,aj as We,ak as jt,al as bt,am as vt,an as ft,ao as oa,ap as xa,aq as yt,ar as _t,as as Nt,at as wt,au as Ct,av as ha,aw as St,ax as ma,ay as kt,az as At,aA as Dt,aB as Ms,aC as Ft,aD as Ot,aE as qt,aF as Es,aG as Et,aH as Pt,aI as It,aJ as Tt,aK as Rt,aL as Mt,aM as Bt,aN as zt,aO as ps,aP as Lt}from"./react-vendor-DRavjJvk.js";import{al as ua,J as $t,am as Le,an as Vt,ao as Kt}from"./vendor-BBStssy-.js";import{R as es,L as Ut,C as js,X as bs,Y as vs,T as ss,a as Bs,b as fs,B as zs,c as ys,P as Qt,d as Yt,e as Ht}from"./recharts-CvFio826.js";import"./lodash-KZt5jtV-.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const x of o.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&r(x)}).observe(document,{childList:!0,subtree:!0});function a(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=a(s);fetch(s.href,o)}})();const Gt=20,Wt=1e6,Ae={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"};let _s=0;function Jt(){return _s=(_s+1)%Number.MAX_VALUE,_s.toString()}const Ns=new Map,Ls=n=>{if(Ns.has(n))return;const l=setTimeout(()=>{Ns.delete(n),Ue({type:Ae.REMOVE_TOAST,toastId:n})},Wt);Ns.set(n,l)},Xt=(n,l)=>{switch(l.type){case Ae.ADD_TOAST:return{...n,toasts:[l.toast,...n.toasts].slice(0,Gt)};case Ae.UPDATE_TOAST:return{...n,toasts:n.toasts.map(a=>a.id===l.toast.id?{...a,...l.toast}:a)};case Ae.DISMISS_TOAST:{const{toastId:a}=l;return a?Ls(a):n.toasts.forEach(r=>{Ls(r.id)}),{...n,toasts:n.toasts.map(r=>r.id===a||a===void 0?{...r,open:!1}:r)}}case Ae.REMOVE_TOAST:return l.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(a=>a.id!==l.toastId)}}},as=[];let ts={toasts:[]};function Ue(n){ts=Xt(ts,n),as.forEach(l=>{l(ts)})}function Zt({...n}){const l=Jt(),a=s=>Ue({type:Ae.UPDATE_TOAST,toast:{...s,id:l}}),r=()=>Ue({type:Ae.DISMISS_TOAST,toastId:l});return Ue({type:Ae.ADD_TOAST,toast:{...n,id:l,open:!0,onOpenChange:s=>{s||r()}}}),{id:l,dismiss:r,update:a}}function en(){const[n,l]=j.useState(ts);return j.useEffect(()=>(as.push(l),()=>{const a=as.indexOf(l);a>-1&&as.splice(a,1)}),[n]),{...n,toast:Zt,dismiss:a=>Ue({type:Ae.DISMISS_TOAST,toastId:a})}}function $(...n){return ua($t(n))}const ga=j.forwardRef(({...n},l)=>e.jsx("div",{ref:l,className:"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",...n}));ga.displayName="ToastProvider";const pa=j.forwardRef(({...n},l)=>e.jsx("div",{ref:l,className:"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",...n}));pa.displayName="ToastViewport";const sn=Le("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ja=j.forwardRef(({className:n,variant:l,...a},r)=>e.jsx("div",{ref:r,className:$(sn({variant:l}),n),...a}));ja.displayName="Toast";const an=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",n),...l}));an.displayName="ToastAction";const ba=j.forwardRef(({className:n,...l},a)=>e.jsx("button",{ref:a,className:$("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",n),"toast-close":"",...l,children:e.jsx(Be,{className:"h-4 w-4"})}));ba.displayName="ToastClose";const va=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("text-sm font-semibold",n),...l}));va.displayName="ToastTitle";const fa=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("text-sm opacity-90",n),...l}));fa.displayName="ToastDescription";function tn(){const{toasts:n}=en();return e.jsxs(ga,{children:[n.map(function({id:l,title:a,description:r,action:s,...o}){return e.jsxs(ja,{...o,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(va,{children:a}),r&&e.jsx(fa,{children:r})]}),s,e.jsx(ba,{})]},l)}),e.jsx(pa,{})]})}const nn=new Vt({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function ln(){const[n,l]=j.useState(!1),a=j.useRef(!1),[r,s]=j.useState(!1),o=j.useRef(!1),[x,O]=j.useState(!1),u=j.useRef(!1),d=j.useRef([]),D=j.useRef([]),g=j.useRef([]),m=j.useRef(null),f=(R=!1)=>{const w=document.createElement("div");return w.style.position="absolute",w.style.pointerEvents="none",w.style.transition="all 0.1s ease-in-out",w.style.zIndex="9999",R?w.style.border="2px solid #2563EB":(w.style.border="2px solid #95a5fc",w.style.backgroundColor="rgba(99, 102, 241, 0.05)"),w},v=(R,w,A=!1)=>{if(!w||!a.current)return;w.offsetWidth;const V=w.getBoundingClientRect();R.style.top=`${V.top+window.scrollY}px`,R.style.left=`${V.left+window.scrollX}px`,R.style.width=`${V.width}px`,R.style.height=`${V.height}px`;let M=R.querySelector("div");M||(M=document.createElement("div"),M.textContent=w.tagName.toLowerCase(),M.style.position="absolute",M.style.top="-27px",M.style.left="-2px",M.style.padding="2px 8px",M.style.fontSize="11px",M.style.fontWeight=A?"500":"400",M.style.color=A?"#ffffff":"#526cff",M.style.backgroundColor=A?"#526cff":"#DBEAFE",M.style.borderRadius="3px",M.style.boxShadow="none",M.style.minWidth="24px",M.style.textAlign="center",R.appendChild(M))},q=R=>{if(!R)return[];const w=[...document.querySelectorAll(`[data-source-location="${R}"]`)];return w.length>0?w:[...document.querySelectorAll(`[data-visual-selector-id="${R}"]`)]},N=()=>{d.current.forEach(R=>{R&&R.parentNode&&R.remove()}),d.current=[],g.current=[]},b=R=>{if(!a.current||o.current)return;if(u.current){N();return}if(R.target.tagName.toLowerCase()==="path"){N();return}const w=R.target.closest("[data-source-location], [data-visual-selector-id]");if(!w){N();return}const A=w.dataset.sourceLocation||w.dataset.visualSelectorId;if(w.dataset.sourceLocation,m.current===A){N();return}const V=q(A);N(),V.forEach(M=>{const y=f(!1);document.body.appendChild(y),d.current.push(y),v(y,M)}),g.current=V},t=()=>{o.current||N()},c=R=>{var G;if(!a.current)return;if(u.current){R.preventDefault(),R.stopPropagation(),R.stopImmediatePropagation(),window.parent.postMessage({type:"close-dropdowns"},"*");return}if(R.target.tagName.toLowerCase()==="path")return;R.preventDefault(),R.stopPropagation(),R.stopImmediatePropagation();const w=R.target.closest("[data-source-location], [data-visual-selector-id]");if(!w)return;const A=w.dataset.sourceLocation||w.dataset.visualSelectorId;w.dataset.sourceLocation,D.current.forEach(te=>{te&&te.parentNode&&te.remove()}),D.current=[],q(A).forEach(te=>{const ee=f(!0);document.body.appendChild(ee),D.current.push(ee),v(ee,te,!0)}),m.current=A,N();const M=w.getBoundingClientRect(),y={top:M.top,left:M.left,right:M.right,bottom:M.bottom,width:M.width,height:M.height,centerX:M.left+M.width/2,centerY:M.top+M.height/2},K={type:"element-selected",tagName:w.tagName,classes:((G=w.className)==null?void 0:G.baseVal)||w.className||"",visualSelectorId:A,content:w.innerText,dataSourceLocation:w.dataset.sourceLocation,isDynamicContent:w.dataset.dynamicContent==="true",linenumber:w.dataset.linenumber,filename:w.dataset.filename,position:y};window.parent.postMessage(K,"*")},p=()=>{D.current.forEach(R=>{R&&R.parentNode&&R.remove()}),D.current=[],m.current=null},z=(R,w,A=!1)=>{const V=q(R);V.length!==0&&(V.forEach(M=>{var y;if(A)M.className=w;else{const K=((y=M.className)==null?void 0:y.baseVal)||M.className||"";M.className=ua(K,w)}}),setTimeout(()=>{var M,y;m.current===R&&D.current.forEach((K,G)=>{G<V.length&&v(K,V[G])}),g.current.length>0&&((y=(M=g.current[0])==null?void 0:M.dataset)==null?void 0:y.visualSelectorId)===R&&d.current.forEach((G,te)=>{te<g.current.length&&v(G,g.current[te])})},50))},P=(R,w)=>{const A=q(R);A.length!==0&&(A.forEach(V=>{V.innerText=w}),setTimeout(()=>{m.current===R&&D.current.forEach((V,M)=>{M<A.length&&v(V,A[M])})},50))},F=R=>{l(R),a.current=R,R?(document.body.style.cursor="crosshair",document.addEventListener("mouseover",b),document.addEventListener("mouseout",t),document.addEventListener("click",c,!0)):(N(),D.current.forEach(w=>{w&&w.parentNode&&w.remove()}),D.current=[],g.current=[],m.current=null,document.body.style.cursor="default",document.removeEventListener("mouseover",b),document.removeEventListener("mouseout",t),document.removeEventListener("click",c,!0))};return j.useEffect(()=>{document.querySelectorAll("[data-linenumber]:not([data-visual-selector-id])").forEach((V,M)=>{const y=`visual-id-${V.dataset.filename}-${V.dataset.linenumber}-${M}`;V.dataset.visualSelectorId=y});const w=()=>{if(m.current){const V=q(m.current);if(V.length>0){const y=V[0].getBoundingClientRect(),K=window.innerHeight,G=window.innerWidth,te=y.top<K&&y.bottom>0&&y.left<G&&y.right>0,ee={top:y.top,left:y.left,right:y.right,bottom:y.bottom,width:y.width,height:y.height,centerX:y.left+y.width/2,centerY:y.top+y.height/2};window.parent.postMessage({type:"element-position-update",position:ee,isInViewport:te,visualSelectorId:m.current},"*")}}},A=V=>{const M=V.data;switch(M.type){case"toggle-visual-edit-mode":F(M.data.enabled);break;case"update-classes":M.data&&M.data.classes!==void 0?z(M.data.visualSelectorId,M.data.classes,M.data.replace||!1):console.warn("[Agent] Invalid update-classes message:",M);break;case"unselect-element":p();break;case"refresh-page":window.location.reload();break;case"update-content":M.data&&M.data.content!==void 0?P(M.data.visualSelectorId,M.data.content):console.warn("[Agent] Invalid update-content message:",M);break;case"request-element-position":if(m.current){const y=q(m.current);if(y.length>0){const G=y[0].getBoundingClientRect(),te=window.innerHeight,ee=window.innerWidth,B=G.top<te&&G.bottom>0&&G.left<ee&&G.right>0,se={top:G.top,left:G.left,right:G.right,bottom:G.bottom,width:G.width,height:G.height,centerX:G.left+G.width/2,centerY:G.top+G.height/2};window.parent.postMessage({type:"element-position-update",position:se,isInViewport:B,visualSelectorId:m.current},"*")}}break;case"popover-drag-state":M.data&&M.data.isDragging!==void 0&&(s(M.data.isDragging),o.current=M.data.isDragging,M.data.isDragging&&N());break;case"dropdown-state":M.data&&M.data.isOpen!==void 0&&(O(M.data.isOpen),u.current=M.data.isOpen,M.data.isOpen&&N());break}};return window.addEventListener("message",A),window.addEventListener("scroll",w,!0),document.addEventListener("scroll",w,!0),window.parent.postMessage({type:"visual-edit-agent-ready"},"*"),()=>{window.removeEventListener("message",A),window.removeEventListener("scroll",w,!0),document.removeEventListener("scroll",w,!0),document.removeEventListener("mouseover",b),document.removeEventListener("mouseout",t),document.removeEventListener("click",c,!0),N(),D.current.forEach(V=>{V&&V.parentNode&&V.remove()})}},[]),j.useEffect(()=>{a.current=n},[n]),j.useEffect(()=>{o.current=r},[r]),j.useEffect(()=>{u.current=x},[x]),j.useEffect(()=>{const R=()=>{if(m.current){const A=q(m.current);D.current.forEach((V,M)=>{M<A.length&&v(V,A[M])})}g.current.length>0&&d.current.forEach((A,V)=>{V<g.current.length&&v(A,g.current[V])})},w=new MutationObserver(A=>{A.some(M=>{const y=G=>{if(G.nodeType===Node.ELEMENT_NODE){if(G.dataset&&G.dataset.visualSelectorId)return!0;for(let te=0;te<G.children.length;te++)if(y(G.children[te]))return!0}return!1};return M.type==="attributes"&&(M.attributeName==="style"||M.attributeName==="class"||M.attributeName==="width"||M.attributeName==="height")&&y(M.target)})&&setTimeout(R,50)});return w.observe(document.body,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["style","class","width","height"]}),window.addEventListener("resize",R),window.addEventListener("scroll",R),()=>{window.removeEventListener("resize",R),window.removeEventListener("scroll",R),w.disconnect()}},[]),null}const $e=Kt.create({baseURL:"http://localhost:3000/api",headers:{"Content-Type":"application/json"}}),Te=n=>({list:async l=>(await $e.get(`/${n}`)).data,create:async l=>(await $e.post(`/${n}`,l)).data,update:async(l,a)=>(await $e.put(`/${n}/${l}`,a)).data,delete:async l=>(await $e.delete(`/${n}/${l}`)).data,get:async l=>(await $e.get(`/${n}/${l}`)).data}),k={entities:{Booking:Te("bookings"),Employee:Te("employees"),Yacht:Te("yachts"),Package:Te("packages"),Agent:Te("agents"),User:Te("users")},auth:{me:async()=>({id:1,username:"admin",email:"admin@example.com",role:"admin"}),logout:n=>{console.log("Logging out..."),n&&(window.location.href=n)},redirectToLogin:n=>{console.log("Redirecting to login...",n)}}},ya=j.createContext(),rn=({children:n})=>{const[l,a]=j.useState(null),[r,s]=j.useState(!1),[o,x]=j.useState(!0),[O,u]=j.useState(!1),[d,D]=j.useState(null),[g,m]=j.useState(null);j.useEffect(()=>{f()},[]);const f=async()=>{try{x(!0);const b=await k.auth.me();a(b),s(!0),x(!1)}catch(b){console.error("User auth check failed:",b),x(!1),s(!1)}},v=(b=!0)=>{a(null),s(!1),k.auth.logout()},q=()=>{console.log("Navigate to login")},N=async()=>{};return e.jsx(ya.Provider,{value:{user:l,isAuthenticated:r,isLoadingAuth:o,isLoadingPublicSettings:O,authError:d,appPublicSettings:g,logout:v,navigateToLogin:q,checkAppState:N},children:n})},_a=()=>{const n=j.useContext(ya);if(!n)throw new Error("useAuth must be used within an AuthProvider");return n},I=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("rounded-xl border bg-card text-card-foreground shadow",n),...l}));I.displayName="Card";const W=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("flex flex-col space-y-1.5 p-6",n),...l}));W.displayName="CardHeader";const J=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("font-semibold leading-none tracking-tight",n),...l}));J.displayName="CardTitle";const cn=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("text-sm text-muted-foreground",n),...l}));cn.displayName="CardDescription";const T=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("p-6 pt-0",n),...l}));T.displayName="CardContent";const dn=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,className:$("flex items-center p-6 pt-0",n),...l}));dn.displayName="CardFooter";function de(n){return"/"+n.toLowerCase().replace(/ /g,"-")}function on(){const n=[{title:"CRM",icon:De,bgColor:"from-blue-500 to-blue-600",url:"CRMDashboard"},{title:"Purchase",icon:Ne,bgColor:"from-green-500 to-green-600",url:"PurchaseDashboard"},{title:"HRMS",icon:Re,bgColor:"from-purple-500 to-purple-600",url:"HRMDashboard"},{title:"POS",icon:qe,bgColor:"from-orange-500 to-orange-600",url:"POSDashboard"},{title:"Accounts",icon:oe,bgColor:"from-indigo-500 to-indigo-600",url:"AccountsDashboard"},{title:"Admin",icon:ns,bgColor:"from-red-500 to-red-600",url:"Users"}];return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"max-w-5xl mx-auto w-full",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h1",{className:"text-5xl md:text-6xl font-bold text-gray-900 mb-4",children:"YachtFlow"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Select an application"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:n.map((l,a)=>e.jsx(ge,{to:de(l.url),children:e.jsx(I,{className:"border-none shadow-lg hover:shadow-2xl transition-all duration-300 bg-white cursor-pointer group",children:e.jsxs(T,{className:"p-8 flex flex-col items-center text-center",children:[e.jsx("div",{className:`w-20 h-20 rounded-2xl bg-gradient-to-br ${l.bgColor} flex items-center justify-center mb-4 shadow-lg group-hover:scale-110 transition-transform duration-300`,children:e.jsx(l.icon,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:l.title})]})})},a))})]})})}const xn=Le("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),E=j.forwardRef(({className:n,variant:l,size:a,asChild:r=!1,...s},o)=>{const x=r?ze:"button";return e.jsx(x,{className:$(xn({variant:l,size:a,className:n})),ref:o,...s})});E.displayName="Button";const _=j.forwardRef(({className:n,type:l,...a},r)=>e.jsx("input",{type:l,className:$("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:r,...a}));_.displayName="Input";const hn=Le("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),i=j.forwardRef(({className:n,...l},a)=>e.jsx(Qs,{ref:a,className:$(hn(),n),...l}));i.displayName=Qs.displayName;const Y=ht,H=mt,U=j.forwardRef(({className:n,children:l,...a},r)=>e.jsxs(Ys,{ref:r,className:$("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...a,children:[l,e.jsx(rt,{asChild:!0,children:e.jsx(ks,{className:"h-4 w-4 opacity-50"})})]}));U.displayName=Ys.displayName;const Na=j.forwardRef(({className:n,...l},a)=>e.jsx(Hs,{ref:a,className:$("flex cursor-default items-center justify-center py-1",n),...l,children:e.jsx(it,{className:"h-4 w-4"})}));Na.displayName=Hs.displayName;const wa=j.forwardRef(({className:n,...l},a)=>e.jsx(Gs,{ref:a,className:$("flex cursor-default items-center justify-center py-1",n),...l,children:e.jsx(ks,{className:"h-4 w-4"})}));wa.displayName=Gs.displayName;const Q=j.forwardRef(({className:n,children:l,position:a="popper",...r},s)=>e.jsx(ct,{children:e.jsxs(Ws,{ref:s,className:$("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:a,...r,children:[e.jsx(Na,{}),e.jsx(dt,{className:$("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),e.jsx(wa,{})]})}));Q.displayName=Ws.displayName;const mn=j.forwardRef(({className:n,...l},a)=>e.jsx(Js,{ref:a,className:$("px-2 py-1.5 text-sm font-semibold",n),...l}));mn.displayName=Js.displayName;const h=j.forwardRef(({className:n,children:l,...a},r)=>e.jsxs(Xs,{ref:r,className:$("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...a,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ot,{children:e.jsx(As,{className:"h-4 w-4"})})}),e.jsx(xt,{children:l})]}));h.displayName=Xs.displayName;const un=j.forwardRef(({className:n,...l},a)=>e.jsx(Zs,{ref:a,className:$("-mx-1 my-1 h-px bg-muted",n),...l}));un.displayName=Zs.displayName;const ie=aa,gn=ea,Ca=j.forwardRef(({className:n,...l},a)=>e.jsx(is,{ref:a,className:$("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...l}));Ca.displayName=is.displayName;const ne=j.forwardRef(({className:n,children:l,...a},r)=>e.jsxs(gn,{children:[e.jsx(Ca,{}),e.jsxs(cs,{ref:r,className:$("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n),...a,children:[l,e.jsxs(sa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ne.displayName=cs.displayName;const le=({className:n,...l})=>e.jsx("div",{className:$("flex flex-col space-y-1.5 text-center sm:text-left",n),...l});le.displayName="DialogHeader";const re=j.forwardRef(({className:n,...l},a)=>e.jsx(ds,{ref:a,className:$("text-lg font-semibold leading-none tracking-tight",n),...l}));re.displayName=ds.displayName;const pn=j.forwardRef(({className:n,...l},a)=>e.jsx(os,{ref:a,className:$("text-sm text-muted-foreground",n),...l}));pn.displayName=os.displayName;const jn=Le("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function X({className:n,variant:l,...a}){return e.jsx("div",{className:$(jn({variant:l}),n),...a})}const ve=j.forwardRef(({className:n,...l},a)=>e.jsx("textarea",{className:$("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",n),ref:a,...l}));ve.displayName="Textarea";const Ps=ut,xs=j.forwardRef(({className:n,...l},a)=>e.jsx(ta,{ref:a,className:$("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",n),...l}));xs.displayName=ta.displayName;const Ee=j.forwardRef(({className:n,...l},a)=>e.jsx(na,{ref:a,className:$("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",n),...l}));Ee.displayName=na.displayName;const Pe=j.forwardRef(({className:n,...l},a)=>e.jsx(la,{ref:a,className:$("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...l}));Pe.displayName=la.displayName;function bn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState({yacht_name:"",cruise_type:"shared",capacity:"",description:"",status:"active",private_price:"0",shared_packages:{adult:"0",child:"0",alcohol_adult:"0",top_deck_child:"0",top_deck_adult:"0",top_deck_adult_alcohol:"0",child_vip:"0",adult_vip:"0",adult_alcohol_vip:"0",royal_child:"0",royal_adult:"0",royal_adult_alcohol:"0"}}),x=ce(),{data:O=[]}=L({queryKey:["yachts"],queryFn:()=>k.entities.Yacht.list()}),{data:u}=L({queryKey:["currentUser"],queryFn:()=>k.auth.me()}),d=(u==null?void 0:u.role)==="admin",D=Z({mutationFn:b=>k.entities.Yacht.create(b),onSuccess:()=>{x.invalidateQueries(["yachts"]),f()}}),g=Z({mutationFn:({id:b,data:t})=>k.entities.Yacht.update(b,t),onSuccess:()=>{x.invalidateQueries(["yachts"]),f()}}),m=Z({mutationFn:b=>k.entities.Yacht.delete(b),onSuccess:()=>{x.invalidateQueries(["yachts"])}}),f=()=>{o({yacht_name:"",cruise_type:"shared",capacity:"",description:"",status:"active",private_price:"0",shared_packages:{adult:"0",child:"0",alcohol_adult:"0",top_deck_child:"0",top_deck_adult:"0",top_deck_adult_alcohol:"0",child_vip:"0",adult_vip:"0",adult_alcohol_vip:"0",royal_child:"0",royal_adult:"0",royal_adult_alcohol:"0"}}),r(null),l(!1)},v=b=>{b.preventDefault();const t={yacht_name:s.yacht_name,cruise_type:s.cruise_type,capacity:parseInt(s.capacity),description:s.description,status:s.status,private_price:parseFloat(s.private_price),shared_packages:{adult:parseFloat(s.shared_packages.adult),child:parseFloat(s.shared_packages.child),alcohol_adult:parseFloat(s.shared_packages.alcohol_adult),top_deck_child:parseFloat(s.shared_packages.top_deck_child),top_deck_adult:parseFloat(s.shared_packages.top_deck_adult),top_deck_adult_alcohol:parseFloat(s.shared_packages.top_deck_adult_alcohol),child_vip:parseFloat(s.shared_packages.child_vip),adult_vip:parseFloat(s.shared_packages.adult_vip),adult_alcohol_vip:parseFloat(s.shared_packages.adult_alcohol_vip),royal_child:parseFloat(s.shared_packages.royal_child),royal_adult:parseFloat(s.shared_packages.royal_adult),royal_adult_alcohol:parseFloat(s.shared_packages.royal_adult_alcohol)}};a?g.mutate({id:a.id,data:t}):D.mutate(t)},q=b=>{var t,c,p,z,P,F,R,w,A,V,M,y,K,G,te,ee,B,se,pe,je,_e,ke,Fe,Je,Xe,Ze;r(b),o({yacht_name:b.yacht_name,cruise_type:b.cruise_type,capacity:((t=b.capacity)==null?void 0:t.toString())||"",description:b.description||"",status:b.status,private_price:((c=b.private_price)==null?void 0:c.toString())||"0",shared_packages:{adult:((z=(p=b.shared_packages)==null?void 0:p.adult)==null?void 0:z.toString())||"0",child:((F=(P=b.shared_packages)==null?void 0:P.child)==null?void 0:F.toString())||"0",alcohol_adult:((w=(R=b.shared_packages)==null?void 0:R.alcohol_adult)==null?void 0:w.toString())||"0",top_deck_child:((V=(A=b.shared_packages)==null?void 0:A.top_deck_child)==null?void 0:V.toString())||"0",top_deck_adult:((y=(M=b.shared_packages)==null?void 0:M.top_deck_adult)==null?void 0:y.toString())||"0",top_deck_adult_alcohol:((G=(K=b.shared_packages)==null?void 0:K.top_deck_adult_alcohol)==null?void 0:G.toString())||"0",child_vip:((ee=(te=b.shared_packages)==null?void 0:te.child_vip)==null?void 0:ee.toString())||"0",adult_vip:((se=(B=b.shared_packages)==null?void 0:B.adult_vip)==null?void 0:se.toString())||"0",adult_alcohol_vip:((je=(pe=b.shared_packages)==null?void 0:pe.adult_alcohol_vip)==null?void 0:je.toString())||"0",royal_child:((ke=(_e=b.shared_packages)==null?void 0:_e.royal_child)==null?void 0:ke.toString())||"0",royal_adult:((Je=(Fe=b.shared_packages)==null?void 0:Fe.royal_adult)==null?void 0:Je.toString())||"0",royal_adult_alcohol:((Ze=(Xe=b.shared_packages)==null?void 0:Xe.royal_adult_alcohol)==null?void 0:Ze.toString())||"0"}}),l(!0)},N={active:"bg-green-100 text-green-700",inactive:"bg-gray-100 text-gray-700",maintenance:"bg-yellow-100 text-yellow-700"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Yachts & Packages"}),e.jsx("p",{className:"text-gray-600",children:"Manage yacht fleet with integrated pricing"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Yacht"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.map(b=>e.jsxs(I,{className:"border-none shadow-lg hover:shadow-xl transition-all",children:[e.jsx(W,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(J,{className:"text-xl",children:b.yacht_name}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(X,{className:"bg-blue-100 text-blue-700 capitalize",children:b.cruise_type}),e.jsx(X,{className:N[b.status],children:b.status})]})]}),e.jsx(De,{className:"w-8 h-8 text-blue-600"})]})}),e.jsxs(T,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:b.description||"No description"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Capacity:"}),e.jsxs("span",{className:"font-semibold",children:[b.capacity," guests"]})]}),b.cruise_type==="private"&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Private Price:"}),e.jsxs("span",{className:"font-semibold",children:["$",b.private_price]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(E,{size:"sm",variant:"outline",onClick:()=>q(b),className:"flex-1",children:[e.jsx(Qe,{className:"w-4 h-4 mr-1"}),"Edit"]}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>m.mutate(b.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Ie,{className:"w-4 h-4"})})]})]})]},b.id))}),O.length===0&&e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-20 text-center",children:[e.jsx(De,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No yachts yet"}),e.jsx("p",{className:"text-gray-500",children:"Add your first yacht to get started"})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Yacht":"Add New Yacht"})}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Yacht Name *"}),e.jsx(_,{value:s.yacht_name,onChange:b=>o({...s,yacht_name:b.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Cruise Type *"}),e.jsxs(Y,{value:s.cruise_type,onValueChange:b=>o({...s,cruise_type:b}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"shared",children:"Shared"}),e.jsx(h,{value:"private",children:"Private"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Capacity *"}),e.jsx(_,{type:"number",value:s.capacity,onChange:b=>o({...s,capacity:b.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:s.status,onValueChange:b=>o({...s,status:b}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"inactive",children:"Inactive"}),e.jsx(h,{value:"maintenance",children:"Maintenance"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Description"}),e.jsx(ve,{value:s.description,onChange:b=>o({...s,description:b.target.value}),rows:3})]}),e.jsxs(Ps,{defaultValue:s.cruise_type,value:s.cruise_type,children:[e.jsxs(xs,{className:"grid w-full grid-cols-2",children:[e.jsx(Ee,{value:"shared",children:"Shared Packages"}),e.jsx(Ee,{value:"private",children:"Private Pricing"})]}),e.jsxs(Pe,{value:"shared",className:"space-y-4",children:[!d&&e.jsx("p",{className:"text-xs text-red-600 mb-2",children:"Pricing fields are admin-only"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Adult"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.adult,onChange:b=>o({...s,shared_packages:{...s.shared_packages,adult:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Child"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.child,onChange:b=>o({...s,shared_packages:{...s.shared_packages,child:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Alcohol Adult"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.alcohol_adult,onChange:b=>o({...s,shared_packages:{...s.shared_packages,alcohol_adult:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Top Deck Child"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.top_deck_child,onChange:b=>o({...s,shared_packages:{...s.shared_packages,top_deck_child:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Top Deck Adult"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.top_deck_adult,onChange:b=>o({...s,shared_packages:{...s.shared_packages,top_deck_adult:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Top Deck Adult Alcohol"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.top_deck_adult_alcohol,onChange:b=>o({...s,shared_packages:{...s.shared_packages,top_deck_adult_alcohol:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Child VIP"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.child_vip,onChange:b=>o({...s,shared_packages:{...s.shared_packages,child_vip:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Adult VIP"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.adult_vip,onChange:b=>o({...s,shared_packages:{...s.shared_packages,adult_vip:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Adult Alcohol VIP"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.adult_alcohol_vip,onChange:b=>o({...s,shared_packages:{...s.shared_packages,adult_alcohol_vip:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Royal Child"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.royal_child,onChange:b=>o({...s,shared_packages:{...s.shared_packages,royal_child:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Royal Adult"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.royal_adult,onChange:b=>o({...s,shared_packages:{...s.shared_packages,royal_adult:b.target.value}}),disabled:!d})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Royal Adult Alcohol"}),e.jsx(_,{type:"number",step:"0.01",value:s.shared_packages.royal_adult_alcohol,onChange:b=>o({...s,shared_packages:{...s.shared_packages,royal_adult_alcohol:b.target.value}}),disabled:!d})]})]})]}),e.jsx(Pe,{value:"private",children:e.jsxs("div",{children:[e.jsx(i,{children:"Private Cruise Price"}),e.jsx(_,{type:"number",step:"0.01",value:s.private_price,onChange:b=>o({...s,private_price:b.target.value}),disabled:!d}),!d&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Admin only"})]})})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:f,children:"Cancel"}),e.jsxs(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[a?"Update":"Create"," Yacht"]})]})]})]})})]})})}function vn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState({yacht_id:"",package_name:"",package_type:"private",duration_hours:"",base_price:"",description:"",max_guests:""}),x=ce(),{data:O=[]}=L({queryKey:["packages"],queryFn:()=>k.entities.Package.list("-created_date")}),{data:u=[]}=L({queryKey:["yachts"],queryFn:()=>k.entities.Yacht.list()}),{data:d}=L({queryKey:["currentUser"],queryFn:()=>k.auth.me()}),D=(d==null?void 0:d.role)==="admin",g=Z({mutationFn:c=>k.entities.Package.create(c),onSuccess:()=>{x.invalidateQueries(["packages"]),v()}}),m=Z({mutationFn:({id:c,data:p})=>k.entities.Package.update(c,p),onSuccess:()=>{x.invalidateQueries(["packages"]),v()}}),f=Z({mutationFn:c=>k.entities.Package.delete(c),onSuccess:()=>{x.invalidateQueries(["packages"])}}),v=()=>{o({yacht_id:"",package_name:"",package_type:"private",duration_hours:"",base_price:"",description:"",max_guests:""}),r(null),l(!1)},q=c=>{c.preventDefault();const p={...s,duration_hours:parseFloat(s.duration_hours),base_price:parseFloat(s.base_price),max_guests:s.max_guests?parseInt(s.max_guests):void 0};a?m.mutate({id:a.id,data:p}):g.mutate(p)},N=c=>{var p;r(c),o({yacht_id:c.yacht_id,package_name:c.package_name,package_type:c.package_type,duration_hours:c.duration_hours.toString(),base_price:c.base_price.toString(),description:c.description||"",max_guests:((p=c.max_guests)==null?void 0:p.toString())||""}),l(!0)},b=c=>{const p=u.find(z=>z.id===c);return(p==null?void 0:p.yacht_name)||"Unknown"},t={private:"bg-purple-100 text-purple-800 border-purple-200",shared:"bg-blue-100 text-blue-800 border-blue-200",sunset:"bg-orange-100 text-orange-800 border-orange-200"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Packages"}),e.jsx("p",{className:"text-gray-600",children:"Manage yacht packages and pricing"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Package"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.map(c=>e.jsxs(I,{className:"hover:shadow-xl transition-all duration-300 border-none",children:[e.jsxs(W,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx(J,{className:"text-xl",children:c.package_name}),e.jsx(X,{className:`${t[c.package_type]} border`,children:c.package_type})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{children:b(c.yacht_id)})]})]}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Price"})]}),e.jsxs("span",{className:"font-bold text-lg text-blue-700",children:["$",c.base_price]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Ve,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[c.duration_hours," hours"]})]}),c.max_guests&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[c.max_guests," guests"]})]})]}),c.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:c.description}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(E,{variant:"outline",size:"sm",onClick:()=>N(c),className:"flex-1",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsx(E,{variant:"destructive",size:"sm",onClick:()=>f.mutate(c.id),children:e.jsx(Ie,{className:"w-4 h-4"})})]})]})})]},c.id))}),O.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Ye,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No packages yet"}),e.jsx("p",{className:"text-gray-500",children:"Create your first package"})]}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Package":"Add New Package"})}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Yacht *"}),e.jsxs(Y,{value:s.yacht_id,onValueChange:c=>o({...s,yacht_id:c}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select yacht"})}),e.jsx(Q,{children:u.map(c=>e.jsx(h,{value:c.id,children:c.yacht_name},c.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Package Name *"}),e.jsx(_,{value:s.package_name,onChange:c=>o({...s,package_name:c.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Package Type *"}),e.jsxs(Y,{value:s.package_type,onValueChange:c=>o({...s,package_type:c}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"private",children:"Private"}),e.jsx(h,{value:"shared",children:"Shared"}),e.jsx(h,{value:"sunset",children:"Sunset"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Duration (hours) *"}),e.jsx(_,{type:"number",step:"0.5",value:s.duration_hours,onChange:c=>o({...s,duration_hours:c.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Base Price *"}),e.jsx(_,{type:"number",step:"0.01",value:s.base_price,onChange:c=>o({...s,base_price:c.target.value}),required:!0,disabled:!D}),!D&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Admin only"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Max Guests"}),e.jsx(_,{type:"number",value:s.max_guests,onChange:c=>o({...s,max_guests:c.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Description"}),e.jsx(ve,{value:s.description,onChange:c=>o({...s,description:c.target.value}),rows:4})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:v,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:a?"Update":"Create"})]})]})]})})]})})}const he=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:$("w-full caption-bottom text-sm",n),...l})}));he.displayName="Table";const me=j.forwardRef(({className:n,...l},a)=>e.jsx("thead",{ref:a,className:$("[&_tr]:border-b",n),...l}));me.displayName="TableHeader";const ue=j.forwardRef(({className:n,...l},a)=>e.jsx("tbody",{ref:a,className:$("[&_tr:last-child]:border-0",n),...l}));ue.displayName="TableBody";const fn=j.forwardRef(({className:n,...l},a)=>e.jsx("tfoot",{ref:a,className:$("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",n),...l}));fn.displayName="TableFooter";const ae=j.forwardRef(({className:n,...l},a)=>e.jsx("tr",{ref:a,className:$("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...l}));ae.displayName="TableRow";const C=j.forwardRef(({className:n,...l},a)=>e.jsx("th",{ref:a,className:$("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...l}));C.displayName="TableHead";const S=j.forwardRef(({className:n,...l},a)=>e.jsx("td",{ref:a,className:$("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),...l}));S.displayName="TableCell";const yn=j.forwardRef(({className:n,...l},a)=>e.jsx("caption",{ref:a,className:$("mt-4 text-sm text-muted-foreground",n),...l}));yn.displayName="TableCaption";function _n(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState({agent_name:"",email:"",phone:"",discount_limit:"",commission_percentage:"",status:"active"}),x=ce(),{data:O=[]}=L({queryKey:["agents"],queryFn:()=>k.entities.Agent.list("-created_date")}),{data:u}=L({queryKey:["currentUser"],queryFn:()=>k.auth.me()}),d=(u==null?void 0:u.role)==="admin",D=Z({mutationFn:t=>k.entities.Agent.create(t),onSuccess:()=>{x.invalidateQueries(["agents"]),f()}}),g=Z({mutationFn:({id:t,data:c})=>k.entities.Agent.update(t,c),onSuccess:()=>{x.invalidateQueries(["agents"]),f()}}),m=Z({mutationFn:t=>k.entities.Agent.delete(t),onSuccess:()=>{x.invalidateQueries(["agents"])}}),f=()=>{o({agent_name:"",email:"",phone:"",discount_limit:"",commission_percentage:"",status:"active"}),r(null),l(!1)},v=t=>{t.preventDefault();const c={...s,discount_limit:s.discount_limit?parseFloat(s.discount_limit):void 0,commission_percentage:s.commission_percentage?parseFloat(s.commission_percentage):void 0};a?g.mutate({id:a.id,data:c}):D.mutate(c)},q=t=>{var c,p;r(t),o({agent_name:t.agent_name,email:t.email||"",phone:t.phone,discount_limit:((c=t.discount_limit)==null?void 0:c.toString())||"",commission_percentage:((p=t.commission_percentage)==null?void 0:p.toString())||"",status:t.status}),l(!0)},N=()=>{const t=[["Agent Name","Email","Phone","Discount Limit","Commission %","Status"],...O.map(P=>[P.agent_name,P.email||"",P.phone,P.discount_limit||0,P.commission_percentage||0,P.status])].map(P=>P.join(",")).join(`
`),c=new Blob([t],{type:"text/csv"}),p=window.URL.createObjectURL(c),z=document.createElement("a");z.href=p,z.download=`agents_${new Date().toISOString().split("T")[0]}.csv`,z.click()},b=async t=>{const c=t.target.files[0];if(!c)return;const P=(await c.text()).split(`
`).slice(1).filter(F=>F.trim()).map(F=>{const[R,w,A,V,M,y]=F.split(",");return{agent_name:R==null?void 0:R.trim(),email:(w==null?void 0:w.trim())||void 0,phone:A==null?void 0:A.trim(),discount_limit:parseFloat(V)||void 0,commission_percentage:parseFloat(M)||void 0,status:(y==null?void 0:y.trim())||"active"}});for(const F of P)F.agent_name&&F.phone&&await k.entities.Agent.create(F);x.invalidateQueries(["agents"]),t.target.value=""};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Agents"}),e.jsx("p",{className:"text-gray-600",children:"Manage booking agents and commissions"})]}),e.jsxs("div",{className:"flex gap-2",children:[d&&e.jsxs(e.Fragment,{children:[e.jsxs(E,{onClick:N,variant:"outline",className:"border-green-600 text-green-600 hover:bg-green-50",children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsxs("label",{children:[e.jsxs(E,{type:"button",variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",onClick:()=>document.getElementById("import-file").click(),children:[e.jsx(Ds,{className:"w-4 h-4 mr-2"}),"Import"]}),e.jsx("input",{id:"import-file",type:"file",accept:".csv",onChange:b,className:"hidden"})]})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Agent"]})]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Agent Name"}),e.jsx(C,{children:"Contact"}),e.jsx(C,{children:"Discount Limit"}),e.jsx(C,{children:"Commission"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:O.map(t=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(ye,{className:"w-5 h-5 text-blue-600"})}),e.jsx("span",{className:"font-medium",children:t.agent_name})]})}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-1",children:[t.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ra,{className:"w-3 h-3"}),e.jsx("span",{children:t.email})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Fs,{className:"w-3 h-3"}),e.jsx("span",{children:t.phone})]})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:t.discount_limit||0})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(gt,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{children:[t.commission_percentage||0,"%"]})]})}),e.jsx(S,{children:e.jsx(X,{className:t.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:t.status})}),e.jsx(S,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>q(t),children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsx(E,{variant:"destructive",size:"sm",onClick:()=>m.mutate(t.id),children:e.jsx(Ie,{className:"w-4 h-4"})})]})})]},t.id))})]}),O.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(ye,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No agents yet"}),e.jsx("p",{className:"text-gray-500",children:"Add your first agent"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Agent":"Add New Agent"})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Agent Name *"}),e.jsx(_,{value:s.agent_name,onChange:t=>o({...s,agent_name:t.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Email"}),e.jsx(_,{type:"email",value:s.email,onChange:t=>o({...s,email:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone *"}),e.jsx(_,{value:s.phone,onChange:t=>o({...s,phone:t.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Discount Limit"}),e.jsx(_,{type:"number",step:"0.01",value:s.discount_limit,onChange:t=>o({...s,discount_limit:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Commission %"}),e.jsx(_,{type:"number",step:"0.01",value:s.commission_percentage,onChange:t=>o({...s,commission_percentage:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:s.status,onValueChange:t=>o({...s,status:t}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:f,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:a?"Update":"Create"})]})]})]})})]})})}function Nn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState(null),[x,O]=j.useState({booking_ref:`BK${Date.now()}`,yacht_id:"",package_id:"",agent_id:"",customer_name:"",customer_phone:"",customer_email:"",booking_date:"",booking_time:"",number_of_people:"",base_price:"",discount_amount:"0",total_price:"",status:"confirmed",notes:""}),u=ce(),{data:d=[]}=L({queryKey:["bookings"],queryFn:()=>k.entities.Booking.list("-created_date")}),{data:D=[]}=L({queryKey:["yachts"],queryFn:()=>k.entities.Yacht.list()}),{data:g=[]}=L({queryKey:["packages"],queryFn:()=>k.entities.Package.list()}),{data:m=[]}=L({queryKey:["agents"],queryFn:()=>k.entities.Agent.list()}),f=Z({mutationFn:P=>k.entities.Booking.create(P),onSuccess:()=>{u.invalidateQueries(["bookings"]),q()}}),v=Z({mutationFn:({id:P,data:F})=>k.entities.Booking.update(P,F),onSuccess:()=>{u.invalidateQueries(["bookings"]),q()}}),q=()=>{O({booking_ref:`BK${Date.now()}`,yacht_id:"",package_id:"",agent_id:"",customer_name:"",customer_phone:"",customer_email:"",booking_date:"",booking_time:"",number_of_people:"",base_price:"",discount_amount:"0",total_price:"",status:"confirmed",notes:""}),o(null),l(!1)},N=P=>{const F=g.find(R=>R.id===P);F&&O({...x,package_id:P,yacht_id:F.yacht_id,base_price:F.base_price.toString(),total_price:(F.base_price-parseFloat(x.discount_amount||0)).toString()})},b=P=>{const F=parseFloat(P)||0,R=parseFloat(x.base_price)||0;O({...x,discount_amount:P,total_price:(R-F).toString()})},t=P=>{P.preventDefault();const F={...x,number_of_people:parseInt(x.number_of_people),base_price:parseFloat(x.base_price),discount_amount:parseFloat(x.discount_amount),total_price:parseFloat(x.total_price)};s?v.mutate({id:s.id,data:F}):f.mutate(F)},c=P=>{var F;return((F=D.find(R=>R.id===P))==null?void 0:F.yacht_name)||"N/A"},p=P=>{var F;return((F=g.find(R=>R.id===P))==null?void 0:F.package_name)||"N/A"},z={confirmed:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800",completed:"bg-blue-100 text-blue-800",pending:"bg-yellow-100 text-yellow-800"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Bookings"}),e.jsx("p",{className:"text-gray-600",children:"Manage yacht bookings"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"New Booking"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Booking Ref"}),e.jsx(C,{children:"Customer"}),e.jsx(C,{children:"Yacht"}),e.jsx(C,{children:"Date & Time"}),e.jsx(C,{children:"Guests"}),e.jsx(C,{children:"Amount"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:d.map(P=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:P.booking_ref}),e.jsx(S,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:P.customer_name}),e.jsx("p",{className:"text-sm text-gray-500",children:P.customer_phone})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:c(P.yacht_id)})]})}),e.jsx(S,{children:e.jsxs("div",{children:[e.jsx("p",{children:P.booking_date}),e.jsx("p",{className:"text-sm text-gray-500",children:P.booking_time})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{children:P.number_of_people})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1 font-semibold",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("span",{children:P.total_price})]})}),e.jsx(S,{children:e.jsx(X,{className:z[P.status],children:P.status})}),e.jsx(S,{className:"text-right",children:e.jsx(E,{variant:"outline",size:"sm",onClick:()=>r(P),children:e.jsx(Os,{className:"w-4 h-4"})})})]},P.id))})]}),d.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(be,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No bookings yet"}),e.jsx("p",{className:"text-gray-500",children:"Create your first booking"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:"New Booking"})}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Booking Reference"}),e.jsx(_,{value:x.booking_ref,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:x.status,onValueChange:P=>O({...x,status:P}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"confirmed",children:"Confirmed"}),e.jsx(h,{value:"completed",children:"Completed"}),e.jsx(h,{value:"cancelled",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Package *"}),e.jsxs(Y,{value:x.package_id,onValueChange:N,required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select package"})}),e.jsx(Q,{children:g.map(P=>e.jsxs(h,{value:P.id,children:[P.package_name," - $",P.base_price]},P.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Agent"}),e.jsxs(Y,{value:x.agent_id,onValueChange:P=>O({...x,agent_id:P}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Direct booking"})}),e.jsx(Q,{children:m.map(P=>e.jsx(h,{value:P.id,children:P.agent_name},P.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Customer Name *"}),e.jsx(_,{value:x.customer_name,onChange:P=>O({...x,customer_name:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone *"}),e.jsx(_,{value:x.customer_phone,onChange:P=>O({...x,customer_phone:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Email"}),e.jsx(_,{type:"email",value:x.customer_email,onChange:P=>O({...x,customer_email:P.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Date *"}),e.jsx(_,{type:"date",value:x.booking_date,onChange:P=>O({...x,booking_date:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Time *"}),e.jsx(_,{type:"time",value:x.booking_time,onChange:P=>O({...x,booking_time:P.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Number of Guests *"}),e.jsx(_,{type:"number",value:x.number_of_people,onChange:P=>O({...x,number_of_people:P.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Base Price"}),e.jsx(_,{type:"number",step:"0.01",value:x.base_price,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Discount"}),e.jsx(_,{type:"number",step:"0.01",value:x.discount_amount,onChange:P=>b(P.target.value)})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Total Price"}),e.jsx(_,{type:"number",step:"0.01",value:x.total_price,disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(ve,{value:x.notes,onChange:P=>O({...x,notes:P.target.value}),rows:3})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:q,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Create Booking"})]})]})]})}),a&&e.jsx(ie,{open:!!a,onOpenChange:()=>r(null),children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Booking Details"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Booking Reference"}),e.jsx("p",{className:"font-semibold",children:a.booking_ref})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Status"}),e.jsx(X,{className:z[a.status],children:a.status})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Customer"}),e.jsx("p",{className:"font-semibold",children:a.customer_name}),e.jsx("p",{className:"text-sm text-gray-600",children:a.customer_phone})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Yacht"}),e.jsx("p",{className:"font-semibold",children:c(a.yacht_id)}),e.jsx("p",{className:"text-sm text-gray-600",children:p(a.package_id)})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Date"}),e.jsx("p",{className:"font-semibold",children:a.booking_date})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Time"}),e.jsx("p",{className:"font-semibold",children:a.booking_time})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Guests"}),e.jsx("p",{className:"font-semibold",children:a.number_of_people})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Base Price"}),e.jsxs("p",{className:"font-semibold",children:["$",a.base_price]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Discount"}),e.jsxs("p",{className:"font-semibold text-red-600",children:["-$",a.discount_amount]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Total"}),e.jsxs("p",{className:"font-bold text-lg text-blue-700",children:["$",a.total_price]})]})]}),a.notes&&e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-sm",children:a.notes})]})]})]})})]})})}function wn(){const[n,l]=j.useState("items"),[a,r]=j.useState(!1),[s,o]=j.useState(!1),[x,O]=j.useState({item_name:"",category:"soft_drink",unit_cost:"",selling_price:"",stock_qty:"",unit:"bottle",reorder_level:""}),[u,d]=j.useState({booking_id:"",bar_item_id:"",qty_used:"",usage_date:new Date().toISOString().split("T")[0]}),D=ce(),{data:g=[]}=L({queryKey:["barItems"],queryFn:()=>k.entities.BarItem.list()}),{data:m=[]}=L({queryKey:["barUsage"],queryFn:()=>k.entities.BarUsage.list("-created_date")}),{data:f=[]}=L({queryKey:["bookings"],queryFn:()=>k.entities.Booking.list()}),v=Z({mutationFn:w=>k.entities.BarItem.create(w),onSuccess:()=>{D.invalidateQueries(["barItems"]),b()}}),q=Z({mutationFn:w=>k.entities.BarUsage.create(w),onSuccess:()=>{D.invalidateQueries(["barUsage"]),D.invalidateQueries(["barItems"]),t()}}),N=Z({mutationFn:({id:w,data:A})=>k.entities.BarItem.update(w,A),onSuccess:()=>{D.invalidateQueries(["barItems"])}}),b=()=>{O({item_name:"",category:"soft_drink",unit_cost:"",selling_price:"",stock_qty:"",unit:"bottle",reorder_level:""}),r(!1)},t=()=>{d({booking_id:"",bar_item_id:"",qty_used:"",usage_date:new Date().toISOString().split("T")[0]}),o(!1)},c=w=>{w.preventDefault();const A={...x,unit_cost:parseFloat(x.unit_cost),selling_price:parseFloat(x.selling_price),stock_qty:parseInt(x.stock_qty),reorder_level:x.reorder_level?parseInt(x.reorder_level):void 0};v.mutate(A)},p=w=>{w.preventDefault();const A=g.find(K=>K.id===u.bar_item_id),V=parseInt(u.qty_used),M={...u,qty_used:V,unit_cost:A.unit_cost,total_cost:A.unit_cost*V};q.mutate(M);const y=A.stock_qty-V;N.mutate({id:A.id,data:{stock_qty:y}})},z=g.filter(w=>w.reorder_level&&w.stock_qty<=w.reorder_level),P=w=>{var A;return((A=g.find(V=>V.id===w))==null?void 0:A.item_name)||"N/A"},F=w=>{var A;return((A=f.find(V=>V.id===w))==null?void 0:A.booking_ref)||"N/A"},R={alcohol:"bg-red-100 text-red-800",soft_drink:"bg-blue-100 text-blue-800",snacks:"bg-yellow-100 text-yellow-800",other:"bg-gray-100 text-gray-800"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Bar Counter"}),e.jsx("p",{className:"text-gray-600",children:"Manage bar inventory and usage"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(E,{onClick:()=>o(!0),variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Record Usage"]}),e.jsxs(E,{onClick:()=>r(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Item"]})]})]}),z.length>0&&e.jsx(I,{className:"mb-6 border-orange-200 bg-orange-50",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ia,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-orange-900",children:"Low Stock Alert"}),e.jsxs("p",{className:"text-sm text-orange-700",children:[z.length," item(s) need reordering: ",z.map(w=>w.item_name).join(", ")]})]})]})})}),e.jsxs(Ps,{value:n,onValueChange:l,children:[e.jsxs(xs,{className:"mb-6",children:[e.jsx(Ee,{value:"items",children:"Bar Items"}),e.jsx(Ee,{value:"usage",children:"Usage History"})]}),e.jsxs(Pe,{value:"items",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(w=>e.jsxs(I,{className:"hover:shadow-lg transition-all border-none",children:[e.jsx(W,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-lg",children:w.item_name}),e.jsx(X,{className:R[w.category],children:w.category.replace("_"," ")})]})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Stock"}),e.jsxs("span",{className:`font-bold ${w.reorder_level&&w.stock_qty<=w.reorder_level?"text-red-600":"text-blue-700"}`,children:[w.stock_qty," ",w.unit]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Cost"}),e.jsxs("p",{className:"font-semibold",children:["$",w.unit_cost]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Selling Price"}),e.jsxs("p",{className:"font-semibold text-green-600",children:["$",w.selling_price]})]})]}),w.reorder_level&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Reorder at: ",w.reorder_level," ",w.unit]})]})})]},w.id))}),g.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Me,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No bar items yet"}),e.jsx("p",{className:"text-gray-500",children:"Add your first bar item"})]})]}),e.jsx(Pe,{value:"usage",children:e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Date"}),e.jsx(C,{children:"Booking Ref"}),e.jsx(C,{children:"Item"}),e.jsx(C,{children:"Quantity"}),e.jsx(C,{children:"Unit Cost"}),e.jsx(C,{children:"Total Cost"})]})}),e.jsx(ue,{children:m.map(w=>e.jsxs(ae,{children:[e.jsx(S,{children:w.usage_date||"N/A"}),e.jsx(S,{className:"font-medium",children:F(w.booking_id)}),e.jsx(S,{children:P(w.bar_item_id)}),e.jsx(S,{children:w.qty_used}),e.jsxs(S,{children:["$",w.unit_cost]}),e.jsxs(S,{className:"font-semibold",children:["$",w.total_cost]})]},w.id))})]}),m.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Ye,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No usage records"}),e.jsx("p",{className:"text-gray-500",children:"Record bar item usage from bookings"})]})]})})})]}),e.jsx(ie,{open:a,onOpenChange:r,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Add Bar Item"})}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Item Name *"}),e.jsx(_,{value:x.item_name,onChange:w=>O({...x,item_name:w.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Category *"}),e.jsxs(Y,{value:x.category,onValueChange:w=>O({...x,category:w}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"alcohol",children:"Alcohol"}),e.jsx(h,{value:"soft_drink",children:"Soft Drink"}),e.jsx(h,{value:"snacks",children:"Snacks"}),e.jsx(h,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Unit *"}),e.jsx(_,{value:x.unit,onChange:w=>O({...x,unit:w.target.value}),placeholder:"bottle, can, packet",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Unit Cost *"}),e.jsx(_,{type:"number",step:"0.01",value:x.unit_cost,onChange:w=>O({...x,unit_cost:w.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Selling Price *"}),e.jsx(_,{type:"number",step:"0.01",value:x.selling_price,onChange:w=>O({...x,selling_price:w.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Stock Quantity *"}),e.jsx(_,{type:"number",value:x.stock_qty,onChange:w=>O({...x,stock_qty:w.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Reorder Level"}),e.jsx(_,{type:"number",value:x.reorder_level,onChange:w=>O({...x,reorder_level:w.target.value})})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:b,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Add Item"})]})]})]})}),e.jsx(ie,{open:s,onOpenChange:o,children:e.jsxs(ne,{children:[e.jsx(le,{children:e.jsx(re,{children:"Record Bar Usage"})}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Booking *"}),e.jsxs(Y,{value:u.booking_id,onValueChange:w=>d({...u,booking_id:w}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select booking"})}),e.jsx(Q,{children:f.filter(w=>w.status==="confirmed").map(w=>e.jsxs(h,{value:w.id,children:[w.booking_ref," - ",w.customer_name]},w.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Bar Item *"}),e.jsxs(Y,{value:u.bar_item_id,onValueChange:w=>d({...u,bar_item_id:w}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select item"})}),e.jsx(Q,{children:g.map(w=>e.jsxs(h,{value:w.id,children:[w.item_name," (Stock: ",w.stock_qty,")"]},w.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Quantity Used *"}),e.jsx(_,{type:"number",value:u.qty_used,onChange:w=>d({...u,qty_used:w.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Date *"}),e.jsx(_,{type:"date",value:u.usage_date,onChange:w=>d({...u,usage_date:w.target.value}),required:!0})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Record Usage"})]})]})]})})]})})}function Cn(){const[n,l]=j.useState(!1),[a,r]=j.useState({invoice_number:`INV${Date.now()}`,booking_id:"",invoice_date:new Date().toISOString().split("T")[0],amount:"",tax_amount:"0",discount_amount:"0",final_amount:"",status:"unpaid",payment_method:"",notes:""}),s=ce(),{data:o=[]}=L({queryKey:["invoices"],queryFn:()=>k.entities.Invoice.list("-created_date")}),{data:x=[]}=L({queryKey:["bookings"],queryFn:()=>k.entities.Booking.list()}),O=Z({mutationFn:t=>k.entities.Invoice.create(t),onSuccess:()=>{s.invalidateQueries(["invoices"]),d()}}),u=Z({mutationFn:({id:t,data:c})=>k.entities.Invoice.update(t,c),onSuccess:()=>{s.invalidateQueries(["invoices"])}}),d=()=>{r({invoice_number:`INV${Date.now()}`,booking_id:"",invoice_date:new Date().toISOString().split("T")[0],amount:"",tax_amount:"0",discount_amount:"0",final_amount:"",status:"unpaid",payment_method:"",notes:""}),l(!1)},D=t=>{const c=x.find(p=>p.id===t);if(c){const p=c.total_price,z=parseFloat(a.tax_amount)||0,P=parseFloat(a.discount_amount)||0,F=p+z-P;r({...a,booking_id:t,amount:p.toString(),final_amount:F.toString()})}},g=(t,c)=>{const p=t==="amount"?parseFloat(c):parseFloat(a.amount)||0,z=t==="tax_amount"?parseFloat(c):parseFloat(a.tax_amount)||0,P=t==="discount_amount"?parseFloat(c):parseFloat(a.discount_amount)||0,F=p+z-P;r({...a,[t]:c,final_amount:F.toString()})},m=t=>{t.preventDefault();const c={...a,amount:parseFloat(a.amount),tax_amount:parseFloat(a.tax_amount),discount_amount:parseFloat(a.discount_amount),final_amount:parseFloat(a.final_amount)};O.mutate(c)},f=t=>{u.mutate({id:t.id,data:{status:"paid"}})},v=t=>{const c=x.find(p=>p.id===t);return c?`${c.booking_ref} - ${c.customer_name}`:"N/A"},q={paid:"bg-green-100 text-green-800",unpaid:"bg-red-100 text-red-800",partial:"bg-yellow-100 text-yellow-800",cancelled:"bg-gray-100 text-gray-800"},N=o.filter(t=>t.status==="paid").reduce((t,c)=>t+c.final_amount,0),b=o.filter(t=>t.status==="unpaid").reduce((t,c)=>t+c.final_amount,0);return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Invoices"}),e.jsx("p",{className:"text-gray-600",children:"Manage billing and invoices"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Create Invoice"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsx(I,{className:"border-none shadow-lg bg-gradient-to-br from-green-50 to-green-100",children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-700 mb-1",children:"Total Paid"}),e.jsxs("p",{className:"text-3xl font-bold text-green-900 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),N.toLocaleString()]})]}),e.jsx("div",{className:"w-16 h-16 bg-green-200 rounded-full flex items-center justify-center",children:e.jsx(oe,{className:"w-8 h-8 text-green-700"})})]})})}),e.jsx(I,{className:"border-none shadow-lg bg-gradient-to-br from-red-50 to-red-100",children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-700 mb-1",children:"Total Unpaid"}),e.jsxs("p",{className:"text-3xl font-bold text-red-900 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),b.toLocaleString()]})]}),e.jsx("div",{className:"w-16 h-16 bg-red-200 rounded-full flex items-center justify-center",children:e.jsx(fe,{className:"w-8 h-8 text-red-700"})})]})})})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Invoice #"}),e.jsx(C,{children:"Date"}),e.jsx(C,{children:"Booking"}),e.jsx(C,{children:"Amount"}),e.jsx(C,{children:"Tax"}),e.jsx(C,{children:"Final Amount"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:o.map(t=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:t.invoice_number}),e.jsx(S,{children:t.invoice_date}),e.jsx(S,{children:v(t.booking_id)}),e.jsxs(S,{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),t.amount]}),e.jsxs(S,{className:"text-green-600 flex items-center gap-1",children:["+",e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),t.tax_amount]}),e.jsxs(S,{className:"font-bold text-lg flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-4 h-4 inline-block"}),t.final_amount]}),e.jsx(S,{children:e.jsx(X,{className:q[t.status],children:t.status})}),e.jsx(S,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[t.status==="unpaid"&&e.jsx(E,{size:"sm",onClick:()=>f(t),className:"bg-green-600 hover:bg-green-700",children:"Mark Paid"}),e.jsx(E,{variant:"outline",size:"sm",children:e.jsx(He,{className:"w-4 h-4"})})]})})]},t.id))})]}),o.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(fe,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No invoices yet"}),e.jsx("p",{className:"text-gray-500",children:"Create your first invoice"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Create Invoice"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Invoice Number"}),e.jsx(_,{value:a.invoice_number,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Invoice Date *"}),e.jsx(_,{type:"date",value:a.invoice_date,onChange:t=>r({...a,invoice_date:t.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Booking *"}),e.jsxs(Y,{value:a.booking_id,onValueChange:D,required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select booking"})}),e.jsx(Q,{children:x.map(t=>e.jsxs(h,{value:t.id,children:[t.booking_ref," - ",t.customer_name," - ",e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),t.total_price]},t.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Base Amount"}),e.jsx(_,{type:"number",step:"0.01",value:a.amount,onChange:t=>g("amount",t.target.value),disabled:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Tax Amount"}),e.jsx(_,{type:"number",step:"0.01",value:a.tax_amount,onChange:t=>g("tax_amount",t.target.value)})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Discount"}),e.jsx(_,{type:"number",step:"0.01",value:a.discount_amount,onChange:t=>g("discount_amount",t.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Final Amount"}),e.jsx(_,{type:"number",step:"0.01",value:a.final_amount,disabled:!0,className:"text-xl font-bold"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Status *"}),e.jsxs(Y,{value:a.status,onValueChange:t=>r({...a,status:t}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"unpaid",children:"Unpaid"}),e.jsx(h,{value:"paid",children:"Paid"}),e.jsx(h,{value:"partial",children:"Partial"}),e.jsx(h,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Method"}),e.jsxs(Y,{value:a.payment_method,onValueChange:t=>r({...a,payment_method:t}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select method"})}),e.jsxs(Q,{children:[e.jsx(h,{value:"cash",children:"Cash"}),e.jsx(h,{value:"card",children:"Card"}),e.jsx(h,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(h,{value:"online",children:"Online"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(ve,{value:a.notes,onChange:t=>r({...a,notes:t.target.value}),rows:3})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Create Invoice"})]})]})]})})]})})}function Sn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState({vendor_name:"",contact_person:"",phone:"",email:"",address:"",category:"food_beverage",status:"active",payment_terms:""}),x=ce(),{data:O=[]}=L({queryKey:["vendors"],queryFn:()=>k.entities.Vendor.list("-created_date")}),u=Z({mutationFn:q=>k.entities.Vendor.create(q),onSuccess:()=>{x.invalidateQueries(["vendors"]),g()}}),d=Z({mutationFn:({id:q,data:N})=>k.entities.Vendor.update(q,N),onSuccess:()=>{x.invalidateQueries(["vendors"]),g()}}),D=Z({mutationFn:q=>k.entities.Vendor.delete(q),onSuccess:()=>{x.invalidateQueries(["vendors"])}}),g=()=>{o({vendor_name:"",contact_person:"",phone:"",email:"",address:"",category:"food_beverage",status:"active",payment_terms:""}),r(null),l(!1)},m=q=>{q.preventDefault(),a?d.mutate({id:a.id,data:s}):u.mutate(s)},f=q=>{r(q),o({vendor_name:q.vendor_name,contact_person:q.contact_person||"",phone:q.phone,email:q.email||"",address:q.address||"",category:q.category,status:q.status,payment_terms:q.payment_terms||""}),l(!0)},v={food_beverage:"bg-green-100 text-green-800",maintenance:"bg-blue-100 text-blue-800",supplies:"bg-purple-100 text-purple-800",other:"bg-gray-100 text-gray-800"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Vendors"}),e.jsx("p",{className:"text-gray-600",children:"Manage supplier information"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Vendor"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Vendor Name"}),e.jsx(C,{children:"Contact Person"}),e.jsx(C,{children:"Contact Info"}),e.jsx(C,{children:"Category"}),e.jsx(C,{children:"Payment Terms"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:O.map(q=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(Ne,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:q.vendor_name}),q.address&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(pt,{className:"w-3 h-3"}),q.address]})]})]})}),e.jsx(S,{children:q.contact_person||"-"}),e.jsx(S,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Fs,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{children:q.phone})]}),q.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ra,{className:"w-3 h-3"}),e.jsx("span",{children:q.email})]})]})}),e.jsx(S,{children:e.jsx(X,{className:v[q.category],children:q.category.replace("_"," ")})}),e.jsx(S,{children:q.payment_terms||"-"}),e.jsx(S,{children:e.jsx(X,{className:q.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:q.status})}),e.jsx(S,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>f(q),children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsx(E,{variant:"destructive",size:"sm",onClick:()=>D.mutate(q.id),children:e.jsx(Ie,{className:"w-4 h-4"})})]})})]},q.id))})]}),O.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Ne,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No vendors yet"}),e.jsx("p",{className:"text-gray-500",children:"Add your first vendor"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Vendor":"Add New Vendor"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Vendor Name *"}),e.jsx(_,{value:s.vendor_name,onChange:q=>o({...s,vendor_name:q.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Contact Person"}),e.jsx(_,{value:s.contact_person,onChange:q=>o({...s,contact_person:q.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone *"}),e.jsx(_,{value:s.phone,onChange:q=>o({...s,phone:q.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Email"}),e.jsx(_,{type:"email",value:s.email,onChange:q=>o({...s,email:q.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Address"}),e.jsx(ve,{value:s.address,onChange:q=>o({...s,address:q.target.value}),rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Category *"}),e.jsxs(Y,{value:s.category,onValueChange:q=>o({...s,category:q}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"food_beverage",children:"Food & Beverage"}),e.jsx(h,{value:"maintenance",children:"Maintenance"}),e.jsx(h,{value:"supplies",children:"Supplies"}),e.jsx(h,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:s.status,onValueChange:q=>o({...s,status:q}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"inactive",children:"Inactive"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Terms"}),e.jsx(_,{value:s.payment_terms,onChange:q=>o({...s,payment_terms:q.target.value}),placeholder:"e.g., Net 30, COD"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:g,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:a?"Update":"Create"})]})]})]})})]})})}function kn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState({po_number:`PO${Date.now()}`,vendor_id:"",order_date:new Date().toISOString().split("T")[0],expected_date:"",total_amount:"",status:"pending",notes:""}),x=ce(),{data:O=[]}=L({queryKey:["purchaseOrders"],queryFn:()=>k.entities.PurchaseOrder.list("-created_date")}),{data:u=[]}=L({queryKey:["vendors"],queryFn:()=>k.entities.Vendor.list()}),{data:d=[]}=L({queryKey:["purchaseItems"],queryFn:()=>k.entities.PurchaseItem.list()}),D=Z({mutationFn:t=>k.entities.PurchaseOrder.create(t),onSuccess:()=>{x.invalidateQueries(["purchaseOrders"]),f()}}),g=Z({mutationFn:({id:t,data:c})=>k.entities.PurchaseOrder.update(t,c),onSuccess:()=>{x.invalidateQueries(["purchaseOrders"])}}),m=Z({mutationFn:t=>k.entities.PurchaseOrder.delete(t),onSuccess:()=>{x.invalidateQueries(["purchaseOrders"])}}),f=()=>{o({po_number:`PO${Date.now()}`,vendor_id:"",order_date:new Date().toISOString().split("T")[0],expected_date:"",total_amount:"",status:"pending",notes:""}),l(!1)},v=t=>{t.preventDefault();const c={...s,total_amount:parseFloat(s.total_amount)||0};D.mutate(c)},q=t=>{g.mutate({id:t.id,data:{status:"received"}})},N=t=>{var c;return((c=u.find(p=>p.id===t))==null?void 0:c.vendor_name)||"N/A"},b={pending:"bg-yellow-100 text-yellow-800",received:"bg-green-100 text-green-800",partial:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Purchase Orders"}),e.jsx("p",{className:"text-gray-600",children:"Manage procurement and orders"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Create PO"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"PO Number"}),e.jsx(C,{children:"Vendor"}),e.jsx(C,{children:"Order Date"}),e.jsx(C,{children:"Expected Date"}),e.jsx(C,{children:"Total Amount"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:O.map(t=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:t.po_number}),e.jsx(S,{children:N(t.vendor_id)}),e.jsx(S,{children:t.order_date}),e.jsx(S,{children:t.expected_date}),e.jsxs(S,{className:"font-semibold",children:["$",t.total_amount||0]}),e.jsx(S,{children:e.jsx(X,{className:b[t.status],children:t.status})}),e.jsx(S,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[t.status==="pending"&&e.jsx(E,{size:"sm",onClick:()=>q(t),className:"bg-green-600 hover:bg-green-700",children:"Mark Received"}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>r(t),children:e.jsx(Os,{className:"w-4 h-4"})}),e.jsx(E,{variant:"destructive",size:"sm",onClick:()=>m.mutate(t.id),children:e.jsx(Ie,{className:"w-4 h-4"})})]})})]},t.id))})]}),O.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Oe,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No purchase orders yet"}),e.jsx("p",{className:"text-gray-500",children:"Create your first purchase order"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Create Purchase Order"})}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"PO Number"}),e.jsx(_,{value:s.po_number,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:s.status,onValueChange:t=>o({...s,status:t}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"partial",children:"Partial"}),e.jsx(h,{value:"received",children:"Received"}),e.jsx(h,{value:"cancelled",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Vendor *"}),e.jsxs(Y,{value:s.vendor_id,onValueChange:t=>o({...s,vendor_id:t}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select vendor"})}),e.jsx(Q,{children:u.map(t=>e.jsx(h,{value:t.id,children:t.vendor_name},t.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Order Date *"}),e.jsx(_,{type:"date",value:s.order_date,onChange:t=>o({...s,order_date:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Expected Delivery Date"}),e.jsx(_,{type:"date",value:s.expected_date,onChange:t=>o({...s,expected_date:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Total Amount"}),e.jsx(_,{type:"number",step:"0.01",value:s.total_amount,onChange:t=>o({...s,total_amount:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(ve,{value:s.notes,onChange:t=>o({...s,notes:t.target.value}),rows:3})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:f,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Create PO"})]})]})]})}),a&&e.jsx(ie,{open:!!a,onOpenChange:()=>r(null),children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Purchase Order Details"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"PO Number"}),e.jsx("p",{className:"font-semibold",children:a.po_number})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Status"}),e.jsx(X,{className:b[a.status],children:a.status})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Vendor"}),e.jsx("p",{className:"font-semibold",children:N(a.vendor_id)})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Total Amount"}),e.jsxs("p",{className:"font-bold text-lg text-blue-700",children:["$",a.total_amount]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Order Date"}),e.jsx("p",{className:"font-semibold",children:a.order_date})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Expected Date"}),e.jsx("p",{className:"font-semibold",children:a.expected_date})]})]}),a.notes&&e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-sm",children:a.notes})]})]})]})})]})})}function An(){const[n,l]=j.useState("items"),[a,r]=j.useState(!1),[s,o]=j.useState(!1),[x,O]=j.useState({item_name:"",category:"food",stock_qty:"",unit:"",unit_cost:"",reorder_level:"",location:""}),[u,d]=j.useState({item_id:"",movement_type:"in",quantity:"",reason:"purchase",movement_date:new Date().toISOString().split("T")[0],notes:""}),D=ce(),{data:g=[]}=L({queryKey:["inventoryItems"],queryFn:()=>k.entities.InventoryItem.list()}),{data:m=[]}=L({queryKey:["stockMovements"],queryFn:()=>k.entities.StockMovement.list("-created_date")}),f=Z({mutationFn:F=>k.entities.InventoryItem.create(F),onSuccess:()=>{D.invalidateQueries(["inventoryItems"]),N()}}),v=Z({mutationFn:F=>k.entities.StockMovement.create(F),onSuccess:()=>{D.invalidateQueries(["stockMovements"]),D.invalidateQueries(["inventoryItems"]),b()}}),q=Z({mutationFn:({id:F,data:R})=>k.entities.InventoryItem.update(F,R),onSuccess:()=>{D.invalidateQueries(["inventoryItems"])}}),N=()=>{O({item_name:"",category:"food",stock_qty:"",unit:"",unit_cost:"",reorder_level:"",location:""}),r(!1)},b=()=>{d({item_id:"",movement_type:"in",quantity:"",reason:"purchase",movement_date:new Date().toISOString().split("T")[0],notes:""}),o(!1)},t=F=>{F.preventDefault();const R={...x,stock_qty:parseFloat(x.stock_qty),unit_cost:parseFloat(x.unit_cost),reorder_level:x.reorder_level?parseFloat(x.reorder_level):void 0};f.mutate(R)},c=F=>{F.preventDefault();const R=g.find(V=>V.id===u.item_id),w=parseFloat(u.quantity);v.mutate({...u,quantity:w});const A=u.movement_type==="in"?R.stock_qty+w:R.stock_qty-w;q.mutate({id:R.id,data:{stock_qty:A}})},p=g.filter(F=>F.reorder_level&&F.stock_qty<=F.reorder_level),z=F=>{var R;return((R=g.find(w=>w.id===F))==null?void 0:R.item_name)||"N/A"},P={food:"bg-green-100 text-green-800",beverage:"bg-blue-100 text-blue-800",supplies:"bg-purple-100 text-purple-800",maintenance:"bg-orange-100 text-orange-800",other:"bg-gray-100 text-gray-800"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Inventory"}),e.jsx("p",{className:"text-gray-600",children:"Manage stock and inventory movements"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(E,{onClick:()=>o(!0),variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Stock Movement"]}),e.jsxs(E,{onClick:()=>r(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Item"]})]})]}),p.length>0&&e.jsx(I,{className:"mb-6 border-orange-200 bg-orange-50",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ia,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-orange-900",children:"Low Stock Alert"}),e.jsxs("p",{className:"text-sm text-orange-700",children:[p.length," item(s) need reordering: ",p.map(F=>F.item_name).join(", ")]})]})]})})}),e.jsxs(Ps,{value:n,onValueChange:l,children:[e.jsxs(xs,{className:"mb-6",children:[e.jsx(Ee,{value:"items",children:"Inventory Items"}),e.jsx(Ee,{value:"movements",children:"Stock Movements"})]}),e.jsxs(Pe,{value:"items",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(F=>e.jsxs(I,{className:"hover:shadow-lg transition-all border-none",children:[e.jsx(W,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-lg",children:F.item_name}),e.jsx(X,{className:P[F.category],children:F.category})]})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Stock"}),e.jsxs("span",{className:`font-bold ${F.reorder_level&&F.stock_qty<=F.reorder_level?"text-red-600":"text-blue-700"}`,children:[F.stock_qty," ",F.unit]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Unit Cost"}),e.jsxs("p",{className:"font-semibold flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),F.unit_cost]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Location"}),e.jsx("p",{className:"font-semibold text-sm",children:F.location||"N/A"})]})]}),F.reorder_level&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Reorder at: ",F.reorder_level," ",F.unit]})]})})]},F.id))}),g.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Ke,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No inventory items yet"}),e.jsx("p",{className:"text-gray-500",children:"Add your first inventory item"})]})]}),e.jsx(Pe,{value:"movements",children:e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Date"}),e.jsx(C,{children:"Item"}),e.jsx(C,{children:"Type"}),e.jsx(C,{children:"Quantity"}),e.jsx(C,{children:"Reason"}),e.jsx(C,{children:"Notes"})]})}),e.jsx(ue,{children:m.map(F=>e.jsxs(ae,{children:[e.jsx(S,{children:F.movement_date}),e.jsx(S,{className:"font-medium",children:z(F.item_id)}),e.jsx(S,{children:F.movement_type==="in"?e.jsxs(X,{className:"bg-green-100 text-green-800",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Stock In"]}):e.jsxs(X,{className:"bg-red-100 text-red-800",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),"Stock Out"]})}),e.jsx(S,{className:"font-semibold",children:F.quantity}),e.jsx(S,{children:e.jsx(X,{variant:"outline",children:F.reason.replace("_"," ")})}),e.jsx(S,{className:"text-sm text-gray-600",children:F.notes||"-"})]},F.id))})]}),m.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(we,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No movements yet"}),e.jsx("p",{className:"text-gray-500",children:"Record stock in/out movements"})]})]})})})]}),e.jsx(ie,{open:a,onOpenChange:r,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Add Inventory Item"})}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Item Name *"}),e.jsx(_,{value:x.item_name,onChange:F=>O({...x,item_name:F.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Category *"}),e.jsxs(Y,{value:x.category,onValueChange:F=>O({...x,category:F}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"food",children:"Food"}),e.jsx(h,{value:"beverage",children:"Beverage"}),e.jsx(h,{value:"supplies",children:"Supplies"}),e.jsx(h,{value:"maintenance",children:"Maintenance"}),e.jsx(h,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Unit *"}),e.jsx(_,{value:x.unit,onChange:F=>O({...x,unit:F.target.value}),placeholder:"kg, liter, pieces",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Stock Quantity *"}),e.jsx(_,{type:"number",step:"0.01",value:x.stock_qty,onChange:F=>O({...x,stock_qty:F.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Unit Cost *"}),e.jsx(_,{type:"number",step:"0.01",value:x.unit_cost,onChange:F=>O({...x,unit_cost:F.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Reorder Level"}),e.jsx(_,{type:"number",step:"0.01",value:x.reorder_level,onChange:F=>O({...x,reorder_level:F.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Storage Location"}),e.jsx(_,{value:x.location,onChange:F=>O({...x,location:F.target.value})})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:N,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Add Item"})]})]})]})}),e.jsx(ie,{open:s,onOpenChange:o,children:e.jsxs(ne,{children:[e.jsx(le,{children:e.jsx(re,{children:"Record Stock Movement"})}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Item *"}),e.jsxs(Y,{value:u.item_id,onValueChange:F=>d({...u,item_id:F}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select item"})}),e.jsx(Q,{children:g.map(F=>e.jsxs(h,{value:F.id,children:[F.item_name," (Stock: ",F.stock_qty," ",F.unit,")"]},F.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Movement Type *"}),e.jsxs(Y,{value:u.movement_type,onValueChange:F=>d({...u,movement_type:F}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"in",children:"Stock In"}),e.jsx(h,{value:"out",children:"Stock Out"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Quantity *"}),e.jsx(_,{type:"number",step:"0.01",value:u.quantity,onChange:F=>d({...u,quantity:F.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Reason *"}),e.jsxs(Y,{value:u.reason,onValueChange:F=>d({...u,reason:F}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"purchase",children:"Purchase"}),e.jsx(h,{value:"pos_sale",children:"POS Sale"}),e.jsx(h,{value:"booking",children:"Booking"}),e.jsx(h,{value:"wastage",children:"Wastage"}),e.jsx(h,{value:"adjustment",children:"Adjustment"}),e.jsx(h,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Date *"}),e.jsx(_,{type:"date",value:u.movement_date,onChange:F=>d({...u,movement_date:F.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(_,{value:u.notes,onChange:F=>d({...u,notes:F.target.value})})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:b,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Record Movement"})]})]})]})})]})})}function Dn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState({employee_code:`EMP${Date.now()}`,name:"",dob:"",visa_type:"",visa_status:"valid",visa_expiry:"",joining_date:"",designation:"",department:"operations",basic_salary:"",allowance:"0",accommodation_allowance:"0",sales_commission:"0",bar_commission:"0",paid_leaves:"21",overtime_rate:"0",phone:"",email:"",status:"active"}),x=ce(),{data:O=[]}=L({queryKey:["employees"],queryFn:()=>k.entities.Employee.list("-created_date")}),u=Z({mutationFn:N=>k.entities.Employee.create(N),onSuccess:()=>{x.invalidateQueries(["employees"]),g()}}),d=Z({mutationFn:({id:N,data:b})=>k.entities.Employee.update(N,b),onSuccess:()=>{x.invalidateQueries(["employees"]),g()}}),D=Z({mutationFn:N=>k.entities.Employee.delete(N),onSuccess:()=>{x.invalidateQueries(["employees"])}}),g=()=>{o({employee_code:`EMP${Date.now()}`,name:"",dob:"",visa_type:"",visa_status:"valid",visa_expiry:"",joining_date:"",designation:"",department:"operations",basic_salary:"",allowance:"0",accommodation_allowance:"0",sales_commission:"0",bar_commission:"0",paid_leaves:"21",overtime_rate:"0",phone:"",email:"",status:"active"}),r(null),l(!1)},m=N=>{N.preventDefault();const b={...s,basic_salary:parseFloat(s.basic_salary),allowance:parseFloat(s.allowance),accommodation_allowance:parseFloat(s.accommodation_allowance),sales_commission:parseFloat(s.sales_commission),bar_commission:parseFloat(s.bar_commission),paid_leaves:parseInt(s.paid_leaves),overtime_rate:parseFloat(s.overtime_rate)};a?d.mutate({id:a.id,data:b}):u.mutate(b)},f=N=>{var b,t,c,p,z,P;r(N),o({employee_code:N.employee_code,name:N.name,dob:N.dob||"",visa_type:N.visa_type||"",visa_status:N.visa_status,visa_expiry:N.visa_expiry||"",joining_date:N.joining_date,designation:N.designation,department:N.department,basic_salary:N.basic_salary.toString(),allowance:((b=N.allowance)==null?void 0:b.toString())||"0",accommodation_allowance:((t=N.accommodation_allowance)==null?void 0:t.toString())||"0",sales_commission:((c=N.sales_commission)==null?void 0:c.toString())||"0",bar_commission:((p=N.bar_commission)==null?void 0:p.toString())||"0",paid_leaves:((z=N.paid_leaves)==null?void 0:z.toString())||"21",overtime_rate:((P=N.overtime_rate)==null?void 0:P.toString())||"0",phone:N.phone||"",email:N.email||"",status:N.status}),l(!0)},v={active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",terminated:"bg-red-100 text-red-800"},q={valid:"bg-green-100 text-green-800",expired:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800",not_applicable:"bg-gray-100 text-gray-800"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Employees"}),e.jsx("p",{className:"text-gray-600",children:"Manage employee information"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Employee"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Employee"}),e.jsx(C,{children:"Designation"}),e.jsx(C,{children:"Department"}),e.jsx(C,{children:"Joining Date"}),e.jsx(C,{children:"Salary"}),e.jsx(C,{children:"Visa Status"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:O.map(N=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(Re,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:N.name}),e.jsx("p",{className:"text-xs text-gray-500",children:N.employee_code}),N.phone&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Fs,{className:"w-3 h-3"}),N.phone]})]})]})}),e.jsx(S,{children:N.designation}),e.jsx(S,{children:e.jsx(X,{variant:"outline",children:N.department.replace("_"," ")})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{children:N.joining_date})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1 font-semibold",children:[e.jsx(oe,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:N.basic_salary})]})}),e.jsx(S,{children:e.jsx(X,{className:q[N.visa_status],children:N.visa_status.replace("_"," ")})}),e.jsx(S,{children:e.jsx(X,{className:v[N.status],children:N.status})}),e.jsx(S,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>f(N),children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsx(E,{variant:"destructive",size:"sm",onClick:()=>D.mutate(N.id),children:e.jsx(Ie,{className:"w-4 h-4"})})]})})]},N.id))})]})}),O.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Re,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No employees yet"}),e.jsx("p",{className:"text-gray-500",children:"Add your first employee"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Employee":"Add New Employee"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Employee Code"}),e.jsx(_,{value:s.employee_code,disabled:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Full Name *"}),e.jsx(_,{value:s.name,onChange:N=>o({...s,name:N.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Date of Birth"}),e.jsx(_,{type:"date",value:s.dob,onChange:N=>o({...s,dob:N.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Joining Date *"}),e.jsx(_,{type:"date",value:s.joining_date,onChange:N=>o({...s,joining_date:N.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:s.status,onValueChange:N=>o({...s,status:N}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"inactive",children:"Inactive"}),e.jsx(h,{value:"terminated",children:"Terminated"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Designation *"}),e.jsx(_,{value:s.designation,onChange:N=>o({...s,designation:N.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Department *"}),e.jsxs(Y,{value:s.department,onValueChange:N=>o({...s,department:N}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"operations",children:"Operations"}),e.jsx(h,{value:"sales",children:"Sales"}),e.jsx(h,{value:"kitchen",children:"Kitchen"}),e.jsx(h,{value:"bar",children:"Bar"}),e.jsx(h,{value:"maintenance",children:"Maintenance"}),e.jsx(h,{value:"management",children:"Management"}),e.jsx(h,{value:"other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Visa Type"}),e.jsx(_,{value:s.visa_type,onChange:N=>o({...s,visa_type:N.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Visa Status"}),e.jsxs(Y,{value:s.visa_status,onValueChange:N=>o({...s,visa_status:N}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"valid",children:"Valid"}),e.jsx(h,{value:"expired",children:"Expired"}),e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"not_applicable",children:"Not Applicable"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Visa Expiry"}),e.jsx(_,{type:"date",value:s.visa_expiry,onChange:N=>o({...s,visa_expiry:N.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Phone"}),e.jsx(_,{value:s.phone,onChange:N=>o({...s,phone:N.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Email"}),e.jsx(_,{type:"email",value:s.email,onChange:N=>o({...s,email:N.target.value})})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Salary & Benefits"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Basic Salary *"}),e.jsx(_,{type:"number",step:"0.01",value:s.basic_salary,onChange:N=>o({...s,basic_salary:N.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Allowance"}),e.jsx(_,{type:"number",step:"0.01",value:s.allowance,onChange:N=>o({...s,allowance:N.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Accommodation Allowance"}),e.jsx(_,{type:"number",step:"0.01",value:s.accommodation_allowance,onChange:N=>o({...s,accommodation_allowance:N.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Sales Commission"}),e.jsx(_,{type:"number",step:"0.01",value:s.sales_commission,onChange:N=>o({...s,sales_commission:N.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Bar Commission"}),e.jsx(_,{type:"number",step:"0.01",value:s.bar_commission,onChange:N=>o({...s,bar_commission:N.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Paid Leaves (Days)"}),e.jsx(_,{type:"number",value:s.paid_leaves,onChange:N=>o({...s,paid_leaves:N.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Overtime Rate"}),e.jsx(_,{type:"number",step:"0.01",value:s.overtime_rate,onChange:N=>o({...s,overtime_rate:N.target.value})})]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:g,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:a?"Update":"Create"})]})]})]})})]})})}function Fn(){const[n,l]=j.useState(!1),[a,r]=j.useState({employee_id:"",date:new Date().toISOString().split("T")[0],status:"present",check_in:"",check_out:"",overtime_hours:"0",notes:""}),s=ce(),{data:o=[]}=L({queryKey:["attendance"],queryFn:()=>k.entities.Attendance.list("-date")}),{data:x=[]}=L({queryKey:["employees"],queryFn:()=>k.entities.Employee.list()}),O=Z({mutationFn:f=>k.entities.Attendance.create(f),onSuccess:()=>{s.invalidateQueries(["attendance"]),u()}}),u=()=>{r({employee_id:"",date:new Date().toISOString().split("T")[0],status:"present",check_in:"",check_out:"",overtime_hours:"0",notes:""}),l(!1)},d=f=>{f.preventDefault();const v={...a,overtime_hours:parseFloat(a.overtime_hours)};O.mutate(v)},D=f=>{var v;return((v=x.find(q=>q.id===f))==null?void 0:v.name)||"N/A"},g={present:"bg-green-100 text-green-800",absent:"bg-red-100 text-red-800",leave:"bg-blue-100 text-blue-800",half_day:"bg-yellow-100 text-yellow-800",holiday:"bg-purple-100 text-purple-800"},m={present:qs,absent:ca,leave:Ve,half_day:Ve,holiday:Ve};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Attendance"}),e.jsx("p",{className:"text-gray-600",children:"Track employee attendance"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Mark Attendance"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Date"}),e.jsx(C,{children:"Employee"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Check In"}),e.jsx(C,{children:"Check Out"}),e.jsx(C,{children:"Overtime Hours"}),e.jsx(C,{children:"Notes"})]})}),e.jsx(ue,{children:o.map(f=>{const v=m[f.status];return e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:f.date}),e.jsx(S,{children:D(f.employee_id)}),e.jsx(S,{children:e.jsxs(X,{className:g[f.status],children:[e.jsx(v,{className:"w-3 h-3 mr-1"}),f.status.replace("_"," ")]})}),e.jsx(S,{children:f.check_in||"-"}),e.jsx(S,{children:f.check_out||"-"}),e.jsxs(S,{children:[f.overtime_hours||0," hrs"]}),e.jsx(S,{className:"text-sm text-gray-600",children:f.notes||"-"})]},f.id)})})]}),o.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(Oe,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No attendance records"}),e.jsx("p",{className:"text-gray-500",children:"Mark your first attendance"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Mark Attendance"})}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Employee *"}),e.jsxs(Y,{value:a.employee_id,onValueChange:f=>r({...a,employee_id:f}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select employee"})}),e.jsx(Q,{children:x.filter(f=>f.status==="active").map(f=>e.jsxs(h,{value:f.id,children:[f.name," - ",f.designation]},f.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Date *"}),e.jsx(_,{type:"date",value:a.date,onChange:f=>r({...a,date:f.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status *"}),e.jsxs(Y,{value:a.status,onValueChange:f=>r({...a,status:f}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"present",children:"Present"}),e.jsx(h,{value:"absent",children:"Absent"}),e.jsx(h,{value:"leave",children:"Leave"}),e.jsx(h,{value:"half_day",children:"Half Day"}),e.jsx(h,{value:"holiday",children:"Holiday"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Check In"}),e.jsx(_,{type:"time",value:a.check_in,onChange:f=>r({...a,check_in:f.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Check Out"}),e.jsx(_,{type:"time",value:a.check_out,onChange:f=>r({...a,check_out:f.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Overtime Hours"}),e.jsx(_,{type:"number",step:"0.5",value:a.overtime_hours,onChange:f=>r({...a,overtime_hours:f.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(_,{value:a.notes,onChange:f=>r({...a,notes:f.target.value}),placeholder:"Additional remarks"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:u,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Mark Attendance"})]})]})]})})]})})}function On(){const[n,l]=j.useState(!1),[a,r]=j.useState({employee_id:"",leave_type:"annual",start_date:"",end_date:"",total_days:"",reason:"",status:"pending"}),s=ce(),{data:o=[]}=L({queryKey:["leaves"],queryFn:()=>k.entities.Leave.list("-created_date")}),{data:x=[]}=L({queryKey:["employees"],queryFn:()=>k.entities.Employee.list()}),O=Z({mutationFn:t=>k.entities.Leave.create(t),onSuccess:()=>{s.invalidateQueries(["leaves"]),d()}}),u=Z({mutationFn:({id:t,data:c})=>k.entities.Leave.update(t,c),onSuccess:()=>{s.invalidateQueries(["leaves"])}}),d=()=>{r({employee_id:"",leave_type:"annual",start_date:"",end_date:"",total_days:"",reason:"",status:"pending"}),l(!1)},D=(t,c)=>{if(!t||!c)return 0;const p=new Date(t),z=new Date(c),P=Math.abs(z-p);return Math.ceil(P/(1e3*60*60*24))+1},g=(t,c)=>{const p={...a,[t]:c};if(t==="start_date"||t==="end_date"){const z=D(t==="start_date"?c:a.start_date,t==="end_date"?c:a.end_date);p.total_days=z.toString()}r(p)},m=t=>{t.preventDefault();const c={...a,total_days:parseInt(a.total_days)};O.mutate(c)},f=t=>{u.mutate({id:t.id,data:{status:"approved"}})},v=t=>{u.mutate({id:t.id,data:{status:"rejected"}})},q=t=>{var c;return((c=x.find(p=>p.id===t))==null?void 0:c.name)||"N/A"},N={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},b={sick:"bg-red-100 text-red-800",annual:"bg-blue-100 text-blue-800",emergency:"bg-orange-100 text-orange-800",unpaid:"bg-gray-100 text-gray-800",other:"bg-purple-100 text-purple-800"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Leave Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage employee leave requests"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Request Leave"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Employee"}),e.jsx(C,{children:"Leave Type"}),e.jsx(C,{children:"Start Date"}),e.jsx(C,{children:"End Date"}),e.jsx(C,{children:"Days"}),e.jsx(C,{children:"Reason"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:o.map(t=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:q(t.employee_id)}),e.jsx(S,{children:e.jsx(X,{className:b[t.leave_type],children:t.leave_type})}),e.jsx(S,{children:t.start_date}),e.jsx(S,{children:t.end_date}),e.jsxs(S,{className:"font-semibold",children:[t.total_days," days"]}),e.jsx(S,{className:"text-sm max-w-xs truncate",children:t.reason}),e.jsx(S,{children:e.jsx(X,{className:N[t.status],children:t.status})}),e.jsx(S,{className:"text-right",children:t.status==="pending"&&e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(E,{size:"sm",onClick:()=>f(t),className:"bg-green-600 hover:bg-green-700",children:e.jsx(As,{className:"w-4 h-4"})}),e.jsx(E,{size:"sm",variant:"destructive",onClick:()=>v(t),children:e.jsx(Be,{className:"w-4 h-4"})})]})})]},t.id))})]}),o.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(be,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No leave requests"}),e.jsx("p",{className:"text-gray-500",children:"Submit your first leave request"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Request Leave"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Employee *"}),e.jsxs(Y,{value:a.employee_id,onValueChange:t=>r({...a,employee_id:t}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select employee"})}),e.jsx(Q,{children:x.filter(t=>t.status==="active").map(t=>e.jsxs(h,{value:t.id,children:[t.name," - ",t.designation]},t.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Leave Type *"}),e.jsxs(Y,{value:a.leave_type,onValueChange:t=>r({...a,leave_type:t}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"sick",children:"Sick Leave"}),e.jsx(h,{value:"annual",children:"Annual Leave"}),e.jsx(h,{value:"emergency",children:"Emergency Leave"}),e.jsx(h,{value:"unpaid",children:"Unpaid Leave"}),e.jsx(h,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Start Date *"}),e.jsx(_,{type:"date",value:a.start_date,onChange:t=>g("start_date",t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"End Date *"}),e.jsx(_,{type:"date",value:a.end_date,onChange:t=>g("end_date",t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Total Days"}),e.jsx(_,{type:"number",value:a.total_days,disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Reason *"}),e.jsx(ve,{value:a.reason,onChange:t=>r({...a,reason:t.target.value}),rows:4,required:!0})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Submit Request"})]})]})]})})]})})}function qn(){const[n,l]=j.useState(!1),[a,r]=j.useState({employee_id:"",month:"",year:new Date().getFullYear().toString(),basic_salary:"",allowance:"0",accommodation_allowance:"0",sales_commission:"0",bar_commission:"0",overtime_amount:"0",deductions:"0",advance_salary:"0",absent_deduction:"0",payment_status:"pending",notes:""}),s=ce(),{data:o=[]}=L({queryKey:["payrolls"],queryFn:()=>k.entities.Payroll.list("-created_date")}),{data:x=[]}=L({queryKey:["employees"],queryFn:()=>k.entities.Employee.list()}),O=Z({mutationFn:p=>k.entities.Payroll.create(p),onSuccess:()=>{s.invalidateQueries(["payrolls"]),d()}}),u=Z({mutationFn:({id:p,data:z})=>k.entities.Payroll.update(p,z),onSuccess:()=>{s.invalidateQueries(["payrolls"])}}),d=()=>{r({employee_id:"",month:"",year:new Date().getFullYear().toString(),basic_salary:"",allowance:"0",accommodation_allowance:"0",sales_commission:"0",bar_commission:"0",overtime_amount:"0",deductions:"0",advance_salary:"0",absent_deduction:"0",payment_status:"pending",notes:""}),l(!1)},D=()=>{const p=parseFloat(a.basic_salary||0)+parseFloat(a.allowance||0)+parseFloat(a.accommodation_allowance||0)+parseFloat(a.sales_commission||0)+parseFloat(a.bar_commission||0)+parseFloat(a.overtime_amount||0),z=parseFloat(a.deductions||0)+parseFloat(a.advance_salary||0)+parseFloat(a.absent_deduction||0);return{total_earnings:p,total_deductions:z,net_salary:p-z}},g=p=>{var P,F,R,w;const z=x.find(A=>A.id===p);z&&r({...a,employee_id:p,basic_salary:z.basic_salary.toString(),allowance:((P=z.allowance)==null?void 0:P.toString())||"0",accommodation_allowance:((F=z.accommodation_allowance)==null?void 0:F.toString())||"0",sales_commission:((R=z.sales_commission)==null?void 0:R.toString())||"0",bar_commission:((w=z.bar_commission)==null?void 0:w.toString())||"0"})},m=p=>{p.preventDefault();const z=D(),P={...a,year:parseInt(a.year),basic_salary:parseFloat(a.basic_salary),allowance:parseFloat(a.allowance),accommodation_allowance:parseFloat(a.accommodation_allowance),sales_commission:parseFloat(a.sales_commission),bar_commission:parseFloat(a.bar_commission),overtime_amount:parseFloat(a.overtime_amount),deductions:parseFloat(a.deductions),advance_salary:parseFloat(a.advance_salary),absent_deduction:parseFloat(a.absent_deduction),total_earnings:z.total_earnings,total_deductions:z.total_deductions,net_salary:z.net_salary};O.mutate(P)},f=p=>{u.mutate({id:p.id,data:{payment_status:"paid",payment_date:new Date().toISOString().split("T")[0]}})},v=p=>{var z;return((z=x.find(P=>P.id===p))==null?void 0:z.name)||"N/A"},q=p=>x.find(z=>z.id===p),N=p=>{const z=q(p.employee_id);if(!z)return;const P=window.open("","_blank");P.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Salary Slip - ${z.name}</title>
        <style>
          @page { margin: 20mm; }
          body { 
            font-family: Arial, sans-serif; 
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
          }
          .header {
            text-align: center;
            border-bottom: 3px solid #1E40AF;
            padding-bottom: 20px;
            margin-bottom: 30px;
          }
          .company-name {
            font-size: 28px;
            font-weight: bold;
            color: #1E40AF;
            margin-bottom: 5px;
          }
          .slip-title {
            font-size: 22px;
            font-weight: bold;
            color: #374151;
          }
          .employee-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: #F3F4F6;
            border-radius: 8px;
          }
          .info-item {
            display: flex;
          }
          .info-label {
            font-weight: 600;
            color: #4B5563;
            min-width: 140px;
          }
          .info-value {
            color: #111827;
          }
          .section {
            margin-bottom: 30px;
          }
          .section-title {
            font-size: 18px;
            font-weight: bold;
            padding: 10px 15px;
            margin-bottom: 15px;
            border-radius: 6px;
          }
          .earnings-title {
            background: #D1FAE5;
            color: #065F46;
          }
          .deductions-title {
            background: #FEE2E2;
            color: #991B1B;
          }
          .summary-title {
            background: #DBEAFE;
            color: #1E40AF;
          }
          .line-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            border-bottom: 1px solid #E5E7EB;
          }
          .line-item:last-child {
            border-bottom: none;
          }
          .line-label {
            color: #4B5563;
          }
          .line-value {
            font-weight: 600;
            color: #111827;
          }
          .total-line {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: #F9FAFB;
            font-weight: bold;
            margin-top: 10px;
            border-radius: 6px;
          }
          .net-salary {
            display: flex;
            justify-content: space-between;
            padding: 20px;
            background: #1E40AF;
            color: white;
            font-size: 20px;
            font-weight: bold;
            border-radius: 8px;
            margin-top: 20px;
          }
          .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #E5E7EB;
            text-align: center;
            color: #6B7280;
            font-size: 12px;
          }
          @media print {
            body { padding: 0; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="company-name">YachtFlow</div>
          <div class="slip-title">SALARY SLIP</div>
        </div>

        <div class="employee-info">
          <div class="info-item">
            <span class="info-label">Employee Name:</span>
            <span class="info-value">${z.name}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Employee Code:</span>
            <span class="info-value">${z.employee_code||"N/A"}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Designation:</span>
            <span class="info-value">${z.designation}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Department:</span>
            <span class="info-value">${z.department}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Pay Period:</span>
            <span class="info-value">${p.month} ${p.year}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Payment Date:</span>
            <span class="info-value">${p.payment_date||"Pending"}</span>
          </div>
        </div>

        <div class="section">
          <div class="section-title earnings-title">EARNINGS</div>
          <div class="line-item">
            <span class="line-label">Basic Salary</span>
            <span class="line-value">AED ${p.basic_salary.toFixed(2)}</span>
          </div>
          <div class="line-item">
            <span class="line-label">Allowance</span>
            <span class="line-value">AED ${(p.allowance||0).toFixed(2)}</span>
          </div>
          <div class="line-item">
            <span class="line-label">Accommodation Allowance</span>
            <span class="line-value">AED ${(p.accommodation_allowance||0).toFixed(2)}</span>
          </div>
          <div class="line-item">
            <span class="line-label">Sales Commission</span>
            <span class="line-value">AED ${(p.sales_commission||0).toFixed(2)}</span>
          </div>
          <div class="line-item">
            <span class="line-label">Bar Commission</span>
            <span class="line-value">AED ${(p.bar_commission||0).toFixed(2)}</span>
          </div>
          <div class="line-item">
            <span class="line-label">Overtime Amount</span>
            <span class="line-value">AED ${(p.overtime_amount||0).toFixed(2)}</span>
          </div>
          <div class="total-line">
            <span>TOTAL EARNINGS</span>
            <span>AED ${p.total_earnings.toFixed(2)}</span>
          </div>
        </div>

        <div class="section">
          <div class="section-title deductions-title">DEDUCTIONS</div>
          <div class="line-item">
            <span class="line-label">Other Deductions</span>
            <span class="line-value">AED ${(p.deductions||0).toFixed(2)}</span>
          </div>
          <div class="line-item">
            <span class="line-label">Advance Salary</span>
            <span class="line-value">AED ${(p.advance_salary||0).toFixed(2)}</span>
          </div>
          <div class="line-item">
            <span class="line-label">Absent Deduction</span>
            <span class="line-value">AED ${(p.absent_deduction||0).toFixed(2)}</span>
          </div>
          <div class="total-line">
            <span>TOTAL DEDUCTIONS</span>
            <span>AED ${p.total_deductions.toFixed(2)}</span>
          </div>
        </div>

        <div class="net-salary">
          <span>NET SALARY</span>
          <span>AED ${p.net_salary.toFixed(2)}</span>
        </div>

        ${p.notes?`<div style="margin-top: 20px; padding: 15px; background: #FEF3C7; border-left: 4px solid #F59E0B; border-radius: 4px;"><strong>Notes:</strong> ${p.notes}</div>`:""}

        <div class="footer">
          Generated on ${new Date().toLocaleString()}<br>
          This is a computer-generated document and does not require a signature.
        </div>

        <script>
          window.onload = function() {
            window.print();
          }
        <\/script>
      </body>
      </html>
    `),P.document.close()},b={pending:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800",hold:"bg-red-100 text-red-800"},t=["January","February","March","April","May","June","July","August","September","October","November","December"],c=D();return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Payroll"}),e.jsx("p",{className:"text-gray-600",children:"Manage employee payroll"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Generate Payroll"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Employee"}),e.jsx(C,{children:"Period"}),e.jsx(C,{children:"Earnings"}),e.jsx(C,{children:"Deductions"}),e.jsx(C,{children:"Net Salary"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:o.map(p=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:v(p.employee_id)}),e.jsxs(S,{children:[p.month," ",p.year]}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),p.total_earnings]})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsxs("span",{className:"font-semibold flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),p.total_deductions]})]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1 font-bold text-lg",children:[e.jsx(oe,{className:"w-5 h-5 text-blue-600"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-4 h-4 inline-block"}),p.net_salary]})]})}),e.jsx(S,{children:e.jsx(X,{className:b[p.payment_status],children:p.payment_status})}),e.jsx(S,{className:"text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(E,{size:"sm",variant:"outline",onClick:()=>N(p),children:e.jsx(He,{className:"w-4 h-4"})}),p.payment_status==="pending"&&e.jsx(E,{size:"sm",onClick:()=>f(p),className:"bg-green-600 hover:bg-green-700",children:"Mark Paid"})]})})]},p.id))})]})}),o.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(ls,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No payroll records"}),e.jsx("p",{className:"text-gray-500",children:"Generate your first payroll"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:"Generate Payroll"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx(i,{children:"Employee *"}),e.jsxs(Y,{value:a.employee_id,onValueChange:g,required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select employee"})}),e.jsx(Q,{children:x.filter(p=>p.status==="active").map(p=>e.jsx(h,{value:p.id,children:p.name},p.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Month *"}),e.jsxs(Y,{value:a.month,onValueChange:p=>r({...a,month:p}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select month"})}),e.jsx(Q,{children:t.map(p=>e.jsx(h,{value:p,children:p},p))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Year *"}),e.jsx(_,{type:"number",value:a.year,onChange:p=>r({...a,year:p.target.value}),required:!0})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-4 text-green-700",children:"Earnings"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Basic Salary *"}),e.jsx(_,{type:"number",step:"0.01",value:a.basic_salary,onChange:p=>r({...a,basic_salary:p.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Allowance"}),e.jsx(_,{type:"number",step:"0.01",value:a.allowance,onChange:p=>r({...a,allowance:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Accommodation"}),e.jsx(_,{type:"number",step:"0.01",value:a.accommodation_allowance,onChange:p=>r({...a,accommodation_allowance:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Sales Commission"}),e.jsx(_,{type:"number",step:"0.01",value:a.sales_commission,onChange:p=>r({...a,sales_commission:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Bar Commission"}),e.jsx(_,{type:"number",step:"0.01",value:a.bar_commission,onChange:p=>r({...a,bar_commission:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Overtime Amount"}),e.jsx(_,{type:"number",step:"0.01",value:a.overtime_amount,onChange:p=>r({...a,overtime_amount:p.target.value})})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-4 text-red-700",children:"Deductions"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Other Deductions"}),e.jsx(_,{type:"number",step:"0.01",value:a.deductions,onChange:p=>r({...a,deductions:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Advance Salary"}),e.jsx(_,{type:"number",step:"0.01",value:a.advance_salary,onChange:p=>r({...a,advance_salary:p.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Absent Deduction"}),e.jsx(_,{type:"number",step:"0.01",value:a.absent_deduction,onChange:p=>r({...a,absent_deduction:p.target.value})})]})]})]}),e.jsx("div",{className:"border-t pt-4 bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Earnings"}),e.jsxs("p",{className:"text-2xl font-bold text-green-700 flex items-center justify-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),c.total_earnings.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Deductions"}),e.jsxs("p",{className:"text-2xl font-bold text-red-700 flex items-center justify-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),c.total_deductions.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Net Salary"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-700 flex items-center justify-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),c.net_salary.toFixed(2)]})]})]})}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Status"}),e.jsxs(Y,{value:a.payment_status,onValueChange:p=>r({...a,payment_status:p}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"paid",children:"Paid"}),e.jsx(h,{value:"hold",children:"Hold"})]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Generate Payroll"})]})]})]})})]})})}function En(){const[n,l]=j.useState([]),[a,r]=j.useState(!1),[s,o]=j.useState({table_number:"",payment_method:"cash"}),x=ce(),{data:O=[]}=L({queryKey:["posCategories"],queryFn:()=>k.entities.POSCategory.list()}),{data:u=[]}=L({queryKey:["posItems"],queryFn:()=>k.entities.POSItem.list()}),{data:d=[]}=L({queryKey:["employees"],queryFn:()=>k.entities.Employee.list()}),D=Z({mutationFn:t=>k.entities.POSOrder.create(t),onSuccess:t=>{n.forEach(c=>{k.entities.POSOrderItem.create({order_id:t.id,item_id:c.id,item_name:c.item_name,quantity:c.quantity,unit_price:c.price,total_price:c.price*c.quantity})}),x.invalidateQueries(["posOrders"]),l([]),r(!1),o({table_number:"",payment_method:"cash"})}});O.filter(t=>t.type==="restaurant"||t.type==="both");const g=u.filter(t=>{const c=O.find(p=>p.id===t.category_id);return c&&(c.type==="restaurant"||c.type==="both")}),m=t=>{const c=n.find(p=>p.id===t.id);l(c?n.map(p=>p.id===t.id?{...p,quantity:p.quantity+1}:p):[...n,{...t,quantity:1}])},f=(t,c)=>{l(n.map(p=>{if(p.id===t){const z=p.quantity+c;return z>0?{...p,quantity:z}:p}return p}).filter(p=>p.quantity>0))},v=t=>{l(n.filter(c=>c.id!==t))},q=()=>n.reduce((t,c)=>t+c.price*c.quantity,0),N=()=>{const t=q(),c={order_number:`REST${Date.now()}`,order_type:"restaurant",table_number:s.table_number,subtotal:t,tax_amount:0,discount_amount:0,total_amount:t,payment_method:s.payment_method,status:"pending",order_time:new Date().toLocaleTimeString()};D.mutate(c)},b=t=>{var c;return((c=O.find(p=>p.id===t))==null?void 0:c.category_name)||"N/A"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Restaurant POS"}),e.jsx("p",{className:"text-gray-600",children:"Point of Sale for restaurant orders"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cart Items"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:n.length})]}),e.jsxs(E,{onClick:()=>r(!0),disabled:n.length===0,className:"bg-gradient-to-r from-green-600 to-green-700 hover:shadow-lg",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Checkout ($",q().toFixed(2),")"]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(I,{className:"border-none shadow-lg mb-6",children:[e.jsx(W,{children:e.jsx(J,{children:"Menu Items"})}),e.jsxs(T,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:g.map(t=>e.jsx(I,{className:"cursor-pointer hover:shadow-md transition-all border-2 hover:border-blue-500",onClick:()=>t.available&&m(t),children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-2",children:t.item_name}),e.jsx(X,{variant:"outline",className:"text-xs mb-2",children:b(t.category_id)})]}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["$",t.price]}),!t.available&&e.jsx(X,{className:"bg-red-100 text-red-800",children:"Out"})]})]})})},t.id))}),g.length===0&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(qe,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No menu items available"})]})]})]})}),e.jsx("div",{children:e.jsxs(I,{className:"border-none shadow-lg sticky top-4",children:[e.jsx(W,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Current Order"]})}),e.jsx(T,{className:"p-0",children:n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Cart is empty"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"max-h-96 overflow-y-auto",children:n.map(t=>e.jsxs("div",{className:"p-4 border-b hover:bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:t.item_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["$",t.price," each"]})]}),e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>v(t.id),children:e.jsx(Be,{className:"w-4 h-4 text-red-500"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>f(t.id,-1),children:e.jsx(da,{className:"w-3 h-3"})}),e.jsx("span",{className:"w-8 text-center font-semibold",children:t.quantity}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>f(t.id,1),children:e.jsx(xe,{className:"w-3 h-3"})})]}),e.jsxs("span",{className:"font-bold text-lg",children:["$",(t.price*t.quantity).toFixed(2)]})]})]},t.id))}),e.jsx("div",{className:"p-4 bg-gray-50 border-t-2",children:e.jsxs("div",{className:"flex justify-between items-center text-xl font-bold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["$",q().toFixed(2)]})]})})]})})]})})]}),e.jsx(ie,{open:a,onOpenChange:r,children:e.jsxs(ne,{children:[e.jsx(le,{children:e.jsx(re,{children:"Complete Order"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Table Number *"}),e.jsx(_,{value:s.table_number,onChange:t=>o({...s,table_number:t.target.value}),placeholder:"e.g., T1, T2"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Method *"}),e.jsxs(Y,{value:s.payment_method,onValueChange:t=>o({...s,payment_method:t}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"cash",children:"Cash"}),e.jsx(h,{value:"card",children:"Card"}),e.jsx(h,{value:"online",children:"Online"})]})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Total Amount:"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-700",children:["$",q().toFixed(2)]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(E,{onClick:N,className:"bg-green-600 hover:bg-green-700",disabled:!s.table_number,children:"Confirm Order"})]})]})]})})]})})}function Pn(){const[n,l]=j.useState([]),[a,r]=j.useState(!1),[s,o]=j.useState({table_number:"",payment_method:"cash"}),x=ce(),{data:O=[]}=L({queryKey:["posCategories"],queryFn:()=>k.entities.POSCategory.list()}),{data:u=[]}=L({queryKey:["posItems"],queryFn:()=>k.entities.POSItem.list()}),d=Z({mutationFn:b=>k.entities.POSOrder.create(b),onSuccess:b=>{n.forEach(t=>{k.entities.POSOrderItem.create({order_id:b.id,item_id:t.id,item_name:t.item_name,quantity:t.quantity,unit_price:t.price,total_price:t.price*t.quantity})}),x.invalidateQueries(["posOrders"]),l([]),r(!1),o({table_number:"",payment_method:"cash"})}});O.filter(b=>b.type==="bar"||b.type==="both");const D=u.filter(b=>{const t=O.find(c=>c.id===b.category_id);return t&&(t.type==="bar"||t.type==="both")}),g=b=>{const t=n.find(c=>c.id===b.id);l(t?n.map(c=>c.id===b.id?{...c,quantity:c.quantity+1}:c):[...n,{...b,quantity:1}])},m=(b,t)=>{l(n.map(c=>{if(c.id===b){const p=c.quantity+t;return p>0?{...c,quantity:p}:c}return c}).filter(c=>c.quantity>0))},f=b=>{l(n.filter(t=>t.id!==b))},v=()=>n.reduce((b,t)=>b+t.price*t.quantity,0),q=()=>{const b=v(),t={order_number:`BAR${Date.now()}`,order_type:"bar",table_number:s.table_number,subtotal:b,tax_amount:0,discount_amount:0,total_amount:b,payment_method:s.payment_method,status:"pending",order_time:new Date().toLocaleTimeString()};d.mutate(t)},N=b=>{var t;return((t=O.find(c=>c.id===b))==null?void 0:t.category_name)||"N/A"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-purple-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Bar POS"}),e.jsx("p",{className:"text-gray-600",children:"Point of Sale for bar orders"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cart Items"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:n.length})]}),e.jsxs(E,{onClick:()=>r(!0),disabled:n.length===0,className:"bg-gradient-to-r from-purple-600 to-purple-700 hover:shadow-lg",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Checkout ($",v().toFixed(2),")"]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(I,{className:"border-none shadow-lg mb-6",children:[e.jsx(W,{children:e.jsx(J,{children:"Bar Menu"})}),e.jsxs(T,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:D.map(b=>e.jsx(I,{className:"cursor-pointer hover:shadow-md transition-all border-2 hover:border-purple-500",onClick:()=>b.available&&g(b),children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-2",children:b.item_name}),e.jsx(X,{variant:"outline",className:"text-xs mb-2",children:N(b.category_id)})]}),e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsxs("span",{className:"text-lg font-bold text-purple-600",children:["$",b.price]}),!b.available&&e.jsx(X,{className:"bg-red-100 text-red-800",children:"Out"})]})]})})},b.id))}),D.length===0&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(Me,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No bar items available"})]})]})]})}),e.jsx("div",{children:e.jsxs(I,{className:"border-none shadow-lg sticky top-4",children:[e.jsx(W,{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),"Current Order"]})}),e.jsx(T,{className:"p-0",children:n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Cart is empty"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"max-h-96 overflow-y-auto",children:n.map(b=>e.jsxs("div",{className:"p-4 border-b hover:bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:b.item_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["$",b.price," each"]})]}),e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>f(b.id),children:e.jsx(Be,{className:"w-4 h-4 text-red-500"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{variant:"outline",size:"sm",onClick:()=>m(b.id,-1),children:e.jsx(da,{className:"w-3 h-3"})}),e.jsx("span",{className:"w-8 text-center font-semibold",children:b.quantity}),e.jsx(E,{variant:"outline",size:"sm",onClick:()=>m(b.id,1),children:e.jsx(xe,{className:"w-3 h-3"})})]}),e.jsxs("span",{className:"font-bold text-lg",children:["$",(b.price*b.quantity).toFixed(2)]})]})]},b.id))}),e.jsx("div",{className:"p-4 bg-gray-50 border-t-2",children:e.jsxs("div",{className:"flex justify-between items-center text-xl font-bold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-purple-600",children:["$",v().toFixed(2)]})]})})]})})]})})]}),e.jsx(ie,{open:a,onOpenChange:r,children:e.jsxs(ne,{children:[e.jsx(le,{children:e.jsx(re,{children:"Complete Order"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Table Number *"}),e.jsx(_,{value:s.table_number,onChange:b=>o({...s,table_number:b.target.value}),placeholder:"e.g., B1, B2"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Method *"}),e.jsxs(Y,{value:s.payment_method,onValueChange:b=>o({...s,payment_method:b}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"cash",children:"Cash"}),e.jsx(h,{value:"card",children:"Card"}),e.jsx(h,{value:"online",children:"Online"})]})]})]}),e.jsx("div",{className:"p-4 bg-purple-50 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Total Amount:"}),e.jsxs("span",{className:"text-2xl font-bold text-purple-700",children:["$",v().toFixed(2)]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(E,{onClick:q,className:"bg-purple-600 hover:bg-purple-700",disabled:!s.table_number,children:"Confirm Order"})]})]})]})})]})})}function In(){const n=ce(),{data:l=[]}=L({queryKey:["posOrders"],queryFn:()=>k.entities.POSOrder.list("-created_date")}),a=Z({mutationFn:({id:x,data:O})=>k.entities.POSOrder.update(x,O),onSuccess:()=>{n.invalidateQueries(["posOrders"])}}),r=x=>{a.mutate({id:x.id,data:{status:"completed",completed_time:new Date().toLocaleTimeString()}})},s={pending:"bg-yellow-100 text-yellow-800",preparing:"bg-blue-100 text-blue-800",served:"bg-green-100 text-green-800",completed:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"},o={restaurant:qe,bar:Me};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"POS Orders"}),e.jsx("p",{className:"text-gray-600",children:"View all restaurant and bar orders"})]})}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Order #"}),e.jsx(C,{children:"Type"}),e.jsx(C,{children:"Table"}),e.jsx(C,{children:"Order Time"}),e.jsx(C,{children:"Amount"}),e.jsx(C,{children:"Payment"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:l.map(x=>{const O=o[x.order_type];return e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:x.order_number}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{className:"capitalize",children:x.order_type})]})}),e.jsx(S,{children:x.table_number||"-"}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"w-3 h-3 text-gray-500"}),e.jsx("span",{children:x.order_time})]})}),e.jsxs(S,{className:"font-semibold",children:["$",x.total_amount]}),e.jsx(S,{children:e.jsx(X,{variant:"outline",className:"capitalize",children:x.payment_method})}),e.jsx(S,{children:e.jsx(X,{className:s[x.status],children:x.status})}),e.jsx(S,{className:"text-right",children:(x.status==="pending"||x.status==="preparing"||x.status==="served")&&e.jsxs(E,{size:"sm",onClick:()=>r(x),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(qs,{className:"w-4 h-4 mr-1"}),"Complete"]})})]},x.id)})})]})}),l.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(fe,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No orders yet"}),e.jsx("p",{className:"text-gray-500",children:"Orders from Restaurant and Bar POS will appear here"})]})]})})]})})}function Tn(){const[n,l]=j.useState(!1),[a,r]=j.useState({entry_type:"income",source_module:"manual",category:"",amount:"",description:"",transaction_date:new Date().toISOString().split("T")[0],payment_method:"cash"}),s=ce(),{data:o=[]}=L({queryKey:["ledger"],queryFn:()=>k.entities.LedgerEntry.list("-transaction_date")}),x=Z({mutationFn:f=>k.entities.LedgerEntry.create(f),onSuccess:()=>{s.invalidateQueries(["ledger"]),O()}}),O=()=>{r({entry_type:"income",source_module:"manual",category:"",amount:"",description:"",transaction_date:new Date().toISOString().split("T")[0],payment_method:"cash"}),l(!1)},u=f=>{f.preventDefault();const v={...a,amount:parseFloat(a.amount)};x.mutate(v)},d=o.filter(f=>f.entry_type==="income").reduce((f,v)=>f+(v.amount||0),0),D=o.filter(f=>f.entry_type==="expense").reduce((f,v)=>f+(v.amount||0),0),g=d-D,m={income:"bg-green-100 text-green-800",expense:"bg-red-100 text-red-800"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Ledger"}),e.jsx("p",{className:"text-gray-600",children:"Track all financial transactions"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Entry"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(I,{className:"border-none shadow-lg bg-gradient-to-br from-green-50 to-green-100",children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-700 mb-1",children:"Total Income"}),e.jsxs("p",{className:"text-3xl font-bold text-green-900 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),d.toLocaleString()]})]}),e.jsx("div",{className:"w-16 h-16 bg-green-200 rounded-full flex items-center justify-center",children:e.jsx(we,{className:"w-8 h-8 text-green-700"})})]})})}),e.jsx(I,{className:"border-none shadow-lg bg-gradient-to-br from-red-50 to-red-100",children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-700 mb-1",children:"Total Expenses"}),e.jsxs("p",{className:"text-3xl font-bold text-red-900 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),D.toLocaleString()]})]}),e.jsx("div",{className:"w-16 h-16 bg-red-200 rounded-full flex items-center justify-center",children:e.jsx(Se,{className:"w-8 h-8 text-red-700"})})]})})}),e.jsx(I,{className:"border-none shadow-lg bg-gradient-to-br from-blue-50 to-blue-100",children:e.jsx(T,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-700 mb-1",children:"Net Profit"}),e.jsxs("p",{className:`text-3xl font-bold ${g>=0?"text-blue-900":"text-red-900"} flex items-center gap-1`,children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),g.toLocaleString()]})]}),e.jsx("div",{className:"w-16 h-16 bg-blue-200 rounded-full flex items-center justify-center",children:e.jsx(oe,{className:"w-8 h-8 text-blue-700"})})]})})})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Date"}),e.jsx(C,{children:"Type"}),e.jsx(C,{children:"Source"}),e.jsx(C,{children:"Category"}),e.jsx(C,{children:"Description"}),e.jsx(C,{children:"Payment Method"}),e.jsx(C,{children:"Amount"})]})}),e.jsx(ue,{children:o.map(f=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{children:f.transaction_date}),e.jsx(S,{children:e.jsxs(X,{className:m[f.entry_type],children:[f.entry_type==="income"?e.jsx(we,{className:"w-3 h-3 mr-1"}):e.jsx(Se,{className:"w-3 h-3 mr-1"}),f.entry_type]})}),e.jsx(S,{children:e.jsx(X,{variant:"outline",className:"capitalize",children:f.source_module})}),e.jsx(S,{children:f.category||"-"}),e.jsx(S,{className:"max-w-xs truncate",children:f.description}),e.jsx(S,{className:"capitalize",children:f.payment_method}),e.jsxs(S,{className:`font-bold ${f.entry_type==="income"?"text-green-600":"text-red-600"} flex items-center gap-1`,children:[f.entry_type==="income"?"+":"-",e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),f.amount]})]},f.id))})]})}),o.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(oe,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No ledger entries"}),e.jsx("p",{className:"text-gray-500",children:"Add your first transaction"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Add Ledger Entry"})}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Entry Type *"}),e.jsxs(Y,{value:a.entry_type,onValueChange:f=>r({...a,entry_type:f}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"income",children:"Income"}),e.jsx(h,{value:"expense",children:"Expense"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Source Module *"}),e.jsxs(Y,{value:a.source_module,onValueChange:f=>r({...a,source_module:f}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"crm",children:"CRM"}),e.jsx(h,{value:"pos",children:"POS"}),e.jsx(h,{value:"hrms",children:"HRMS"}),e.jsx(h,{value:"inventory",children:"Inventory"}),e.jsx(h,{value:"manual",children:"Manual"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Category"}),e.jsx(_,{value:a.category,onChange:f=>r({...a,category:f.target.value}),placeholder:"e.g., Sales, Salary, Rent"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Amount *"}),e.jsx(_,{type:"number",step:"0.01",value:a.amount,onChange:f=>r({...a,amount:f.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Transaction Date *"}),e.jsx(_,{type:"date",value:a.transaction_date,onChange:f=>r({...a,transaction_date:f.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Method *"}),e.jsxs(Y,{value:a.payment_method,onValueChange:f=>r({...a,payment_method:f}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"cash",children:"Cash"}),e.jsx(h,{value:"card",children:"Card"}),e.jsx(h,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(h,{value:"online",children:"Online"}),e.jsx(h,{value:"other",children:"Other"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Description *"}),e.jsx(ve,{value:a.description,onChange:f=>r({...a,description:f.target.value}),rows:3,required:!0})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:O,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Add Entry"})]})]})]})})]})})}function Rn(){const[n,l]=j.useState(!1),[a,r]=j.useState({report_period:"",month:"",year:new Date().getFullYear().toString(),total_income:"0",crm_income:"0",pos_income:"0",other_income:"0",total_expenses:"0",payroll_expenses:"0",purchase_expenses:"0",operational_expenses:"0",generated_date:new Date().toISOString().split("T")[0]}),s=ce(),{data:o=[]}=L({queryKey:["financialReports"],queryFn:()=>k.entities.FinancialReport.list("-year")}),x=Z({mutationFn:m=>k.entities.FinancialReport.create(m),onSuccess:()=>{s.invalidateQueries(["financialReports"]),O()}}),O=()=>{r({report_period:"",month:"",year:new Date().getFullYear().toString(),total_income:"0",crm_income:"0",pos_income:"0",other_income:"0",total_expenses:"0",payroll_expenses:"0",purchase_expenses:"0",operational_expenses:"0",generated_date:new Date().toISOString().split("T")[0]}),l(!1)},u=()=>{const m=parseFloat(a.total_income)||0,f=parseFloat(a.total_expenses)||0;return m-f},d=m=>{m.preventDefault();const f=u(),v={...a,report_period:`${a.month} ${a.year}`,year:parseInt(a.year),total_income:parseFloat(a.total_income),crm_income:parseFloat(a.crm_income),pos_income:parseFloat(a.pos_income),other_income:parseFloat(a.other_income),total_expenses:parseFloat(a.total_expenses),payroll_expenses:parseFloat(a.payroll_expenses),purchase_expenses:parseFloat(a.purchase_expenses),operational_expenses:parseFloat(a.operational_expenses),profit:f};x.mutate(v)},D=["January","February","March","April","May","June","July","August","September","October","November","December"],g=u();return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Financial Reports"}),e.jsx("p",{className:"text-gray-600",children:"View monthly financial summaries"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Generate Report"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(I,{className:"border-none shadow-lg",children:[e.jsx(W,{children:e.jsx(J,{className:"text-sm text-gray-600",children:"Total Income (All Time)"})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"w-8 h-8 text-green-600"}),e.jsxs("span",{className:"text-3xl font-bold text-green-700 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),o.reduce((m,f)=>m+(f.total_income||0),0).toLocaleString()]})]})})]}),e.jsxs(I,{className:"border-none shadow-lg",children:[e.jsx(W,{children:e.jsx(J,{className:"text-sm text-gray-600",children:"Total Expenses (All Time)"})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-8 h-8 text-red-600"}),e.jsxs("span",{className:"text-3xl font-bold text-red-700 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),o.reduce((m,f)=>m+(f.total_expenses||0),0).toLocaleString()]})]})})]}),e.jsxs(I,{className:"border-none shadow-lg",children:[e.jsx(W,{children:e.jsx(J,{className:"text-sm text-gray-600",children:"Net Profit (All Time)"})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-8 h-8 text-blue-600"}),e.jsxs("span",{className:"text-3xl font-bold text-blue-700 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-6 h-6 inline-block"}),o.reduce((m,f)=>m+(f.profit||0),0).toLocaleString()]})]})})]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Period"}),e.jsx(C,{children:"Total Income"}),e.jsx(C,{children:"Total Expenses"}),e.jsx(C,{children:"Profit/Loss"}),e.jsx(C,{children:"Generated On"})]})}),e.jsx(ue,{children:o.map(m=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:m.report_period}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1 text-green-600 font-semibold",children:[e.jsx(we,{className:"w-4 h-4"}),e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),m.total_income.toLocaleString()]})}),e.jsx(S,{children:e.jsxs("div",{className:"flex items-center gap-1 text-red-600 font-semibold",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),m.total_expenses.toLocaleString()]})}),e.jsx(S,{children:e.jsxs(X,{className:m.profit>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:[e.jsx(oe,{className:"w-3 h-3 mr-1"}),e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block mr-1"}),m.profit>=0?"+":"",m.profit.toLocaleString()]})}),e.jsx(S,{children:m.generated_date})]},m.id))})]}),o.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(fe,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No reports yet"}),e.jsx("p",{className:"text-gray-500",children:"Generate your first financial report"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:"Generate Financial Report"})}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Month *"}),e.jsxs(Y,{value:a.month,onValueChange:m=>r({...a,month:m}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select month"})}),e.jsx(Q,{children:D.map(m=>e.jsx(h,{value:m,children:m},m))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Year *"}),e.jsx(_,{type:"number",value:a.year,onChange:m=>r({...a,year:m.target.value}),required:!0})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-4 text-green-700",children:"Income Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"CRM Income"}),e.jsx(_,{type:"number",step:"0.01",value:a.crm_income,onChange:m=>r({...a,crm_income:m.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"POS Income"}),e.jsx(_,{type:"number",step:"0.01",value:a.pos_income,onChange:m=>r({...a,pos_income:m.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Other Income"}),e.jsx(_,{type:"number",step:"0.01",value:a.other_income,onChange:m=>r({...a,other_income:m.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Total Income *"}),e.jsx(_,{type:"number",step:"0.01",value:a.total_income,onChange:m=>r({...a,total_income:m.target.value}),required:!0,className:"font-bold"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-4 text-red-700",children:"Expense Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Payroll Expenses"}),e.jsx(_,{type:"number",step:"0.01",value:a.payroll_expenses,onChange:m=>r({...a,payroll_expenses:m.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Purchase Expenses"}),e.jsx(_,{type:"number",step:"0.01",value:a.purchase_expenses,onChange:m=>r({...a,purchase_expenses:m.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Operational Expenses"}),e.jsx(_,{type:"number",step:"0.01",value:a.operational_expenses,onChange:m=>r({...a,operational_expenses:m.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Total Expenses *"}),e.jsx(_,{type:"number",step:"0.01",value:a.total_expenses,onChange:m=>r({...a,total_expenses:m.target.value}),required:!0,className:"font-bold"})]})]})]}),e.jsx("div",{className:"border-t pt-4 bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Profit/Loss"}),e.jsxs("p",{className:`text-4xl font-bold ${g>=0?"text-green-700":"text-red-700"} flex items-center justify-center gap-2`,children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-8 h-8 inline-block"}),g.toFixed(2)]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:O,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Generate Report"})]})]})]})})]})})}function Mn(){const{data:n=[]}=L({queryKey:["bookings"],queryFn:()=>k.entities.Booking.list("-created_date")}),{data:l=[]}=L({queryKey:["yachts"],queryFn:()=>k.entities.Yacht.list()}),{data:a=[]}=L({queryKey:["packages"],queryFn:()=>k.entities.Package.list()}),{data:r=[]}=L({queryKey:["agents"],queryFn:()=>k.entities.Agent.list()}),{data:s=[]}=L({queryKey:["opportunities"],queryFn:()=>k.entities.Opportunity.list()}),o=l.filter(c=>c.status==="active").length,x=n.filter(c=>c.status==="confirmed").length,O=n.reduce((c,p)=>c+(p.total_amount||p.total_price||0),0),u=r.filter(c=>c.status==="active").length,d=n.slice(0,5),D=n.filter(c=>c.cruise_type==="private"),g=n.filter(c=>c.cruise_type==="shared"),m=[{name:"Private",bookings:D.length,revenue:D.reduce((c,p)=>c+(p.total_amount||p.total_price||0),0)},{name:"Shared",bookings:g.length,revenue:g.reduce((c,p)=>c+(p.total_amount||p.total_price||0),0)},{name:"Sunset",bookings:s.filter(c=>c.opportunity_type==="sunset").length,revenue:s.filter(c=>c.opportunity_type==="sunset").reduce((c,p)=>c+(parseFloat(p.total_amount)||0),0)}],f={};n.forEach(c=>{const p=new Date(c.travel_date||c.booking_date),z=`${p.toLocaleString("default",{month:"short"})} ${p.getFullYear()}`;f[z]||(f[z]={private:0,shared:0,sunset:0}),c.cruise_type==="private"&&(f[z].private+=c.total_amount||c.total_price||0),c.cruise_type==="shared"&&(f[z].shared+=c.total_amount||c.total_price||0)});const v=Object.keys(f).slice(-6).map(c=>({month:c,Private:f[c].private,Shared:f[c].shared,Sunset:f[c].sunset})),q=[{stage:"New",count:s.filter(c=>c.stage==="new").length},{stage:"Contacted",count:s.filter(c=>c.stage==="contacted").length},{stage:"Quoted",count:s.filter(c=>c.stage==="quoted").length},{stage:"Negotiation",count:s.filter(c=>c.stage==="negotiation").length},{stage:"Won",count:s.filter(c=>c.stage==="won").length}],N=[{name:"Leads",value:s.length,fill:"#3b82f6"},{name:"Quoted",value:s.filter(c=>["quoted","negotiation","followup","won"].includes(c.stage)).length,fill:"#10b981"},{name:"Negotiation",value:s.filter(c=>["negotiation","followup","won"].includes(c.stage)).length,fill:"#f59e0b"},{name:"Won",value:s.filter(c=>c.stage==="won").length,fill:"#22c55e"}],b=[{title:"Active Yachts",value:o,total:l.length,icon:De,bgColor:"from-blue-500 to-blue-600",link:"Yachts"},{title:"Confirmed Bookings",value:x,total:n.length,icon:be,bgColor:"from-green-500 to-green-600",link:"Bookings"},{title:"Total Revenue",value:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),O.toLocaleString()]}),icon:oe,bgColor:"from-purple-500 to-purple-600",link:"Invoices"},{title:"Active Agents",value:u,total:r.length,icon:ye,bgColor:"from-orange-500 to-orange-600",link:"Agents"}],t=[{title:"New Booking",url:"Bookings",icon:be,color:"blue"},{title:"Add Yacht",url:"Yachts",icon:De,color:"green"},{title:"Manage Packages",url:"Packages",icon:Ye,color:"purple"},{title:"View Invoices",url:"Invoices",icon:oe,color:"orange"}];return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:"CRM Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Customer Relationship Management - Yacht Bookings & Operations"})]}),e.jsx(ge,{to:de("Dashboard"),children:e.jsxs(E,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Back to Home"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:b.map((c,p)=>e.jsx(ge,{to:de(c.link),children:e.jsxs(I,{className:"relative overflow-hidden border-none shadow-lg hover:shadow-xl transition-all duration-300 bg-white cursor-pointer",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${c.bgColor} opacity-10 rounded-bl-full`}),e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-sm font-medium text-gray-600",children:c.title}),e.jsx("div",{className:`p-2.5 rounded-xl bg-gradient-to-br ${c.bgColor}`,children:e.jsx(c.icon,{className:"w-5 h-5 text-white"})})]})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c.value}),c.total&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["of ",c.total," total"]})]}),e.jsx(We,{className:"w-5 h-5 text-gray-400"})]})})]})},p))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Sales Trend - Line Chart"})}),e.jsx(T,{children:e.jsx(es,{width:"100%",height:300,children:e.jsxs(Ut,{data:v,children:[e.jsx(js,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"month"}),e.jsx(vs,{}),e.jsx(ss,{}),e.jsx(Bs,{}),e.jsx(fs,{type:"monotone",dataKey:"Private",stroke:"#3b82f6",strokeWidth:2}),e.jsx(fs,{type:"monotone",dataKey:"Shared",stroke:"#10b981",strokeWidth:2}),e.jsx(fs,{type:"monotone",dataKey:"Sunset",stroke:"#f59e0b",strokeWidth:2})]})})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Cruise Type Revenue - Bar Chart"})}),e.jsx(T,{children:e.jsx(es,{width:"100%",height:300,children:e.jsxs(zs,{data:m,children:[e.jsx(js,{strokeDasharray:"3 3"}),e.jsx(bs,{dataKey:"name"}),e.jsx(vs,{}),e.jsx(ss,{}),e.jsx(Bs,{}),e.jsx(ys,{dataKey:"revenue",fill:"#3b82f6"}),e.jsx(ys,{dataKey:"bookings",fill:"#10b981"})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Sales Pipeline"})}),e.jsx(T,{children:e.jsx(es,{width:"100%",height:300,children:e.jsxs(zs,{data:q,layout:"vertical",children:[e.jsx(js,{strokeDasharray:"3 3"}),e.jsx(bs,{type:"number"}),e.jsx(vs,{dataKey:"stage",type:"category"}),e.jsx(ss,{}),e.jsx(ys,{dataKey:"count",fill:"#8b5cf6"})]})})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Sales Funnel"})}),e.jsx(T,{children:e.jsx(es,{width:"100%",height:300,children:e.jsxs(Qt,{children:[e.jsx(Yt,{data:N,cx:"50%",cy:"50%",labelLine:!1,label:({name:c,value:p})=>`${c}: ${p}`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:N.map((c,p)=>e.jsx(Ht,{fill:c.fill},`cell-${p}`))}),e.jsx(ss,{})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Quick Actions"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.map((c,p)=>e.jsx(ge,{to:de(c.url),children:e.jsxs("div",{className:`p-6 rounded-xl bg-gradient-to-br from-${c.color}-50 to-${c.color}-100 hover:shadow-md transition-all duration-200 cursor-pointer border border-${c.color}-200`,children:[e.jsx(c.icon,{className:`w-8 h-8 text-${c.color}-600 mb-3`}),e.jsx("h3",{className:"font-semibold text-gray-900",children:c.title})]})},p))})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Recent Bookings"})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[d.map((c,p)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(be,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:c.customer_name}),e.jsx("p",{className:"text-sm text-gray-500",children:c.booking_date})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-gray-900 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),c.total_amount||c.total_price]}),e.jsx(X,{className:c.status==="confirmed"?"bg-green-100 text-green-700":c.status==="completed"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700",children:c.status})]})]},p)),d.length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No bookings yet"})]})})]})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Fleet Status"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:l.slice(0,6).map((c,p)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:c.yacht_name}),e.jsx(X,{className:c.status==="active"?"bg-green-100 text-green-700":c.status==="maintenance"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700",children:c.status})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsxs("span",{children:[c.capacity," guests"]})]})]},p))})})]})]})})}function Bn(){const{data:n=[]}=L({queryKey:["employees"],queryFn:()=>k.entities.Employee.list()}),{data:l=[]}=L({queryKey:["attendance"],queryFn:()=>k.entities.Attendance.list("-date")}),{data:a=[]}=L({queryKey:["leaves"],queryFn:()=>k.entities.Leave.list("-created_date")}),{data:r=[]}=L({queryKey:["payroll"],queryFn:()=>k.entities.Payroll.list()}),s=n.filter(m=>m.status==="active").length,o=a.filter(m=>m.status==="pending").length,O=l.filter(m=>m.date===new Date().toISOString().split("T")[0]).filter(m=>m.status==="present").length,u=r.reduce((m,f)=>m+(f.net_salary||0),0),d=[{title:"Active Employees",value:s,total:n.length,icon:Re,bgColor:"from-blue-500 to-blue-600",link:"Employees"},{title:"Present Today",value:O,total:s,icon:Oe,bgColor:"from-green-500 to-green-600",link:"Attendance"},{title:"Pending Leave Requests",value:o,icon:be,bgColor:"from-orange-500 to-orange-600",link:"Leaves"},{title:"Total Payroll",value:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),u.toLocaleString()]}),icon:ls,bgColor:"from-purple-500 to-purple-600",link:"Payroll"}],D=[{title:"Add Employee",url:"Employees",icon:Re,color:"blue"},{title:"Mark Attendance",url:"Attendance",icon:Oe,color:"green"},{title:"Process Payroll",url:"Payroll",icon:ls,color:"purple"},{title:"Manage Leaves",url:"Leaves",icon:be,color:"orange"}],g=n.reduce((m,f)=>(m[f.department]=(m[f.department]||0)+1,m),{});return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:"HRM Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Human Resource Management - Employees, Attendance & Payroll"})]}),e.jsx(ge,{to:de("Dashboard"),children:e.jsxs(E,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Back to Home"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:d.map((m,f)=>e.jsx(ge,{to:de(m.link),children:e.jsxs(I,{className:"relative overflow-hidden border-none shadow-lg hover:shadow-xl transition-all duration-300 bg-white cursor-pointer",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${m.bgColor} opacity-10 rounded-bl-full`}),e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-sm font-medium text-gray-600",children:m.title}),e.jsx("div",{className:`p-2.5 rounded-xl bg-gradient-to-br ${m.bgColor}`,children:e.jsx(m.icon,{className:"w-5 h-5 text-white"})})]})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:m.value}),m.total&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["of ",m.total," total"]})]}),e.jsx(We,{className:"w-5 h-5 text-gray-400"})]})})]})},f))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Quick Actions"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:D.map((m,f)=>e.jsx(ge,{to:de(m.url),children:e.jsxs("div",{className:`p-6 rounded-xl bg-gradient-to-br from-${m.color}-50 to-${m.color}-100 hover:shadow-md transition-all duration-200 cursor-pointer border border-${m.color}-200`,children:[e.jsx(m.icon,{className:`w-8 h-8 text-${m.color}-600 mb-3`}),e.jsx("h3",{className:"font-semibold text-gray-900",children:m.title})]})},f))})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Pending Leave Requests"})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[a.filter(m=>m.status==="pending").slice(0,5).map((m,f)=>{const v=n.find(q=>q.id===m.employee_id);return e.jsxs("div",{className:"flex items-center gap-4 p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center",children:e.jsx(be,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:(v==null?void 0:v.name)||"Unknown"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[m.leave_type," - ",m.total_days," days"]})]}),e.jsx(X,{className:"bg-yellow-100 text-yellow-700",children:"Pending"})]},f)}),o===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No pending requests"})]})})]})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Department Distribution"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(g).map(([m,f],v)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all text-center",children:[e.jsx(ye,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold text-gray-900 capitalize",children:m}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:f}),e.jsx("p",{className:"text-sm text-gray-500",children:"employees"})]},v))})})]})]})})}function zn(){const{data:n=[]}=L({queryKey:["vendors"],queryFn:()=>k.entities.Vendor.list()}),{data:l=[]}=L({queryKey:["purchaseOrders"],queryFn:()=>k.entities.PurchaseOrder.list("-created_date")}),{data:a=[]}=L({queryKey:["inventory"],queryFn:()=>k.entities.InventoryItem.list()}),{data:r=[]}=L({queryKey:["stockMovements"],queryFn:()=>k.entities.StockMovement.list("-movement_date")}),s=n.filter(g=>g.status==="active").length,o=l.filter(g=>g.status==="pending").length,x=a.filter(g=>g.stock_qty<=(g.reorder_level||0)).length,O=a.reduce((g,m)=>g+m.stock_qty*m.unit_cost,0),u=[{title:"Active Vendors",value:s,total:n.length,icon:Ne,bgColor:"from-blue-500 to-blue-600",link:"Vendors"},{title:"Pending Orders",value:o,total:l.length,icon:Oe,bgColor:"from-orange-500 to-orange-600",link:"PurchaseOrders"},{title:"Low Stock Items",value:x,icon:Ke,bgColor:"from-red-500 to-red-600",link:"Inventory"},{title:"Inventory Value",value:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),O.toLocaleString()]}),icon:Se,bgColor:"from-green-500 to-green-600",link:"Inventory"}],d=[{title:"Add Vendor",url:"Vendors",icon:Ne,color:"blue"},{title:"Create PO",url:"PurchaseOrders",icon:Oe,color:"green"},{title:"Manage Inventory",url:"Inventory",icon:Ke,color:"purple"},{title:"Stock Movement",url:"Inventory",icon:Ye,color:"orange"}],D=a.reduce((g,m)=>(g[m.category]=(g[m.category]||0)+1,g),{});return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:"Purchase & Inventory Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Procurement, Inventory Management & Stock Control"})]}),e.jsx(ge,{to:de("Dashboard"),children:e.jsxs(E,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Back to Home"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map((g,m)=>e.jsx(ge,{to:de(g.link),children:e.jsxs(I,{className:"relative overflow-hidden border-none shadow-lg hover:shadow-xl transition-all duration-300 bg-white cursor-pointer",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${g.bgColor} opacity-10 rounded-bl-full`}),e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-sm font-medium text-gray-600",children:g.title}),e.jsx("div",{className:`p-2.5 rounded-xl bg-gradient-to-br ${g.bgColor}`,children:e.jsx(g.icon,{className:"w-5 h-5 text-white"})})]})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:g.value}),g.total&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["of ",g.total," total"]})]}),e.jsx(We,{className:"w-5 h-5 text-gray-400"})]})})]})},m))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Quick Actions"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:d.map((g,m)=>e.jsx(ge,{to:de(g.url),children:e.jsxs("div",{className:`p-6 rounded-xl bg-gradient-to-br from-${g.color}-50 to-${g.color}-100 hover:shadow-md transition-all duration-200 cursor-pointer border border-${g.color}-200`,children:[e.jsx(g.icon,{className:`w-8 h-8 text-${g.color}-600 mb-3`}),e.jsx("h3",{className:"font-semibold text-gray-900",children:g.title})]})},m))})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Low Stock Alerts"})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[a.filter(g=>g.stock_qty<=(g.reorder_level||0)).slice(0,5).map((g,m)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(Ke,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:g.item_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Stock: ",g.stock_qty," ",g.unit]})]}),e.jsx(X,{className:"bg-red-100 text-red-700",children:"Low Stock"})]},m)),x===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"All items well stocked"})]})})]})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Inventory by Category"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(D).map(([g,m],f)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all text-center",children:[e.jsx(Ye,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold text-gray-900 capitalize",children:g}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:m}),e.jsx("p",{className:"text-sm text-gray-500",children:"items"})]},f))})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Recent Stock Movements"})}),e.jsx(T,{children:e.jsx("div",{className:"space-y-3",children:r.slice(0,5).map((g,m)=>{const f=a.find(v=>v.id===g.item_id);return e.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${g.movement_type==="in"?"bg-green-500":"bg-red-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:(f==null?void 0:f.item_name)||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-500",children:g.reason})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-semibold ${g.movement_type==="in"?"text-green-600":"text-red-600"}`,children:[g.movement_type==="in"?"+":"-",g.quantity]}),e.jsx("p",{className:"text-sm text-gray-500",children:g.movement_date})]})]},m)})})})]})]})})}function Ln(){const{data:n=[]}=L({queryKey:["ledger"],queryFn:()=>k.entities.LedgerEntry.list("-transaction_date")}),{data:l=[]}=L({queryKey:["financialReports"],queryFn:()=>k.entities.FinancialReport.list("-year")}),a=n.filter(d=>d.entry_type==="income").reduce((d,D)=>d+(D.amount||0),0),r=n.filter(d=>d.entry_type==="expense").reduce((d,D)=>d+(D.amount||0),0),s=a-r,o=n.filter(d=>d.entry_type==="income").reduce((d,D)=>(d[D.source_module]=(d[D.source_module]||0)+D.amount,d),{}),x=n.filter(d=>d.entry_type==="expense").reduce((d,D)=>{const g=D.category||"Other";return d[g]=(d[g]||0)+D.amount,d},{}),O=[{title:"Total Income",value:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),a.toLocaleString()]}),icon:we,bgColor:"from-green-500 to-green-600",link:"Ledger"},{title:"Total Expenses",value:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),r.toLocaleString()]}),icon:Se,bgColor:"from-red-500 to-red-600",link:"Ledger"},{title:"Net Profit/Loss",value:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),s.toLocaleString()]}),icon:oe,bgColor:s>=0?"from-blue-500 to-blue-600":"from-orange-500 to-orange-600",link:"Ledger"},{title:"Financial Reports",value:l.length,icon:fe,bgColor:"from-purple-500 to-purple-600",link:"FinancialReports"}],u=[{title:"View Ledger",url:"Ledger",icon:oe,color:"blue"},{title:"Generate Report",url:"FinancialReports",icon:fe,color:"green"},{title:"Add Entry",url:"Ledger",icon:we,color:"purple"},{title:"View Reports",url:"FinancialReports",icon:Se,color:"orange"}];return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:"Accounts Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Financial Management - Ledger, Reports & Analytics"})]}),e.jsx(ge,{to:de("Dashboard"),children:e.jsxs(E,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Back to Home"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:O.map((d,D)=>e.jsx(ge,{to:de(d.link),children:e.jsxs(I,{className:"relative overflow-hidden border-none shadow-lg hover:shadow-xl transition-all duration-300 bg-white cursor-pointer",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${d.bgColor} opacity-10 rounded-bl-full`}),e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-sm font-medium text-gray-600",children:d.title}),e.jsx("div",{className:`p-2.5 rounded-xl bg-gradient-to-br ${d.bgColor}`,children:e.jsx(d.icon,{className:"w-5 h-5 text-white"})})]})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("div",{children:e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:d.value})}),e.jsx(We,{className:"w-5 h-5 text-gray-400"})]})})]})},D))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Quick Actions"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:u.map((d,D)=>e.jsx(ge,{to:de(d.url),children:e.jsxs("div",{className:`p-6 rounded-xl bg-gradient-to-br from-${d.color}-50 to-${d.color}-100 hover:shadow-md transition-all duration-200 cursor-pointer border border-${d.color}-200`,children:[e.jsx(d.icon,{className:`w-8 h-8 text-${d.color}-600 mb-3`}),e.jsx("h3",{className:"font-semibold text-gray-900",children:d.title})]})},D))})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Income by Module"})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-3",children:[Object.entries(o).map(([d,D],g)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:d}),e.jsxs("span",{className:"font-bold text-green-700 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),D.toLocaleString()]})]},g)),Object.keys(o).length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No income recorded"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Expenses by Category"})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-3",children:[Object.entries(x).map(([d,D],g)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-lg",children:[e.jsx("span",{className:"font-medium text-gray-900",children:d}),e.jsxs("span",{className:"font-bold text-red-700 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),D.toLocaleString()]})]},g)),Object.keys(x).length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No expenses recorded"})]})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Recent Transactions"})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-3",children:[n.slice(0,5).map((d,D)=>e.jsxs("div",{className:"flex justify-between items-center p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:d.description}),e.jsx("p",{className:"text-sm text-gray-500",children:d.transaction_date})]}),e.jsx(X,{className:d.entry_type==="income"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),d.amount]})})]},D)),n.length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No transactions yet"})]})})]})]})]})})}function $n(){const{data:n=[]}=L({queryKey:["posOrders"],queryFn:()=>k.entities.POSOrder.list("-created_date")}),{data:l=[]}=L({queryKey:["posItems"],queryFn:()=>k.entities.POSItem.list()}),{data:a=[]}=L({queryKey:["posCategories"],queryFn:()=>k.entities.POSCategory.list()}),r=new Date().toISOString().split("T")[0],s=n.filter(g=>g.order_date===r),o=s.reduce((g,m)=>g+(m.total_amount||0),0),x=n.filter(g=>g.status==="pending").length,O=n.reduce((g,m)=>g+(m.total_amount||0),0),u=[{title:"Today's Orders",value:s.length,icon:fe,bgColor:"from-blue-500 to-blue-600",link:"POSOrders"},{title:"Today's Revenue",value:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),o.toLocaleString()]}),icon:oe,bgColor:"from-green-500 to-green-600",link:"POSOrders"},{title:"Pending Orders",value:x,icon:qe,bgColor:"from-orange-500 to-orange-600",link:"POSOrders"},{title:"Total Revenue",value:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),O.toLocaleString()]}),icon:we,bgColor:"from-purple-500 to-purple-600",link:"POSOrders"}],d=[{title:"Restaurant POS",url:"RestaurantPOS",icon:qe,color:"blue"},{title:"Bar POS",url:"BarPOS",icon:Me,color:"green"},{title:"View Orders",url:"POSOrders",icon:fe,color:"purple"},{title:"Menu Items",url:"POSItems",icon:oe,color:"orange"}],D=n.reduce((g,m)=>(g[m.order_type]=(g[m.order_type]||0)+1,g),{});return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:"POS Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Point of Sale - Restaurant & Bar Operations"})]}),e.jsx(ge,{to:de("Dashboard"),children:e.jsxs(E,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Back to Home"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map((g,m)=>e.jsx(ge,{to:de(g.link),children:e.jsxs(I,{className:"relative overflow-hidden border-none shadow-lg hover:shadow-xl transition-all duration-300 bg-white cursor-pointer",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${g.bgColor} opacity-10 rounded-bl-full`}),e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(J,{className:"text-sm font-medium text-gray-600",children:g.title}),e.jsx("div",{className:`p-2.5 rounded-xl bg-gradient-to-br ${g.bgColor}`,children:e.jsx(g.icon,{className:"w-5 h-5 text-white"})})]})}),e.jsx(T,{children:e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsx("div",{children:e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:g.value})}),e.jsx(We,{className:"w-5 h-5 text-gray-400"})]})})]})},m))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Quick Actions"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:d.map((g,m)=>e.jsx(ge,{to:de(g.url),children:e.jsxs("div",{className:`p-6 rounded-xl bg-gradient-to-br from-${g.color}-50 to-${g.color}-100 hover:shadow-md transition-all duration-200 cursor-pointer border border-${g.color}-200`,children:[e.jsx(g.icon,{className:`w-8 h-8 text-${g.color}-600 mb-3`}),e.jsx("h3",{className:"font-semibold text-gray-900",children:g.title})]})},m))})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Recent Orders"})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[n.slice(0,5).map((g,m)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 hover:bg-gray-50 rounded-lg transition-colors",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(fe,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-900",children:["Order #",g.order_number]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[g.order_type," - ",g.order_date]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-gray-900 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),g.total_amount]}),e.jsx(X,{className:g.status==="completed"?"bg-green-100 text-green-700":g.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700",children:g.status})]})]},m)),n.length===0&&e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No orders yet"})]})})]})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Order Type Breakdown"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(D).map(([g,m],f)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all text-center",children:[e.jsx(qe,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("h3",{className:"font-semibold text-gray-900 capitalize",children:g}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:m}),e.jsx("p",{className:"text-sm text-gray-500",children:"orders"})]},f))})})]}),e.jsxs(I,{className:"border-none shadow-lg bg-white",children:[e.jsx(W,{children:e.jsx(J,{className:"text-xl font-bold",children:"Sales Performance"})}),e.jsx(T,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(oe,{className:"w-20 h-20 text-green-600 mx-auto mb-4"}),e.jsxs("p",{className:"text-4xl font-bold text-gray-900 flex items-center justify-center gap-2",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-8 h-8 inline-block"}),O.toLocaleString()]}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Total Sales Revenue"})]})})]})]})})}function Vn({opportunity:n,onSubmit:l,onCancel:a}){const[r,s]=j.useState({opportunity_code:(n==null?void 0:n.opportunity_code)||`OPC-${new Date().getFullYear()}-${String(Math.floor(Math.random()*1e4)).padStart(4,"0")}`,opportunity_type:(n==null?void 0:n.opportunity_type)||"private",lead_source:(n==null?void 0:n.lead_source)||"website",stage:(n==null?void 0:n.stage)||"new",client_id:(n==null?void 0:n.client_id)||"",agent_id:(n==null?void 0:n.agent_id)||"",agent_discount_percentage:(n==null?void 0:n.agent_discount_percentage)||0,client_discount_percentage:(n==null?void 0:n.client_discount_percentage)||0,yacht_id:(n==null?void 0:n.yacht_id)||"",package_name:(n==null?void 0:n.package_name)||"",adults:(n==null?void 0:n.adults)||0,kids:(n==null?void 0:n.kids)||0,vip_guests:(n==null?void 0:n.vip_guests)||0,date_of_charter:(n==null?void 0:n.date_of_charter)||"",time_slot:(n==null?void 0:n.time_slot)||"",duration_hours:(n==null?void 0:n.duration_hours)||2,route:(n==null?void 0:n.route)||"",base_price:(n==null?void 0:n.base_price)||0,vip_cost:(n==null?void 0:n.vip_cost)||0,alcohol_cost:(n==null?void 0:n.alcohol_cost)||0,catering_cost:(n==null?void 0:n.catering_cost)||0,extra_hour_cost:(n==null?void 0:n.extra_hour_cost)||0,addons_total:(n==null?void 0:n.addons_total)||0,vat_percentage:(n==null?void 0:n.vat_percentage)||5,probability_percentage:(n==null?void 0:n.probability_percentage)||50,advance_paid:(n==null?void 0:n.advance_paid)||0,payment_method:(n==null?void 0:n.payment_method)||"",payment_due_date:(n==null?void 0:n.payment_due_date)||"",followup_date:(n==null?void 0:n.followup_date)||"",notes:(n==null?void 0:n.notes)||"",lost_reason:(n==null?void 0:n.lost_reason)||""}),{data:o=[]}=L({queryKey:["clients"],queryFn:()=>k.entities.Client.list()}),{data:x=[]}=L({queryKey:["agents"],queryFn:()=>k.entities.Agent.list()}),{data:O=[]}=L({queryKey:["yachts"],queryFn:()=>k.entities.Yacht.list()});j.useEffect(()=>{const d=parseFloat(r.base_price)||0,D=parseFloat(r.vip_cost)||0,g=parseFloat(r.alcohol_cost)||0,m=parseFloat(r.catering_cost)||0,f=parseFloat(r.extra_hour_cost)||0,v=parseFloat(r.addons_total)||0,q=parseFloat(r.agent_discount_percentage)||0,N=parseFloat(r.client_discount_percentage)||0,b=d+D+g+m+f+v,t=b*q/100,c=b*N/100,p=b-t-c,z=p*r.vat_percentage/100,P=p+z,F=parseFloat(r.advance_paid)||0,R=P-F,w=parseFloat(r.probability_percentage)||0,A=P*w/100;s(V=>({...V,subtotal:p.toFixed(2),vat_amount:z.toFixed(2),total_amount:P.toFixed(2),balance_amount:R.toFixed(2),expected_revenue:A.toFixed(2)}))},[r.base_price,r.vip_cost,r.alcohol_cost,r.catering_cost,r.extra_hour_cost,r.addons_total,r.agent_discount_percentage,r.client_discount_percentage,r.vat_percentage,r.advance_paid,r.probability_percentage]),j.useEffect(()=>{if(r.agent_id){const d=x.find(D=>D.id===r.agent_id);d&&s(D=>({...D,agent_discount_percentage:d.commission_percentage||0}))}},[r.agent_id,x]),j.useEffect(()=>{if(r.client_id){const d=o.find(D=>D.id===r.client_id);d&&s(D=>({...D,client_discount_percentage:d.discount_percentage||0}))}},[r.client_id,o]);const u=d=>{d.preventDefault();const D={...r,adults:parseInt(r.adults)||0,kids:parseInt(r.kids)||0,vip_guests:parseInt(r.vip_guests)||0,duration_hours:parseFloat(r.duration_hours)||0,base_price:parseFloat(r.base_price)||0,vip_cost:parseFloat(r.vip_cost)||0,alcohol_cost:parseFloat(r.alcohol_cost)||0,catering_cost:parseFloat(r.catering_cost)||0,extra_hour_cost:parseFloat(r.extra_hour_cost)||0,addons_total:parseFloat(r.addons_total)||0,agent_discount_percentage:parseFloat(r.agent_discount_percentage)||0,client_discount_percentage:parseFloat(r.client_discount_percentage)||0,vat_percentage:parseFloat(r.vat_percentage)||0,subtotal:parseFloat(r.subtotal)||0,vat_amount:parseFloat(r.vat_amount)||0,total_amount:parseFloat(r.total_amount)||0,expected_revenue:parseFloat(r.expected_revenue)||0,probability_percentage:parseFloat(r.probability_percentage)||0,advance_paid:parseFloat(r.advance_paid)||0,balance_amount:parseFloat(r.balance_amount)||0};l(D)};return e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs(I,{children:[e.jsx(W,{children:e.jsx(J,{children:"Basic Information"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Opportunity Code *"}),e.jsx(_,{value:r.opportunity_code,onChange:d=>s({...r,opportunity_code:d.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Type *"}),e.jsxs(Y,{value:r.opportunity_type,onValueChange:d=>s({...r,opportunity_type:d}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"private",children:"Private"}),e.jsx(h,{value:"shared",children:"Shared"}),e.jsx(h,{value:"vip",children:"VIP"}),e.jsx(h,{value:"sunset",children:"Sunset"}),e.jsx(h,{value:"event",children:"Event"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Lead Source *"}),e.jsxs(Y,{value:r.lead_source,onValueChange:d=>s({...r,lead_source:d}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"website",children:"Website"}),e.jsx(h,{value:"whatsapp",children:"WhatsApp"}),e.jsx(h,{value:"agent",children:"Agent"}),e.jsx(h,{value:"instagram",children:"Instagram"}),e.jsx(h,{value:"facebook",children:"Facebook"}),e.jsx(h,{value:"referral",children:"Referral"}),e.jsx(h,{value:"repeat",children:"Repeat Client"}),e.jsx(h,{value:"other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Client *"}),e.jsxs(Y,{value:r.client_id,onValueChange:d=>s({...r,client_id:d}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select client"})}),e.jsx(Q,{children:o.map(d=>e.jsx(h,{value:d.id,children:d.client_name},d.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Agent (Optional)"}),e.jsxs(Y,{value:r.agent_id,onValueChange:d=>s({...r,agent_id:d}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Direct booking"})}),e.jsx(Q,{children:x.map(d=>e.jsx(h,{value:d.id,children:d.agent_name},d.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Stage *"}),e.jsxs(Y,{value:r.stage,onValueChange:d=>s({...r,stage:d}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"new",children:"New"}),e.jsx(h,{value:"contacted",children:"Contacted"}),e.jsx(h,{value:"quoted",children:"Quoted"}),e.jsx(h,{value:"negotiation",children:"Negotiation"}),e.jsx(h,{value:"followup",children:"Follow-up"}),e.jsx(h,{value:"won",children:"Won"}),e.jsx(h,{value:"lost",children:"Lost"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Probability %"}),e.jsx(_,{type:"number",step:"1",value:r.probability_percentage,onChange:d=>s({...r,probability_percentage:d.target.value})})]})]})]})]}),e.jsxs(I,{children:[e.jsx(W,{children:e.jsx(J,{children:"Charter Details"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Yacht *"}),e.jsxs(Y,{value:r.yacht_id,onValueChange:d=>s({...r,yacht_id:d}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select yacht"})}),e.jsx(Q,{children:O.map(d=>e.jsx(h,{value:d.id,children:d.yacht_name},d.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Package Name"}),e.jsx(_,{value:r.package_name,onChange:d=>s({...r,package_name:d.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Adults"}),e.jsx(_,{type:"number",value:r.adults,onChange:d=>s({...r,adults:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Kids"}),e.jsx(_,{type:"number",value:r.kids,onChange:d=>s({...r,kids:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"VIP Guests"}),e.jsx(_,{type:"number",value:r.vip_guests,onChange:d=>s({...r,vip_guests:d.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Date of Charter"}),e.jsx(_,{type:"date",value:r.date_of_charter,onChange:d=>s({...r,date_of_charter:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Time Slot"}),e.jsx(_,{type:"time",value:r.time_slot,onChange:d=>s({...r,time_slot:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Duration (Hours)"}),e.jsx(_,{type:"number",step:"0.5",value:r.duration_hours,onChange:d=>s({...r,duration_hours:d.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Route/Destination"}),e.jsx(_,{value:r.route,onChange:d=>s({...r,route:d.target.value}),placeholder:"e.g., Dubai Marina to Atlantis"})]})]})]}),e.jsxs(I,{children:[e.jsx(W,{children:e.jsx(J,{children:"Pricing & Costs"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Base Price"}),e.jsx(_,{type:"number",step:"0.01",value:r.base_price,onChange:d=>s({...r,base_price:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"VIP Cost"}),e.jsx(_,{type:"number",step:"0.01",value:r.vip_cost,onChange:d=>s({...r,vip_cost:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Alcohol Cost"}),e.jsx(_,{type:"number",step:"0.01",value:r.alcohol_cost,onChange:d=>s({...r,alcohol_cost:d.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Catering Cost"}),e.jsx(_,{type:"number",step:"0.01",value:r.catering_cost,onChange:d=>s({...r,catering_cost:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Extra Hour Cost"}),e.jsx(_,{type:"number",step:"0.01",value:r.extra_hour_cost,onChange:d=>s({...r,extra_hour_cost:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Add-ons Total"}),e.jsx(_,{type:"number",step:"0.01",value:r.addons_total,onChange:d=>s({...r,addons_total:d.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Agent Discount %"}),e.jsx(_,{type:"number",step:"0.01",value:r.agent_discount_percentage,onChange:d=>s({...r,agent_discount_percentage:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Client Discount %"}),e.jsx(_,{type:"number",step:"0.01",value:r.client_discount_percentage,onChange:d=>s({...r,client_discount_percentage:d.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-sm",children:"Subtotal"}),e.jsxs("div",{className:"bg-white p-2 rounded font-bold flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),r.subtotal]})]}),e.jsxs("div",{children:[e.jsxs(i,{className:"text-sm",children:["VAT (",r.vat_percentage,"%)"]}),e.jsxs("div",{className:"bg-white p-2 rounded flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),r.vat_amount]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-sm",children:"Total Amount"}),e.jsxs("div",{className:"bg-white p-2 rounded font-bold text-lg flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-4 h-4 inline-block"}),r.total_amount]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-sm",children:"Expected Revenue"}),e.jsxs("div",{className:"bg-white p-2 rounded text-green-700 font-bold flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),r.expected_revenue]})]})]})]})]}),e.jsxs(I,{children:[e.jsx(W,{children:e.jsx(J,{children:"Payment Details"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Advance Paid"}),e.jsx(_,{type:"number",step:"0.01",value:r.advance_paid,onChange:d=>s({...r,advance_paid:d.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Balance"}),e.jsxs("div",{className:"bg-gray-50 p-2 rounded font-bold flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),r.balance_amount]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Due Date"}),e.jsx(_,{type:"date",value:r.payment_due_date,onChange:d=>s({...r,payment_due_date:d.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Method"}),e.jsxs(Y,{value:r.payment_method,onValueChange:d=>s({...r,payment_method:d}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select method"})}),e.jsxs(Q,{children:[e.jsx(h,{value:"cash",children:"Cash"}),e.jsx(h,{value:"card",children:"Card"}),e.jsx(h,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(h,{value:"online",children:"Online"}),e.jsx(h,{value:"other",children:"Other"})]})]})]})]})]}),e.jsxs(I,{children:[e.jsx(W,{children:e.jsx(J,{children:"CRM & Follow-up"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Follow-up Date"}),e.jsx(_,{type:"date",value:r.followup_date,onChange:d=>s({...r,followup_date:d.target.value})})]}),r.stage==="lost"&&e.jsxs("div",{children:[e.jsx(i,{children:"Lost Reason"}),e.jsx(ve,{value:r.lost_reason,onChange:d=>s({...r,lost_reason:d.target.value}),rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(ve,{value:r.notes,onChange:d=>s({...r,notes:d.target.value}),rows:4})]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:a,children:"Cancel"}),e.jsxs(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[n?"Update":"Create"," Opportunity"]})]})]})}const $s={new:{label:"New",color:"bg-gray-100 text-gray-700",borderColor:"border-gray-300"},contacted:{label:"Contacted",color:"bg-blue-100 text-blue-700",borderColor:"border-blue-300"},quoted:{label:"Quoted",color:"bg-purple-100 text-purple-700",borderColor:"border-purple-300"},negotiation:{label:"Negotiation",color:"bg-yellow-100 text-yellow-700",borderColor:"border-yellow-300"},followup:{label:"Follow-up",color:"bg-orange-100 text-orange-700",borderColor:"border-orange-300"},won:{label:"Won",color:"bg-green-100 text-green-700",borderColor:"border-green-300"},lost:{label:"Lost",color:"bg-red-100 text-red-700",borderColor:"border-red-300"}};function Kn({opportunities:n,clients:l,yachts:a,onViewOpportunity:r}){const s=Object.keys($s),o=u=>n.filter(d=>d.stage===u),x=u=>{const d=l.find(D=>D.id===u);return(d==null?void 0:d.client_name)||"Unknown"},O=u=>{const d=a.find(D=>D.id===u);return(d==null?void 0:d.yacht_name)||"N/A"};return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(u=>{const d=o(u),D=d.reduce((m,f)=>m+(parseFloat(f.total_amount)||0),0),g=$s[u];return e.jsx("div",{children:e.jsxs(I,{className:`border-t-4 ${g.borderColor}`,children:[e.jsxs(W,{className:"pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(J,{className:"text-sm font-semibold",children:g.label}),e.jsx(X,{className:g.color,children:d.length})]}),e.jsxs("p",{className:"text-xs text-gray-500 font-semibold flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),D.toLocaleString()]})]}),e.jsxs(T,{className:"space-y-3 max-h-[500px] overflow-y-auto",children:[d.map(m=>e.jsx(I,{className:"border hover:shadow-md transition-shadow cursor-pointer",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm",children:m.opportunity_code}),e.jsx("p",{className:"text-xs text-gray-600",children:x(m.client_id)})]}),e.jsx(X,{className:"text-xs capitalize",children:m.opportunity_type})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx(be,{className:"w-3 h-3"}),m.date_of_charter||"Not set"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx(ye,{className:"w-3 h-3"}),O(m.yacht_id)]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(oe,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{className:"font-bold text-sm flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),m.total_amount]})]}),e.jsx(E,{size:"sm",variant:"ghost",onClick:()=>r(m),children:e.jsx(Os,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Probability: ",m.probability_percentage,"%"]})]})})},m.id)),d.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No opportunities"})]})]})},u)})})}function Un(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState("pipeline"),[x,O]=j.useState(""),[u,d]=j.useState("all"),[D,g]=j.useState(!1),[m,f]=j.useState(null),v=ce(),{data:q=[]}=L({queryKey:["opportunities"],queryFn:()=>k.entities.Opportunity.list("-created_date")}),{data:N=[]}=L({queryKey:["clients"],queryFn:()=>k.entities.Client.list()}),{data:b=[]}=L({queryKey:["yachts"],queryFn:()=>k.entities.Yacht.list()}),{data:t=[]}=L({queryKey:["agents"],queryFn:()=>k.entities.Agent.list()}),c=Z({mutationFn:async B=>{const se=await k.entities.Opportunity.create(B);return await k.entities.OpportunityLog.create({opportunity_id:se.id,message_type:"note",message_content:`Opportunity created at stage: ${B.stage}`}),se},onSuccess:()=>{v.invalidateQueries(["opportunities"]),P()}}),p=Z({mutationFn:async({id:B,data:se,previousStage:pe})=>{const je=await k.entities.Opportunity.update(B,se);return pe!==se.stage&&await k.entities.OpportunityLog.create({opportunity_id:B,message_type:"stage_change",message_content:`Stage changed from ${pe} to ${se.stage}`,previous_stage:pe,new_stage:se.stage}),je},onSuccess:()=>{v.invalidateQueries(["opportunities"]),P()}}),z=Z({mutationFn:async B=>{const se=N.find(_e=>_e.id===B.client_id),pe={ticket_number:`TKT-${Date.now()}`,yacht_id:B.yacht_id,cruise_type:B.opportunity_type==="private"?"private":"shared",customer_name:(se==null?void 0:se.client_name)||"Unknown",customer_phone:(se==null?void 0:se.phone)||"",customer_email:(se==null?void 0:se.email)||"",number_of_people:(B.adults||0)+(B.kids||0),travel_date:B.date_of_charter,booking_date:new Date().toISOString().split("T")[0],agent_id:B.agent_id,other_charges:B.addons_total||0,total_amount:B.total_amount,discount_percentage:B.agent_discount_percentage+B.client_discount_percentage,net_amount:B.total_amount,paid_amount:B.advance_paid||0,balance:B.balance_amount||0,status:"confirmed",payment_status:B.balance_amount>0?"partial":"paid",payment_mode:B.payment_method,notes:`Converted from Opportunity: ${B.opportunity_code}
${B.notes||""}`},je=await k.entities.Booking.create(pe);return await k.entities.Opportunity.update(B.id,{stage:"won",converted_booking_id:je.id}),await k.entities.OpportunityLog.create({opportunity_id:B.id,message_type:"note",message_content:`Converted to Booking: ${je.ticket_number}`}),je},onSuccess:()=>{v.invalidateQueries(["opportunities"]),v.invalidateQueries(["bookings"]),g(!1),f(null)}}),P=()=>{r(null),l(!1)},F=B=>{r(B),l(!0)},R=B=>{a?p.mutate({id:a.id,data:B,previousStage:a.stage}):c.mutate(B)},w=B=>{f(B),g(!0)},A=q.filter(B=>{var je,_e,ke;const se=((je=B.opportunity_code)==null?void 0:je.toLowerCase().includes(x.toLowerCase()))||((ke=(_e=N.find(Fe=>Fe.id===B.client_id))==null?void 0:_e.client_name)==null?void 0:ke.toLowerCase().includes(x.toLowerCase())),pe=u==="all"||B.stage===u;return se&&pe}),V=B=>{var se;return((se=N.find(pe=>pe.id===B))==null?void 0:se.client_name)||"Unknown"},M=B=>{var se;return((se=b.find(pe=>pe.id===B))==null?void 0:se.yacht_name)||"N/A"},y={new:"bg-gray-100 text-gray-700",contacted:"bg-blue-100 text-blue-700",quoted:"bg-purple-100 text-purple-700",negotiation:"bg-yellow-100 text-yellow-700",followup:"bg-orange-100 text-orange-700",won:"bg-green-100 text-green-700",lost:"bg-red-100 text-red-700"},K=A.reduce((B,se)=>B+(parseFloat(se.total_amount)||0),0),G=A.reduce((B,se)=>B+(parseFloat(se.expected_revenue)||0),0),te=q.filter(B=>B.stage==="won").length,ee=q.filter(B=>B.stage==="lost").length;return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Opportunity Management"}),e.jsx("p",{className:"text-gray-600",children:"Track and manage charter opportunities"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"New Opportunity"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(I,{children:e.jsxs(T,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Opportunities"}),e.jsx("p",{className:"text-2xl font-bold",children:A.length})]})}),e.jsx(I,{children:e.jsxs(T,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Value"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),K.toLocaleString()]})]})}),e.jsx(I,{children:e.jsxs(T,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Expected Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-5 h-5 inline-block"}),G.toLocaleString()]})]})}),e.jsx(I,{children:e.jsxs(T,{className:"p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Won / Lost"}),e.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[e.jsxs("span",{className:"text-xl font-bold text-green-600 flex items-center gap-1",children:[e.jsx(qs,{className:"w-5 h-5"})," ",te]}),e.jsxs("span",{className:"text-xl font-bold text-red-600 flex items-center gap-1",children:[e.jsx(ca,{className:"w-5 h-5"})," ",ee]})]})]})})]}),e.jsx(I,{className:"mb-6",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-stretch md:items-center",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(jt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(_,{placeholder:"Search by code or client name...",value:x,onChange:B=>O(B.target.value),className:"pl-10"})]}),e.jsxs(Y,{value:u,onValueChange:d,children:[e.jsxs(U,{className:"w-full md:w-48",children:[e.jsx(bt,{className:"w-4 h-4 mr-2"}),e.jsx(H,{})]}),e.jsxs(Q,{children:[e.jsx(h,{value:"all",children:"All Stages"}),e.jsx(h,{value:"new",children:"New"}),e.jsx(h,{value:"contacted",children:"Contacted"}),e.jsx(h,{value:"quoted",children:"Quoted"}),e.jsx(h,{value:"negotiation",children:"Negotiation"}),e.jsx(h,{value:"followup",children:"Follow-up"}),e.jsx(h,{value:"won",children:"Won"}),e.jsx(h,{value:"lost",children:"Lost"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:s==="pipeline"?"default":"outline",size:"sm",onClick:()=>o("pipeline"),children:e.jsx(vt,{className:"w-4 h-4"})}),e.jsx(E,{variant:s==="list"?"default":"outline",size:"sm",onClick:()=>o("list"),children:e.jsx(ft,{className:"w-4 h-4"})})]})]})})}),s==="pipeline"?e.jsx(Kn,{opportunities:A,clients:N,yachts:b,onViewOpportunity:F}):e.jsx(I,{className:"border-none shadow-lg",children:e.jsx(T,{className:"p-0 overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{className:"whitespace-nowrap",children:"Code"}),e.jsx(C,{className:"whitespace-nowrap",children:"Client"}),e.jsx(C,{className:"whitespace-nowrap",children:"Type"}),e.jsx(C,{className:"whitespace-nowrap",children:"Yacht"}),e.jsx(C,{className:"whitespace-nowrap",children:"Date"}),e.jsx(C,{className:"whitespace-nowrap",children:"Total"}),e.jsx(C,{className:"whitespace-nowrap",children:"Expected"}),e.jsx(C,{className:"whitespace-nowrap",children:"Stage"}),e.jsx(C,{className:"whitespace-nowrap",children:"Actions"})]})}),e.jsx(ue,{children:A.map(B=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium whitespace-nowrap",children:B.opportunity_code}),e.jsx(S,{className:"whitespace-nowrap",children:V(B.client_id)}),e.jsx(S,{className:"whitespace-nowrap",children:e.jsx(X,{className:"capitalize",children:B.opportunity_type})}),e.jsx(S,{className:"whitespace-nowrap",children:M(B.yacht_id)}),e.jsx(S,{className:"whitespace-nowrap",children:B.date_of_charter||"Not set"}),e.jsxs(S,{className:"font-semibold whitespace-nowrap flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),B.total_amount]}),e.jsx(S,{className:"text-green-600 font-semibold whitespace-nowrap",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),B.expected_revenue]})}),e.jsx(S,{className:"whitespace-nowrap",children:e.jsx(X,{className:y[B.stage],children:B.stage})}),e.jsx(S,{className:"whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{size:"sm",variant:"outline",onClick:()=>F(B),children:"Edit"}),B.stage!=="won"&&B.stage!=="lost"&&e.jsx(E,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>w(B),children:"Convert"})]})})]},B.id))})]})})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Opportunity":"New Opportunity"})}),e.jsx(Vn,{opportunity:a,onSubmit:R,onCancel:P})]})}),e.jsx(ie,{open:D,onOpenChange:g,children:e.jsxs(ne,{children:[e.jsx(le,{children:e.jsx(re,{children:"Convert to Booking"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"Are you sure you want to convert this opportunity to a confirmed booking?"}),m&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:m.opportunity_code}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Client: ",V(m.client_id)]}),e.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:["Total:",e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),m.total_amount]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(E,{className:"bg-green-600 hover:bg-green-700",onClick:()=>z.mutate(m),children:"Confirm Conversion"})]})]})]})})]})})}function Qn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState({ticket_number:"",yacht_id:"",customer_name:"",customer_phone:"",customer_email:"",number_of_people:"",travel_date:"",booking_date:new Date().toISOString().split("T")[0],agent_id:"",free_tickets:"0",other_charges:"0",upgrade_from:"",upgrade_to:"",upgrade_cost:"0",upgrade_members:"",total_amount:"0",discount_percentage:"0",net_amount:"0",paid_amount:"0",balance:"0",status:"confirmed",payment_status:"unpaid",payment_mode:"",notes:""}),x=ce(),{data:O=[]}=L({queryKey:["privateBookings"],queryFn:async()=>(await k.entities.Booking.list("-created_date")).filter(c=>c.cruise_type==="private")}),{data:u=[]}=L({queryKey:["yachts"],queryFn:async()=>(await k.entities.Yacht.list()).filter(c=>c.cruise_type==="private")}),{data:d=[]}=L({queryKey:["agents"],queryFn:()=>k.entities.Agent.list()}),D=Z({mutationFn:t=>k.entities.Booking.create(t),onSuccess:()=>{x.invalidateQueries(["privateBookings"]),m()}}),g=Z({mutationFn:({id:t,data:c})=>k.entities.Booking.update(t,c),onSuccess:()=>{x.invalidateQueries(["privateBookings"]),m()}});j.useEffect(()=>{const t=parseFloat(s.total_amount)||0,c=parseFloat(s.discount_percentage)||0,p=t-t*c/100,z=parseFloat(s.paid_amount)||0,P=p-z;o(F=>({...F,net_amount:p.toFixed(2),balance:P.toFixed(2)}))},[s.total_amount,s.discount_percentage,s.paid_amount]);const m=()=>{o({ticket_number:"",yacht_id:"",customer_name:"",customer_phone:"",customer_email:"",number_of_people:"",travel_date:"",booking_date:new Date().toISOString().split("T")[0],agent_id:"",free_tickets:"0",other_charges:"0",upgrade_from:"",upgrade_to:"",upgrade_cost:"0",upgrade_members:"",total_amount:"0",discount_percentage:"0",net_amount:"0",paid_amount:"0",balance:"0",status:"confirmed",payment_status:"unpaid",payment_mode:"",notes:""}),r(null),l(!1)},f=t=>{t.preventDefault();const c={...s,cruise_type:"private",number_of_people:parseInt(s.number_of_people)||0,free_tickets:parseInt(s.free_tickets)||0,other_charges:parseFloat(s.other_charges)||0,upgrade_cost:parseFloat(s.upgrade_cost)||0,total_amount:parseFloat(s.total_amount)||0,discount_percentage:parseFloat(s.discount_percentage)||0,net_amount:parseFloat(s.net_amount)||0,paid_amount:parseFloat(s.paid_amount)||0,balance:parseFloat(s.balance)||0};a?g.mutate({id:a.id,data:c}):D.mutate(c)},v=t=>{var c,p,z,P,F,R,w,A,V;r(t),o({ticket_number:t.ticket_number,yacht_id:t.yacht_id,customer_name:t.customer_name,customer_phone:t.customer_phone,customer_email:t.customer_email||"",number_of_people:((c=t.number_of_people)==null?void 0:c.toString())||"",travel_date:t.travel_date,booking_date:t.booking_date,agent_id:t.agent_id||"",free_tickets:((p=t.free_tickets)==null?void 0:p.toString())||"0",other_charges:((z=t.other_charges)==null?void 0:z.toString())||"0",upgrade_from:t.upgrade_from||"",upgrade_to:t.upgrade_to||"",upgrade_cost:((P=t.upgrade_cost)==null?void 0:P.toString())||"0",upgrade_members:t.upgrade_members||"",total_amount:((F=t.total_amount)==null?void 0:F.toString())||"0",discount_percentage:((R=t.discount_percentage)==null?void 0:R.toString())||"0",net_amount:((w=t.net_amount)==null?void 0:w.toString())||"0",paid_amount:((A=t.paid_amount)==null?void 0:A.toString())||"0",balance:((V=t.balance)==null?void 0:V.toString())||"0",status:t.status,payment_status:t.payment_status,payment_mode:t.payment_mode||"",notes:t.notes||""}),l(!0)},q=t=>{var c;return((c=u.find(p=>p.id===t))==null?void 0:c.yacht_name)||"N/A"},N={confirmed:"bg-green-100 text-green-700",cancelled:"bg-red-100 text-red-700",completed:"bg-blue-100 text-blue-700",pending:"bg-yellow-100 text-yellow-700"},b={paid:"bg-green-100 text-green-700",partial:"bg-yellow-100 text-yellow-700",unpaid:"bg-red-100 text-red-700"};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Private Bookings"}),e.jsx("p",{className:"text-gray-600",children:"Manage private yacht bookings"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"New Booking"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Ticket #"}),e.jsx(C,{children:"Customer"}),e.jsx(C,{children:"Yacht"}),e.jsx(C,{children:"Travel Date"}),e.jsx(C,{children:"Guests"}),e.jsx(C,{children:"Net Amount"}),e.jsx(C,{children:"Paid"}),e.jsx(C,{children:"Balance"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Payment"}),e.jsx(C,{children:"Actions"})]})}),e.jsx(ue,{children:O.map(t=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:t.ticket_number}),e.jsx(S,{children:t.customer_name}),e.jsx(S,{children:q(t.yacht_id)}),e.jsx(S,{children:t.travel_date}),e.jsx(S,{children:t.number_of_people}),e.jsxs(S,{className:"font-semibold",children:["$",t.net_amount]}),e.jsxs(S,{children:["$",t.paid_amount]}),e.jsxs(S,{className:t.balance>0?"text-red-600 font-semibold":"",children:["$",t.balance]}),e.jsx(S,{children:e.jsx(X,{className:N[t.status],children:t.status})}),e.jsx(S,{children:e.jsx(X,{className:b[t.payment_status],children:t.payment_status})}),e.jsx(S,{children:e.jsx(E,{size:"sm",variant:"outline",onClick:()=>v(t),children:e.jsx(Qe,{className:"w-4 h-4"})})})]},t.id))})]})}),O.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(be,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No private bookings yet"}),e.jsx("p",{className:"text-gray-500",children:"Create your first private booking"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Booking":"New Private Booking"})}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Ticket Number *"}),e.jsx(_,{value:s.ticket_number,onChange:t=>o({...s,ticket_number:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Yacht *"}),e.jsxs(Y,{value:s.yacht_id,onValueChange:t=>o({...s,yacht_id:t}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select yacht"})}),e.jsx(Q,{children:u.map(t=>e.jsx(h,{value:t.id,children:t.yacht_name},t.id))})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Number of People *"}),e.jsx(_,{type:"number",value:s.number_of_people,onChange:t=>o({...s,number_of_people:t.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Customer Name *"}),e.jsx(_,{value:s.customer_name,onChange:t=>o({...s,customer_name:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone *"}),e.jsx(_,{value:s.customer_phone,onChange:t=>o({...s,customer_phone:t.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Email"}),e.jsx(_,{type:"email",value:s.customer_email,onChange:t=>o({...s,customer_email:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Travel Date *"}),e.jsx(_,{type:"date",value:s.travel_date,onChange:t=>o({...s,travel_date:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Booking Date"}),e.jsx(_,{type:"date",value:s.booking_date,onChange:t=>o({...s,booking_date:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Agent (Optional)"}),e.jsxs(Y,{value:s.agent_id,onValueChange:t=>o({...s,agent_id:t}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Direct"})}),e.jsx(Q,{children:d.map(t=>e.jsx(h,{value:t.id,children:t.agent_name},t.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Free Tickets"}),e.jsx(_,{type:"number",value:s.free_tickets,onChange:t=>o({...s,free_tickets:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Other Charges"}),e.jsx(_,{type:"number",step:"0.01",value:s.other_charges,onChange:t=>o({...s,other_charges:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Total Amount *"}),e.jsx(_,{type:"number",step:"0.01",value:s.total_amount,onChange:t=>o({...s,total_amount:t.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Discount %"}),e.jsx(_,{type:"number",step:"0.01",value:s.discount_percentage,onChange:t=>o({...s,discount_percentage:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Net Amount"}),e.jsx(_,{type:"number",step:"0.01",value:s.net_amount,readOnly:!0,className:"bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Paid Amount"}),e.jsx(_,{type:"number",step:"0.01",value:s.paid_amount,onChange:t=>o({...s,paid_amount:t.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Balance"}),e.jsx(_,{type:"number",step:"0.01",value:s.balance,readOnly:!0,className:"bg-gray-50"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:s.status,onValueChange:t=>o({...s,status:t}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"confirmed",children:"Confirmed"}),e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"completed",children:"Completed"}),e.jsx(h,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Status"}),e.jsxs(Y,{value:s.payment_status,onValueChange:t=>o({...s,payment_status:t}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"paid",children:"Paid"}),e.jsx(h,{value:"partial",children:"Partial"}),e.jsx(h,{value:"unpaid",children:"Unpaid"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Mode"}),e.jsxs(Y,{value:s.payment_mode,onValueChange:t=>o({...s,payment_mode:t}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select"})}),e.jsxs(Q,{children:[e.jsx(h,{value:"cash",children:"Cash"}),e.jsx(h,{value:"card",children:"Card"}),e.jsx(h,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(h,{value:"online",children:"Online"}),e.jsx(h,{value:"other",children:"Other"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(ve,{value:s.notes,onChange:t=>o({...s,notes:t.target.value}),rows:3})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:m,children:"Cancel"}),e.jsxs(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[a?"Update":"Create"," Booking"]})]})]})]})})]})})}function Yn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState(null),[x,O]=j.useState(!1),[u,d]=j.useState({ticket_number:`TKT-${Date.now()}`,customer_name:"",booking_date:new Date().toISOString().split("T")[0],travel_date:"",yacht_id:"",yacht_type:"shared",agent_id:"",booking_status:"confirmed",payment_status:"cash",guests:{adult:0,child:0,alcohol_adult:0,top_deck_child:0,top_deck_adult:0,top_deck_adult_alcohol:0,child_vip:0,adult_vip:0,adult_alcohol_vip:0,royal_child:0,royal_adult:0,royal_adult_alcohol:0},total_amount:"",agent_discount_percentage:"0",commission_amount:"0",net_amount:"",paid_amount:"0",balance:"",free_tickets:"0",additional_expenses:"0",notes:""}),D=ce(),{data:g=[]}=L({queryKey:["sharedBookings"],queryFn:async()=>(await k.entities.Booking.list("-created_date")).filter(K=>K.cruise_type==="shared")}),{data:m=[]}=L({queryKey:["yachts"],queryFn:()=>k.entities.Yacht.list()}),{data:f=[]}=L({queryKey:["agents"],queryFn:()=>k.entities.Agent.list()}),v=m.find(y=>y.id===u.yacht_id),q=Z({mutationFn:y=>k.entities.Booking.create(y),onSuccess:()=>{D.invalidateQueries(["sharedBookings"]),D.invalidateQueries(["bookings"]),b()}}),N=Z({mutationFn:({id:y,data:K})=>k.entities.Booking.update(y,K),onSuccess:()=>{D.invalidateQueries(["sharedBookings"]),D.invalidateQueries(["bookings"]),b()}});j.useEffect(()=>{if(v!=null&&v.shared_packages){const y=v.shared_packages;let K=0;Object.keys(u.guests).forEach(G=>{const te=parseInt(u.guests[G])||0,ee=parseFloat(y[G])||0;K+=te*ee}),d(G=>({...G,total_amount:K.toFixed(2)}))}},[u.guests,v]),j.useEffect(()=>{const y=parseFloat(u.total_amount)||0,K=parseFloat(u.agent_discount_percentage)||0,G=parseFloat(u.paid_amount)||0,te=y*K/100,ee=y-te,B=ee-G;d(se=>({...se,commission_amount:te.toFixed(2),net_amount:ee.toFixed(2),balance:B.toFixed(2)}))},[u.total_amount,u.agent_discount_percentage,u.paid_amount]);const b=()=>{d({ticket_number:`TKT-${Date.now()}`,customer_name:"",booking_date:new Date().toISOString().split("T")[0],travel_date:"",yacht_id:"",yacht_type:"shared",agent_id:"",booking_status:"confirmed",payment_status:"cash",guests:{adult:0,child:0,alcohol_adult:0,top_deck_child:0,top_deck_adult:0,top_deck_adult_alcohol:0,child_vip:0,adult_vip:0,adult_alcohol_vip:0,royal_child:0,royal_adult:0,royal_adult_alcohol:0},total_amount:"",agent_discount_percentage:"0",commission_amount:"0",net_amount:"",paid_amount:"0",balance:"",free_tickets:"0",additional_expenses:"0",notes:""}),r(null),l(!1)},t=y=>{y.preventDefault();const K=Object.values(u.guests).reduce((te,ee)=>te+(parseInt(ee)||0),0),G={ticket_number:u.ticket_number,customer_name:u.customer_name,booking_date:u.booking_date,travel_date:u.travel_date,yacht_id:u.yacht_id,cruise_type:u.yacht_type,package_type:JSON.stringify(u.guests),agent_id:u.agent_id||null,status:u.booking_status,payment_mode:u.payment_status,number_of_people:K,total_amount:parseFloat(u.total_amount)||0,discount_percentage:parseFloat(u.agent_discount_percentage)||0,net_amount:parseFloat(u.net_amount)||0,paid_amount:parseFloat(u.paid_amount)||0,balance:parseFloat(u.balance)||0,free_tickets:parseInt(u.free_tickets)||0,other_charges:parseFloat(u.additional_expenses)||0,notes:u.notes,payment_status:parseFloat(u.balance)<=0?"paid":parseFloat(u.paid_amount)>0?"partial":"unpaid"};a?N.mutate({id:a.id,data:G}):q.mutate(G)},c=y=>{o(y),O(!0)},p=y=>{let K={adult:0,child:0,alcohol_adult:0,top_deck_child:0,top_deck_adult:0,top_deck_adult_alcohol:0,child_vip:0,adult_vip:0,adult_alcohol_vip:0,royal_child:0,royal_adult:0,royal_adult_alcohol:0};try{y.package_type&&(K=JSON.parse(y.package_type))}catch{}const G=`
SHARED BOOKING REPORT
=====================================================

Ticket Number: ${y.ticket_number}
Booking Date: ${y.booking_date}
Travel Date: ${y.travel_date}

CLIENT INFORMATION
-----------------------------------------------------
Client Name: ${y.customer_name}
Phone: ${y.customer_phone||"N/A"}
Email: ${y.customer_email||"N/A"}

BOOKING DETAILS
-----------------------------------------------------
Yacht: ${F(y.yacht_id)}
Agent: ${R(y.agent_id)}
Total Guests: ${y.number_of_people}

GUEST BREAKDOWN
-----------------------------------------------------
Child: ${K.child}
Adult: ${K.adult}
Adult with Alcohol: ${K.alcohol_adult}
Top Deck Child: ${K.top_deck_child}
Top Deck Adult: ${K.top_deck_adult}
Top Deck Adult with Alcohol: ${K.top_deck_adult_alcohol}
VIP Child: ${K.child_vip}
VIP Adult: ${K.adult_vip}
VIP Adult with Alcohol: ${K.adult_alcohol_vip}
Royal Child: ${K.royal_child}
Royal Adult: ${K.royal_adult}
Royal Adult with Alcohol: ${K.royal_adult_alcohol}

PAYMENT DETAILS
-----------------------------------------------------
Total Amount: AED ${y.total_amount}
Discount: ${y.discount_percentage||0}%
Free Tickets: ${y.free_tickets||0}
Additional Charges: AED ${y.other_charges||0}
Net Amount: AED ${y.net_amount}
Paid Amount: AED ${y.paid_amount}
Balance: AED ${y.balance}
Payment Status: ${y.payment_status||"Unpaid"}
Payment Mode: ${y.payment_mode||"N/A"}

STATUS
-----------------------------------------------------
Booking Status: ${y.status}

NOTES
-----------------------------------------------------
${y.notes||"No notes"}

SYSTEM INFORMATION
-----------------------------------------------------
Created By: ${y.created_by}
Created Date: ${y.created_date}
Updated Date: ${y.updated_date}

=====================================================
Generated on: ${new Date().toLocaleString()}
    `,te=new Blob([G],{type:"text/plain"}),ee=window.URL.createObjectURL(te),B=document.createElement("a");B.href=ee,B.download=`booking_report_${y.ticket_number}.txt`,B.click()},z=y=>{r(y);let K={adult:0,child:0,alcohol_adult:0,top_deck_child:0,top_deck_adult:0,top_deck_adult_alcohol:0,child_vip:0,adult_vip:0,adult_alcohol_vip:0,royal_child:0,royal_adult:0,royal_adult_alcohol:0};try{y.package_type&&(K=JSON.parse(y.package_type))}catch{}d({ticket_number:y.ticket_number||"",customer_name:y.customer_name||"",booking_date:y.booking_date||"",travel_date:y.travel_date||"",yacht_id:y.yacht_id||"",yacht_type:y.cruise_type||"shared",agent_id:y.agent_id||"",booking_status:y.status||"confirmed",payment_status:y.payment_mode||"cash",guests:K,total_amount:(y.total_amount||0).toString(),agent_discount_percentage:(y.discount_percentage||0).toString(),commission_amount:((y.total_amount||0)*(y.discount_percentage||0)/100).toFixed(2),net_amount:(y.net_amount||0).toString(),paid_amount:(y.paid_amount||0).toString(),balance:(y.balance||0).toString(),free_tickets:(y.free_tickets||0).toString(),additional_expenses:(y.other_charges||0).toString(),notes:y.notes||""}),l(!0)},P=(y,K)=>{d({...u,guests:{...u.guests,[y]:K}})},F=y=>{var K;return((K=m.find(G=>G.id===y))==null?void 0:K.yacht_name)||"N/A"},R=y=>{var K;return((K=f.find(G=>G.id===y))==null?void 0:K.agent_name)||"Direct"},w=()=>{const y=[["Ticket","Client","Travel Date","Date of Booking","Yacht","Agent","Total Guest","Child","Adult","Adult Alc","Top Child","Top Adult","Top Alc Adult","VIP Child","VIP Adult","VIP Adult Alc","Royal Child","Royal Adult","Royal Adult Alc","Total","Rate","Free","Additional","Net","Discount","Commission","Balance","Paid","Notes","Update Date","User Details"],...g.map(ee=>{let B={adult:0,child:0,alcohol_adult:0,top_deck_child:0,top_deck_adult:0,top_deck_adult_alcohol:0,child_vip:0,adult_vip:0,adult_alcohol_vip:0,royal_child:0,royal_adult:0,royal_adult_alcohol:0};try{ee.package_type&&(B=JSON.parse(ee.package_type))}catch{}return[ee.ticket_number||"",ee.customer_name||"",ee.travel_date||"",ee.booking_date||"",F(ee.yacht_id),R(ee.agent_id),ee.number_of_people||0,B.child||0,B.adult||0,B.alcohol_adult||0,B.top_deck_child||0,B.top_deck_adult||0,B.top_deck_adult_alcohol||0,B.child_vip||0,B.adult_vip||0,B.adult_alcohol_vip||0,B.royal_child||0,B.royal_adult||0,B.royal_adult_alcohol||0,ee.total_amount||0,ee.discount_percentage||0,ee.free_tickets||0,ee.other_charges||0,ee.net_amount||0,ee.discount_percentage||0,ee.discount_percentage||0,ee.balance||0,ee.paid_amount||0,ee.notes||"",ee.updated_date||"",ee.created_by||""]})].map(ee=>ee.join(",")).join(`
`),K=new Blob([y],{type:"text/csv"}),G=window.URL.createObjectURL(K),te=document.createElement("a");te.href=G,te.download=`shared_bookings_${new Date().toISOString().split("T")[0]}.csv`,te.click()},A=async y=>{const K=y.target.files[0];if(!K)return;const te=(await K.text()).split(`
`).slice(1);for(const ee of te){if(!ee.trim())continue;const B=ee.split(","),[se,pe,je,_e,ke,Fe,Je,Xe,Ze,Va,Ka,Ua,Qa,Ya,Ha,Ga,Wa,Ja,Xa,Za,Bl,et,st,at,tt,zl,Is,Ts,ms]=B,Rs=m.find(gs=>gs.yacht_name===(ke==null?void 0:ke.trim()));if(!Rs)continue;const us=f.find(gs=>gs.agent_name===(Fe==null?void 0:Fe.trim())),nt={adult:parseInt(Ze)||0,child:parseInt(Xe)||0,alcohol_adult:parseInt(Va)||0,top_deck_child:parseInt(Ka)||0,top_deck_adult:parseInt(Ua)||0,top_deck_adult_alcohol:parseInt(Qa)||0,child_vip:parseInt(Ya)||0,adult_vip:parseInt(Ha)||0,adult_alcohol_vip:parseInt(Ga)||0,royal_child:parseInt(Wa)||0,royal_adult:parseInt(Ja)||0,royal_adult_alcohol:parseInt(Xa)||0},lt={ticket_number:se==null?void 0:se.trim(),customer_name:pe==null?void 0:pe.trim(),travel_date:je==null?void 0:je.trim(),booking_date:(_e==null?void 0:_e.trim())||new Date().toISOString().split("T")[0],yacht_id:Rs.id,agent_id:(us==null?void 0:us.id)||null,cruise_type:"shared",package_type:JSON.stringify(nt),number_of_people:parseInt(Je)||0,total_amount:parseFloat(Za)||0,discount_percentage:parseFloat(tt)||0,free_tickets:parseInt(et)||0,other_charges:parseFloat(st)||0,net_amount:parseFloat(at)||0,balance:parseFloat(Is)||0,paid_amount:parseFloat(Ts)||0,status:"confirmed",notes:(ms==null?void 0:ms.trim())||"",payment_status:parseFloat(Is)<=0?"paid":parseFloat(Ts)>0?"partial":"unpaid"};await k.entities.Booking.create(lt)}D.invalidateQueries(["sharedBookings"]),y.target.value=""},V={confirmed:"bg-green-100 text-green-700",cancelled:"bg-red-100 text-red-700",completed:"bg-blue-100 text-blue-700",pending:"bg-yellow-100 text-yellow-700"},M=[{key:"adult",label:"Adult"},{key:"child",label:"Child"},{key:"alcohol_adult",label:"Alcohol Adult"},{key:"top_deck_child",label:"Top Deck Child"},{key:"top_deck_adult",label:"Top Deck Adult"},{key:"top_deck_adult_alcohol",label:"Top Deck Adult (Alcohol)"},{key:"child_vip",label:"VIP Child"},{key:"adult_vip",label:"VIP Adult"},{key:"adult_alcohol_vip",label:"VIP Adult (Alcohol)"},{key:"royal_child",label:"Royal Child"},{key:"royal_adult",label:"Royal Adult"},{key:"royal_adult_alcohol",label:"Royal Adult (Alcohol)"}];return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Shared Bookings"}),e.jsx("p",{className:"text-gray-600",children:"Manage shared yacht bookings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(E,{onClick:w,variant:"outline",className:"border-green-600 text-green-600 hover:bg-green-50",children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsxs("label",{children:[e.jsxs(E,{type:"button",variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",onClick:()=>document.getElementById("import-bookings-file").click(),children:[e.jsx(Ds,{className:"w-4 h-4 mr-2"}),"Import"]}),e.jsx("input",{id:"import-bookings-file",type:"file",accept:".csv",onChange:A,className:"hidden"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"New Booking"]})]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0 overflow-x-auto",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Ticket #"}),e.jsx(C,{children:"Client"}),e.jsx(C,{children:"Travel Date"}),e.jsx(C,{children:"Yacht"}),e.jsx(C,{className:"text-center",children:"Guests"}),e.jsx(C,{className:"text-right",children:"Total"}),e.jsx(C,{className:"text-right",children:"Net"}),e.jsx(C,{className:"text-right",children:"Paid"}),e.jsx(C,{className:"text-right",children:"Balance"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-center",children:"Actions"})]})}),e.jsx(ue,{children:g.map(y=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:e.jsx("button",{onClick:()=>c(y),className:"text-blue-600 hover:text-blue-800 hover:underline",children:y.ticket_number})}),e.jsx(S,{children:y.customer_name||"N/A"}),e.jsx(S,{children:y.travel_date||"N/A"}),e.jsx(S,{children:F(y.yacht_id)}),e.jsx(S,{className:"text-center",children:y.number_of_people||0}),e.jsx(S,{className:"font-semibold text-right",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3"}),y.total_amount||0]})}),e.jsx(S,{className:"font-semibold text-right",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3"}),y.net_amount||0]})}),e.jsx(S,{className:"font-semibold text-right text-green-700",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3"}),y.paid_amount||0]})}),e.jsx(S,{className:"font-semibold text-right",children:e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3"}),y.balance||0]})}),e.jsx(S,{children:e.jsx(X,{className:V[y.status],children:y.status})}),e.jsx(S,{className:"text-center",children:e.jsx(E,{size:"sm",variant:"outline",onClick:()=>z(y),children:e.jsx(Qe,{className:"w-4 h-4"})})})]},y.id))})]}),g.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(ye,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No shared bookings yet"}),e.jsx("p",{className:"text-gray-500",children:"Create your first shared booking"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Booking":"New Shared Booking"})}),e.jsxs("form",{onSubmit:t,className:"space-y-6",children:[e.jsx(I,{children:e.jsxs(T,{className:"pt-6 space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Ticket Number *"}),e.jsx(_,{value:u.ticket_number,onChange:y=>d({...u,ticket_number:y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Client Name *"}),e.jsx(_,{value:u.customer_name,onChange:y=>d({...u,customer_name:y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Date of Booking *"}),e.jsx(_,{type:"date",value:u.booking_date,onChange:y=>d({...u,booking_date:y.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Travel Date *"}),e.jsx(_,{type:"date",value:u.travel_date,onChange:y=>d({...u,travel_date:y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Type of Yacht *"}),e.jsxs(Y,{value:u.yacht_type,onValueChange:y=>d({...u,yacht_type:y}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"shared",children:"Shared"}),e.jsx(h,{value:"private",children:"Private"}),e.jsx(h,{value:"sunset",children:"Sunset"}),e.jsx(h,{value:"new_year",children:"New Year"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Agent"}),e.jsxs(Y,{value:u.agent_id,onValueChange:y=>d({...u,agent_id:y}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Direct booking"})}),e.jsx(Q,{children:f.map(y=>e.jsx(h,{value:y.id,children:y.agent_name},y.id))})]})]})]})]})}),e.jsx(I,{children:e.jsxs(T,{className:"pt-6 space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Yacht Selection"}),e.jsxs("div",{children:[e.jsx(i,{children:"Yacht *"}),e.jsxs(Y,{value:u.yacht_id,onValueChange:y=>d({...u,yacht_id:y}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select yacht"})}),e.jsx(Q,{children:m.filter(y=>y.cruise_type==="shared").map(y=>e.jsx(h,{value:y.id,children:y.yacht_name},y.id))})]})]})]})}),(v==null?void 0:v.shared_packages)&&e.jsx(I,{children:e.jsxs(T,{className:"pt-6 space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Guest Details & Packages"}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:M.map(y=>{const K=v.shared_packages[y.key];return!K||K===0?null:e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx(i,{className:"text-sm",children:y.label}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(_,{type:"number",min:"0",value:u.guests[y.key],onChange:G=>P(y.key,G.target.value),placeholder:"0",className:"w-20"}),e.jsxs("span",{className:"text-sm text-gray-600 flex items-center gap-1",children:["@ ",e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3 inline-block"}),K]})]})]},y.key)})})]})}),e.jsx(I,{children:e.jsxs(T,{className:"pt-6 space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Pricing & Payment"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Total Amount (AED) *"}),e.jsx(_,{type:"number",step:"0.01",value:u.total_amount,readOnly:!0,className:"bg-gray-50 font-semibold"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Agent Discount (%)"}),e.jsx(_,{type:"number",step:"0.01",value:u.agent_discount_percentage,onChange:y=>d({...u,agent_discount_percentage:y.target.value})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"From selected agent"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Commission Amount (AED)"}),e.jsx(_,{type:"number",step:"0.01",value:u.commission_amount,readOnly:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Calculated value"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Net Amount (AED)"}),e.jsx(_,{type:"number",step:"0.01",value:u.net_amount,readOnly:!0,className:"bg-blue-50 font-semibold"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Total - Commission"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Paid Amount (AED)"}),e.jsx(_,{type:"number",step:"0.01",value:u.paid_amount,onChange:y=>d({...u,paid_amount:y.target.value})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Amount paid by client"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Balance Amount (AED)"}),e.jsx(_,{type:"number",step:"0.01",value:u.balance,readOnly:!0,className:"bg-red-50 font-semibold"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Net Amount - Paid"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Free Tickets"}),e.jsx(_,{type:"number",value:u.free_tickets,onChange:y=>d({...u,free_tickets:y.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Additional Expenses (AED)"}),e.jsx(_,{type:"number",step:"0.01",value:u.additional_expenses,onChange:y=>d({...u,additional_expenses:y.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Payment Status *"}),e.jsxs(Y,{value:u.payment_status,onValueChange:y=>d({...u,payment_status:y}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"cash",children:"Cash"}),e.jsx(h,{value:"card",children:"Card"}),e.jsx(h,{value:"credit",children:"Credit"}),e.jsx(h,{value:"nomode",children:"No Mode"}),e.jsx(h,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(h,{value:"cheques",children:"Cheques"})]})]})]})]})]})}),e.jsx(I,{children:e.jsxs(T,{className:"pt-6 space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Status & Notes"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(i,{children:"Booking Status *"}),e.jsxs(Y,{value:u.booking_status,onValueChange:y=>d({...u,booking_status:y}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"confirmed",children:"Confirmed"}),e.jsx(h,{value:"pending",children:"Pending"}),e.jsx(h,{value:"completed",children:"Completed"}),e.jsx(h,{value:"cancelled",children:"Cancelled"})]})]})]})}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(ve,{value:u.notes,onChange:y=>d({...u,notes:y.target.value}),rows:3})]})]})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:b,children:"Cancel"}),e.jsxs(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[a?"Update":"Create"," Booking"]})]})]})]})}),e.jsx(ie,{open:x,onOpenChange:O,children:e.jsxs(ne,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsxs(re,{children:["Booking Details - ",s==null?void 0:s.ticket_number]})}),s&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{children:e.jsx(T,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Client Name"}),e.jsx("p",{className:"font-semibold",children:s.customer_name})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Booking Date"}),e.jsx("p",{className:"font-semibold",children:s.booking_date})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Travel Date"}),e.jsx("p",{className:"font-semibold",children:s.travel_date})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Yacht"}),e.jsx("p",{className:"font-semibold",children:F(s.yacht_id)})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Agent"}),e.jsx("p",{className:"font-semibold",children:R(s.agent_id)})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Total Guests"}),e.jsx("p",{className:"font-semibold",children:s.number_of_people})]})]})})}),e.jsxs(I,{children:[e.jsx(W,{children:e.jsx(J,{className:"text-lg",children:"Guest Breakdown"})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-3 gap-4",children:(()=>{let y={adult:0,child:0,alcohol_adult:0,top_deck_child:0,top_deck_adult:0,top_deck_adult_alcohol:0,child_vip:0,adult_vip:0,adult_alcohol_vip:0,royal_child:0,royal_adult:0,royal_adult_alcohol:0};try{s.package_type&&(y=JSON.parse(s.package_type))}catch{}return Object.entries(y).map(([K,G])=>G>0?e.jsxs("div",{className:"border-l-4 border-blue-500 pl-3",children:[e.jsx(i,{className:"text-xs text-gray-600",children:K.replace(/_/g," ").toUpperCase()}),e.jsx("p",{className:"font-bold text-lg",children:G})]},K):null)})()})})]}),e.jsxs(I,{children:[e.jsx(W,{children:e.jsx(J,{className:"text-lg",children:"Payment Details"})}),e.jsx(T,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Total Amount"}),e.jsxs("p",{className:"font-semibold text-lg flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-4 h-4"}),s.total_amount||0]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Discount"}),e.jsxs("p",{className:"font-semibold",children:[s.discount_percentage||0,"%"]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Free Tickets"}),e.jsx("p",{className:"font-semibold",children:s.free_tickets||0})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Additional Charges"}),e.jsxs("p",{className:"font-semibold flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3"}),s.other_charges||0]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Net Amount"}),e.jsxs("p",{className:"font-semibold text-lg text-blue-700 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-4 h-4"}),s.net_amount]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Paid Amount"}),e.jsxs("p",{className:"font-semibold text-green-700 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-3 h-3"}),s.paid_amount]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Balance"}),e.jsxs("p",{className:"font-semibold text-lg text-red-700 flex items-center gap-1",children:[e.jsx("img",{src:"https://qtrypzzcjebvfcihiynt.supabase.co/storage/v1/object/public/base44-prod/public/6916e4a317df6f6f7ced1411/53f6fbda6_image.png",alt:"AED",className:"w-4 h-4"}),s.balance]})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-gray-600",children:"Payment Mode"}),e.jsx("p",{className:"font-semibold capitalize",children:s.payment_mode||"N/A"})]})]})})]}),s.notes&&e.jsxs(I,{children:[e.jsx(W,{children:e.jsx(J,{className:"text-lg",children:"Notes"})}),e.jsx(T,{children:e.jsx("p",{className:"text-gray-700",children:s.notes})})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsxs(E,{variant:"outline",onClick:()=>p(s),children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),"Download Report"]}),e.jsxs(E,{onClick:()=>{O(!1),z(s)},children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Edit Booking"]})]})]})]})})]})})}function Hn(){return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Catering"}),e.jsx("p",{className:"text-gray-600",children:"Manage catering services for bookings"})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-20 text-center",children:[e.jsx(oa,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"Catering Module"}),e.jsx("p",{className:"text-gray-500",children:"Coming soon"})]})})]})})}const rs=j.forwardRef(({className:n,...l},a)=>e.jsx(xa,{ref:a,className:$("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",n),...l,children:e.jsx(yt,{className:$("flex items-center justify-center text-current"),children:e.jsx(As,{className:"h-4 w-4"})})}));rs.displayName=xa.displayName;function Gn(){const[n,l]=j.useState(!1),[a,r]=j.useState(null),[s,o]=j.useState({client_name:"",phone:"",email:"",whatsapp_number:"",company_name:"",address:"",nationality:"",source:"website",client_type:"individual",discount_percentage:0,vip_status:!1,status:"active",notes:""}),x=ce(),{data:O=[]}=L({queryKey:["clients"],queryFn:()=>k.entities.Client.list("-created_date")}),u=Z({mutationFn:v=>k.entities.Client.create(v),onSuccess:()=>{x.invalidateQueries(["clients"]),g()}}),d=Z({mutationFn:({id:v,data:q})=>k.entities.Client.update(v,q),onSuccess:()=>{x.invalidateQueries(["clients"]),g()}}),D=Z({mutationFn:v=>k.entities.Client.delete(v),onSuccess:()=>{x.invalidateQueries(["clients"])}}),g=()=>{o({client_name:"",phone:"",email:"",whatsapp_number:"",company_name:"",address:"",nationality:"",source:"website",client_type:"individual",discount_percentage:0,vip_status:!1,status:"active",notes:""}),r(null),l(!1)},m=v=>{v.preventDefault();const q={...s,discount_percentage:parseFloat(s.discount_percentage)||0};a?d.mutate({id:a.id,data:q}):u.mutate(q)},f=v=>{r(v),o({client_name:v.client_name,phone:v.phone,email:v.email||"",whatsapp_number:v.whatsapp_number||"",company_name:v.company_name||"",address:v.address||"",nationality:v.nationality||"",source:v.source,client_type:v.client_type,discount_percentage:v.discount_percentage||0,vip_status:v.vip_status||!1,status:v.status,notes:v.notes||""}),l(!0)};return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Clients"}),e.jsx("p",{className:"text-gray-600",children:"Manage client information and preferences"})]}),e.jsxs(E,{onClick:()=>l(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Client"]})]}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Client Name"}),e.jsx(C,{children:"Contact"}),e.jsx(C,{children:"Type"}),e.jsx(C,{children:"Source"}),e.jsx(C,{children:"Discount"}),e.jsx(C,{children:"VIP"}),e.jsx(C,{children:"Status"}),e.jsx(C,{children:"Actions"})]})}),e.jsx(ue,{children:O.map(v=>e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:e.jsxs("div",{children:[e.jsx("p",{children:v.client_name}),v.company_name&&e.jsx("p",{className:"text-xs text-gray-500",children:v.company_name})]})}),e.jsx(S,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:v.phone}),v.email&&e.jsx("p",{className:"text-gray-500",children:v.email})]})}),e.jsx(S,{children:e.jsx(X,{className:"capitalize",children:v.client_type})}),e.jsx(S,{className:"capitalize",children:v.source}),e.jsxs(S,{children:[v.discount_percentage,"%"]}),e.jsx(S,{children:v.vip_status&&e.jsx(_t,{className:"w-5 h-5 text-yellow-500 fill-yellow-500"})}),e.jsx(S,{children:e.jsx(X,{className:v.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",children:v.status})}),e.jsx(S,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{size:"sm",variant:"outline",onClick:()=>f(v),children:e.jsx(Qe,{className:"w-4 h-4"})}),e.jsx(E,{size:"sm",variant:"outline",onClick:()=>D.mutate(v.id),className:"text-red-600 hover:text-red-700",children:e.jsx(Ie,{className:"w-4 h-4"})})]})})]},v.id))})]}),O.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(ye,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No clients yet"}),e.jsx("p",{className:"text-gray-500",children:"Add your first client"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(re,{children:a?"Edit Client":"New Client"})}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Client Name *"}),e.jsx(_,{value:s.client_name,onChange:v=>o({...s,client_name:v.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone *"}),e.jsx(_,{value:s.phone,onChange:v=>o({...s,phone:v.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Email"}),e.jsx(_,{type:"email",value:s.email,onChange:v=>o({...s,email:v.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"WhatsApp Number"}),e.jsx(_,{value:s.whatsapp_number,onChange:v=>o({...s,whatsapp_number:v.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Company Name"}),e.jsx(_,{value:s.company_name,onChange:v=>o({...s,company_name:v.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Nationality"}),e.jsx(_,{value:s.nationality,onChange:v=>o({...s,nationality:v.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Address"}),e.jsx(_,{value:s.address,onChange:v=>o({...s,address:v.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Client Type"}),e.jsxs(Y,{value:s.client_type,onValueChange:v=>o({...s,client_type:v}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"individual",children:"Individual"}),e.jsx(h,{value:"corporate",children:"Corporate"}),e.jsx(h,{value:"agent",children:"Agent"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Source"}),e.jsxs(Y,{value:s.source,onValueChange:v=>o({...s,source:v}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"website",children:"Website"}),e.jsx(h,{value:"whatsapp",children:"WhatsApp"}),e.jsx(h,{value:"agent",children:"Agent"}),e.jsx(h,{value:"instagram",children:"Instagram"}),e.jsx(h,{value:"facebook",children:"Facebook"}),e.jsx(h,{value:"referral",children:"Referral"}),e.jsx(h,{value:"repeat",children:"Repeat"}),e.jsx(h,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:s.status,onValueChange:v=>o({...s,status:v}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"inactive",children:"Inactive"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Discount Percentage"}),e.jsx(_,{type:"number",step:"0.01",value:s.discount_percentage,onChange:v=>o({...s,discount_percentage:v.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-6",children:[e.jsx(rs,{checked:s.vip_status,onCheckedChange:v=>o({...s,vip_status:v})}),e.jsx(i,{children:"VIP Client"})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Notes"}),e.jsx(ve,{value:s.notes,onChange:v=>o({...s,notes:v.target.value}),rows:3})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:g,children:"Cancel"}),e.jsxs(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:[a?"Update":"Create"," Client"]})]})]})]})})]})})}function Wn(){const[n,l]=j.useState(!1),[a,r]=j.useState(!1),[s,o]=j.useState(null),[x,O]=j.useState({designation:"",app_access:[],phone:"",department:"",status:"active"}),[u,d]=j.useState({email:"",full_name:"",designation:"",department:"",app_access:[],phone:"",role:"user"}),D=ce(),{data:g=[]}=L({queryKey:["users"],queryFn:()=>k.entities.User.list()}),{data:m}=L({queryKey:["currentUser"],queryFn:()=>k.auth.me()}),f=Z({mutationFn:({id:A,data:V})=>k.entities.User.update(A,V),onSuccess:()=>{D.invalidateQueries(["users"]),q()}}),v=Z({mutationFn:A=>k.entities.User.create(A),onSuccess:()=>{D.invalidateQueries(["users"]),N()}}),q=()=>{O({designation:"",app_access:[],phone:"",department:"",status:"active"}),o(null),l(!1)},N=()=>{d({email:"",full_name:"",designation:"",department:"",app_access:[],phone:"",role:"user"}),r(!1)},b=A=>{o(A),O({designation:A.designation||"",app_access:A.app_access||[],phone:A.phone||"",department:A.department||"",status:A.status||"active"}),l(!0)},t=A=>{A.preventDefault(),f.mutate({id:s.id,data:x})},c=A=>{const V=x.app_access.includes(A)?x.app_access.filter(M=>M!==A):[...x.app_access,A];O({...x,app_access:V})},p=A=>{const V=u.app_access.includes(A)?u.app_access.filter(M=>M!==A):[...u.app_access,A];d({...u,app_access:V})},z=A=>{A.preventDefault(),v.mutate(u)},P={owner:"bg-purple-100 text-purple-800",manager:"bg-blue-100 text-blue-800",sales_manager:"bg-green-100 text-green-800",sales_executive:"bg-teal-100 text-teal-800",accountant:"bg-yellow-100 text-yellow-800",inventory_manager:"bg-orange-100 text-orange-800",hr_manager:"bg-pink-100 text-pink-800",pos_operator:"bg-indigo-100 text-indigo-800",operations_staff:"bg-gray-100 text-gray-800"},F={admin:"bg-red-100 text-red-800",user:"bg-blue-100 text-blue-800"},R=[{id:"crm",label:"CRM"},{id:"purchase",label:"Purchase & Inventory"},{id:"hrms",label:"HRMS & Payroll"},{id:"pos",label:"POS System"},{id:"accounts",label:"Accounts"}],w=(m==null?void 0:m.role)==="admin";return e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage user access and permissions"})]}),w&&e.jsxs(E,{onClick:()=>r(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:shadow-lg",children:[e.jsx(Nt,{className:"w-4 h-4 mr-2"}),"Create User"]})]}),!w&&e.jsx(I,{className:"mb-6 border-yellow-200 bg-yellow-50",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ns,{className:"w-5 h-5 text-yellow-600"}),e.jsx("p",{className:"text-yellow-900",children:"Only administrators can manage users"})]})})}),e.jsx(I,{className:"border-none shadow-lg",children:e.jsxs(T,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(he,{children:[e.jsx(me,{children:e.jsxs(ae,{className:"bg-gray-50",children:[e.jsx(C,{children:"Name"}),e.jsx(C,{children:"Email"}),e.jsx(C,{children:"Role"}),e.jsx(C,{children:"Designation"}),e.jsx(C,{children:"Department"}),e.jsx(C,{children:"App Access"}),e.jsx(C,{children:"Status"}),e.jsx(C,{className:"text-right",children:"Actions"})]})}),e.jsx(ue,{children:g.map(A=>{var V;return e.jsxs(ae,{className:"hover:bg-gray-50",children:[e.jsx(S,{className:"font-medium",children:A.full_name}),e.jsx(S,{children:A.email}),e.jsx(S,{children:e.jsx(X,{className:F[A.role],children:A.role})}),e.jsx(S,{children:A.designation?e.jsx(X,{className:P[A.designation],children:A.designation.replace("_"," ")}):e.jsx("span",{className:"text-gray-400",children:"Not set"})}),e.jsx(S,{className:"capitalize",children:A.department||"-"}),e.jsx(S,{children:e.jsx("div",{className:"flex gap-1 flex-wrap",children:((V=A.app_access)==null?void 0:V.length)>0?A.app_access.map(M=>e.jsx(X,{variant:"outline",className:"text-xs",children:M.toUpperCase()},M)):e.jsx("span",{className:"text-gray-400 text-sm",children:"No access"})})}),e.jsx(S,{children:e.jsx(X,{className:A.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:A.status||"active"})}),e.jsx(S,{className:"text-right",children:w&&e.jsxs(E,{size:"sm",variant:"outline",onClick:()=>b(A),children:[e.jsx(Ge,{className:"w-4 h-4 mr-1"}),"Edit"]})})]},A.id)})})]})}),g.length===0&&e.jsxs("div",{className:"text-center py-20",children:[e.jsx(ye,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"No users yet"}),e.jsx("p",{className:"text-gray-500",children:"Invite users through the platform"})]})]})}),e.jsx(ie,{open:n,onOpenChange:l,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Edit User Access & Permissions"})}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-blue-900 mb-1",children:[e.jsx("strong",{children:"User:"})," ",s==null?void 0:s.full_name]}),e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Email:"})," ",s==null?void 0:s.email]}),e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"System Role:"})," ",s==null?void 0:s.role]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Designation *"}),e.jsxs(Y,{value:x.designation,onValueChange:A=>O({...x,designation:A}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select designation"})}),e.jsxs(Q,{children:[e.jsx(h,{value:"owner",children:"Owner"}),e.jsx(h,{value:"manager",children:"Manager"}),e.jsx(h,{value:"sales_manager",children:"Sales Manager"}),e.jsx(h,{value:"sales_executive",children:"Sales Executive"}),e.jsx(h,{value:"accountant",children:"Accountant"}),e.jsx(h,{value:"inventory_manager",children:"Inventory Manager"}),e.jsx(h,{value:"hr_manager",children:"HR Manager"}),e.jsx(h,{value:"pos_operator",children:"POS Operator"}),e.jsx(h,{value:"operations_staff",children:"Operations Staff"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Department"}),e.jsxs(Y,{value:x.department,onValueChange:A=>O({...x,department:A}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select department"})}),e.jsxs(Q,{children:[e.jsx(h,{value:"sales",children:"Sales"}),e.jsx(h,{value:"operations",children:"Operations"}),e.jsx(h,{value:"accounts",children:"Accounts"}),e.jsx(h,{value:"hr",children:"HR"}),e.jsx(h,{value:"inventory",children:"Inventory"}),e.jsx(h,{value:"management",children:"Management"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Phone"}),e.jsx(_,{value:x.phone,onChange:A=>O({...x,phone:A.target.value}),placeholder:"+971 50 123 4567"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Application Access *"}),e.jsx(I,{className:"mt-2",children:e.jsx(T,{className:"p-4 space-y-3",children:R.map(A=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(rs,{id:A.id,checked:x.app_access.includes(A.id),onCheckedChange:()=>c(A.id)}),e.jsx("label",{htmlFor:A.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:A.label})]},A.id))})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Status"}),e.jsxs(Y,{value:x.status,onValueChange:A=>O({...x,status:A}),children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"active",children:"Active"}),e.jsx(h,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:q,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Update User"})]})]})]})}),e.jsx(ie,{open:a,onOpenChange:r,children:e.jsxs(ne,{className:"max-w-2xl",children:[e.jsx(le,{children:e.jsx(re,{children:"Create New User"})}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Full Name *"}),e.jsx(_,{value:u.full_name,onChange:A=>d({...u,full_name:A.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Email *"}),e.jsx(_,{type:"email",value:u.email,onChange:A=>d({...u,email:A.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Designation *"}),e.jsxs(Y,{value:u.designation,onValueChange:A=>d({...u,designation:A}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select designation"})}),e.jsxs(Q,{children:[e.jsx(h,{value:"owner",children:"Owner"}),e.jsx(h,{value:"manager",children:"Manager"}),e.jsx(h,{value:"sales_manager",children:"Sales Manager"}),e.jsx(h,{value:"sales_executive",children:"Sales Executive"}),e.jsx(h,{value:"accountant",children:"Accountant"}),e.jsx(h,{value:"inventory_manager",children:"Inventory Manager"}),e.jsx(h,{value:"hr_manager",children:"HR Manager"}),e.jsx(h,{value:"pos_operator",children:"POS Operator"}),e.jsx(h,{value:"operations_staff",children:"Operations Staff"})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Department"}),e.jsxs(Y,{value:u.department,onValueChange:A=>d({...u,department:A}),children:[e.jsx(U,{children:e.jsx(H,{placeholder:"Select department"})}),e.jsxs(Q,{children:[e.jsx(h,{value:"sales",children:"Sales"}),e.jsx(h,{value:"operations",children:"Operations"}),e.jsx(h,{value:"accounts",children:"Accounts"}),e.jsx(h,{value:"hr",children:"HR"}),e.jsx(h,{value:"inventory",children:"Inventory"}),e.jsx(h,{value:"management",children:"Management"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Phone"}),e.jsx(_,{value:u.phone,onChange:A=>d({...u,phone:A.target.value}),placeholder:"+971 50 123 4567"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"System Role *"}),e.jsxs(Y,{value:u.role,onValueChange:A=>d({...u,role:A}),required:!0,children:[e.jsx(U,{children:e.jsx(H,{})}),e.jsxs(Q,{children:[e.jsx(h,{value:"user",children:"User"}),e.jsx(h,{value:"admin",children:"Admin"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Application Access *"}),e.jsx(I,{className:"mt-2",children:e.jsx(T,{className:"p-4 space-y-3",children:R.map(A=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(rs,{id:`create-${A.id}`,checked:u.app_access.includes(A.id),onCheckedChange:()=>p(A.id)}),e.jsx("label",{htmlFor:`create-${A.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:A.label})]},A.id))})})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(E,{type:"button",variant:"outline",onClick:N,children:"Cancel"}),e.jsx(E,{type:"submit",className:"bg-blue-600 hover:bg-blue-700",children:"Create User"})]})]})]})})]})})}function Jn(){var v,q;const[n,l]=j.useState(null),[a,r]=j.useState(""),[s,o]=j.useState(!1),x=ce(),{data:O}=L({queryKey:["currentUser"],queryFn:()=>k.auth.me()}),{data:u=[]}=L({queryKey:["appSettings"],queryFn:async()=>await k.entities.AppSettings.list()}),d=Z({mutationFn:async({key:N,value:b})=>{const t=u.find(c=>c.setting_key===N);return t?k.entities.AppSettings.update(t.id,{setting_value:b}):k.entities.AppSettings.create({setting_key:N,setting_value:b})},onSuccess:()=>{x.invalidateQueries(["appSettings"])}}),D=(v=u.find(N=>N.setting_key==="app_logo"))==null?void 0:v.setting_value,g=((q=u.find(N=>N.setting_key==="app_name"))==null?void 0:q.setting_value)||"YachtFlow",m=async()=>{if(n){o(!0);try{const{file_url:N}=await k.integrations.Core.UploadFile({file:n});await d.mutateAsync({key:"app_logo",value:N}),l(null)}catch(N){console.error("Upload failed:",N)}o(!1)}},f=async()=>{a&&(await d.mutateAsync({key:"app_name",value:a}),r(""))};return(O==null?void 0:O.role)!=="admin"?e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-red-600",children:"Access Denied - Admin Only"})}):e.jsx("div",{className:"p-4 md:p-8 bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"App Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage application branding and configuration"})]}),e.jsxs(I,{className:"border-none shadow-lg",children:[e.jsx(W,{children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(wt,{className:"w-5 h-5"}),"Application Logo"]})}),e.jsxs(T,{className:"space-y-4",children:[D&&e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx(i,{className:"text-sm text-gray-600 mb-2 block",children:"Current Logo"}),e.jsx("img",{src:D,alt:"App Logo",className:"h-16 object-contain"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Upload New Logo"}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx(_,{type:"file",accept:"image/*",onChange:N=>l(N.target.files[0])}),e.jsxs(E,{onClick:m,disabled:!n||s,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ds,{className:"w-4 h-4 mr-2"}),s?"Uploading...":"Upload"]})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Recommended: PNG or SVG, max 200px height"})]})]})]}),e.jsxs(I,{className:"border-none shadow-lg",children:[e.jsx(W,{children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"w-5 h-5"}),"Application Name"]})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx(i,{className:"text-sm text-gray-600 mb-2 block",children:"Current Name"}),e.jsx("p",{className:"text-xl font-bold",children:g})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Change Application Name"}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx(_,{value:a,onChange:N=>r(N.target.value),placeholder:"Enter new app name"}),e.jsx(E,{onClick:f,disabled:!a,className:"bg-blue-600 hover:bg-blue-700",children:"Save"})]})]})]})]}),e.jsxs(I,{className:"border-none shadow-lg opacity-50",children:[e.jsx(W,{children:e.jsx(J,{children:"Color Theme"})}),e.jsx(T,{children:e.jsx("p",{className:"text-gray-500",children:"Coming soon - customize app colors"})})]})]})})}const ws=768;function Xn(){const[n,l]=j.useState(void 0);return j.useEffect(()=>{const a=window.matchMedia(`(max-width: ${ws-1}px)`),r=()=>{l(window.innerWidth<ws)};return a.addEventListener("change",r),l(window.innerWidth<ws),()=>a.removeEventListener("change",r)},[]),!!n}const Sa=j.forwardRef(({className:n,orientation:l="horizontal",decorative:a=!0,...r},s)=>e.jsx(ha,{ref:s,decorative:a,orientation:l,className:$("shrink-0 bg-border",l==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",n),...r}));Sa.displayName=ha.displayName;const Zn=aa,el=ea,ka=j.forwardRef(({className:n,...l},a)=>e.jsx(is,{className:$("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n),...l,ref:a}));ka.displayName=is.displayName;const sl=Le("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Aa=j.forwardRef(({side:n="right",className:l,children:a,...r},s)=>e.jsxs(el,{children:[e.jsx(ka,{}),e.jsxs(cs,{ref:s,className:$(sl({side:n}),l),...r,children:[e.jsxs(sa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),a]})]}));Aa.displayName=cs.displayName;const al=j.forwardRef(({className:n,...l},a)=>e.jsx(ds,{ref:a,className:$("text-lg font-semibold text-foreground",n),...l}));al.displayName=ds.displayName;const tl=j.forwardRef(({className:n,...l},a)=>e.jsx(os,{ref:a,className:$("text-sm text-muted-foreground",n),...l}));tl.displayName=os.displayName;function Vs({className:n,...l}){return e.jsx("div",{className:$("animate-pulse rounded-md bg-primary/10",n),...l})}const nl=kt,ll=At,rl=Dt,Da=j.forwardRef(({className:n,sideOffset:l=4,...a},r)=>e.jsx(St,{children:e.jsx(ma,{ref:r,sideOffset:l,className:$("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...a})}));Da.displayName=ma.displayName;const il="sidebar_state",cl=3600*24*7,dl="16rem",ol="18rem",xl="3rem",hl="b",Fa=j.createContext(null);function hs(){const n=j.useContext(Fa);if(!n)throw new Error("useSidebar must be used within a SidebarProvider.");return n}const Oa=j.forwardRef(({defaultOpen:n=!0,open:l,onOpenChange:a,className:r,style:s,children:o,...x},O)=>{const u=Xn(),[d,D]=j.useState(!1),[g,m]=j.useState(n),f=l??g,v=j.useCallback(t=>{const c=typeof t=="function"?t(f):t;a?a(c):m(c),document.cookie=`${il}=${c}; path=/; max-age=${cl}`},[a,f]),q=j.useCallback(()=>u?D(t=>!t):v(t=>!t),[u,v,D]);j.useEffect(()=>{const t=c=>{c.key===hl&&(c.metaKey||c.ctrlKey)&&(c.preventDefault(),q())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[q]);const N=f?"expanded":"collapsed",b=j.useMemo(()=>({state:N,open:f,setOpen:v,isMobile:u,openMobile:d,setOpenMobile:D,toggleSidebar:q}),[N,f,v,u,d,D,q]);return e.jsx(Fa.Provider,{value:b,children:e.jsx(nl,{delayDuration:0,children:e.jsx("div",{style:{"--sidebar-width":dl,"--sidebar-width-icon":xl,...s},className:$("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",r),ref:O,...x,children:o})})})});Oa.displayName="SidebarProvider";const qa=j.forwardRef(({side:n="left",variant:l="sidebar",collapsible:a="offcanvas",className:r,children:s,...o},x)=>{const{isMobile:O,state:u,openMobile:d,setOpenMobile:D}=hs();return a==="none"?e.jsx("div",{className:$("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",r),ref:x,...o,children:s}):O?e.jsx(Zn,{open:d,onOpenChange:D,...o,children:e.jsx(Aa,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":ol},side:n,children:e.jsx("div",{className:"flex h-full w-full flex-col",children:s})})}):e.jsxs("div",{ref:x,className:"group peer hidden text-sidebar-foreground md:block","data-state":u,"data-collapsible":u==="collapsed"?a:"","data-variant":l,"data-side":n,children:[e.jsx("div",{className:$("relative h-svh w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180",l==="floating"||l==="inset"?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),e.jsx("div",{className:$("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex",n==="left"?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",l==="floating"||l==="inset"?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",r),...o,children:e.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:s})})]})});qa.displayName="Sidebar";const Ea=j.forwardRef(({className:n,onClick:l,asChild:a=!1,...r},s)=>{const{toggleSidebar:o}=hs();return e.jsx(E,{ref:s,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:$("h-7 w-7",n),onClick:x=>{l==null||l(x),o()},asChild:a,...r,children:a?e.jsx(Ms,{}):e.jsxs(e.Fragment,{children:[e.jsx(Ms,{}),e.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})})});Ea.displayName="SidebarTrigger";const ml=j.forwardRef(({className:n,...l},a)=>{const{toggleSidebar:r}=hs();return e.jsx("button",{ref:a,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:$("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",n),...l})});ml.displayName="SidebarRail";const ul=j.forwardRef(({className:n,...l},a)=>e.jsx("main",{ref:a,className:$("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",n),...l}));ul.displayName="SidebarInset";const gl=j.forwardRef(({className:n,...l},a)=>e.jsx(_,{ref:a,"data-sidebar":"input",className:$("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",n),...l}));gl.displayName="SidebarInput";const Pa=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,"data-sidebar":"header",className:$("flex flex-col gap-2 p-2",n),...l}));Pa.displayName="SidebarHeader";const Ia=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,"data-sidebar":"footer",className:$("flex flex-col gap-2 p-2",n),...l}));Ia.displayName="SidebarFooter";const pl=j.forwardRef(({className:n,...l},a)=>e.jsx(Sa,{ref:a,"data-sidebar":"separator",className:$("mx-2 w-auto bg-sidebar-border",n),...l}));pl.displayName="SidebarSeparator";const Ta=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,"data-sidebar":"content",className:$("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",n),...l}));Ta.displayName="SidebarContent";const Ra=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,"data-sidebar":"group",className:$("relative flex w-full min-w-0 flex-col p-2",n),...l}));Ra.displayName="SidebarGroup";const jl=j.forwardRef(({className:n,asChild:l=!1,...a},r)=>{const s=l?ze:"div";return e.jsx(s,{ref:r,"data-sidebar":"group-label",className:$("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",n),...a})});jl.displayName="SidebarGroupLabel";const bl=j.forwardRef(({className:n,asChild:l=!1,...a},r)=>{const s=l?ze:"button";return e.jsx(s,{ref:r,"data-sidebar":"group-action",className:$("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",n),...a})});bl.displayName="SidebarGroupAction";const Ma=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,"data-sidebar":"group-content",className:$("w-full text-sm",n),...l}));Ma.displayName="SidebarGroupContent";const Ba=j.forwardRef(({className:n,...l},a)=>e.jsx("ul",{ref:a,"data-sidebar":"menu",className:$("flex w-full min-w-0 flex-col gap-1",n),...l}));Ba.displayName="SidebarMenu";const Cs=j.forwardRef(({className:n,...l},a)=>e.jsx("li",{ref:a,"data-sidebar":"menu-item",className:$("group/menu-item relative",n),...l}));Cs.displayName="SidebarMenuItem";const vl=Le("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),Ss=j.forwardRef(({asChild:n=!1,isActive:l=!1,variant:a="default",size:r="default",tooltip:s,className:o,...x},O)=>{const u=n?ze:"button",{isMobile:d,state:D}=hs(),g=e.jsx(u,{ref:O,"data-sidebar":"menu-button","data-size":r,"data-active":l,className:$(vl({variant:a,size:r}),o),...x});return s?(typeof s=="string"&&(s={children:s}),e.jsxs(ll,{children:[e.jsx(rl,{asChild:!0,children:g}),e.jsx(Da,{side:"right",align:"center",hidden:D!=="collapsed"||d,...s})]})):g});Ss.displayName="SidebarMenuButton";const fl=j.forwardRef(({className:n,asChild:l=!1,showOnHover:a=!1,...r},s)=>{const o=l?ze:"button";return e.jsx(o,{ref:s,"data-sidebar":"menu-action",className:$("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",a&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",n),...r})});fl.displayName="SidebarMenuAction";const yl=j.forwardRef(({className:n,...l},a)=>e.jsx("div",{ref:a,"data-sidebar":"menu-badge",className:$("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",n),...l}));yl.displayName="SidebarMenuBadge";const _l=j.forwardRef(({className:n,showIcon:l=!1,...a},r)=>{const s=j.useMemo(()=>`${Math.floor(Math.random()*40)+50}%`,[]);return e.jsxs("div",{ref:r,"data-sidebar":"menu-skeleton",className:$("flex h-8 items-center gap-2 rounded-md px-2",n),...a,children:[l&&e.jsx(Vs,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),e.jsx(Vs,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":s}})]})});_l.displayName="SidebarMenuSkeleton";const Nl=j.forwardRef(({className:n,...l},a)=>e.jsx("ul",{ref:a,"data-sidebar":"menu-sub",className:$("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",n),...l}));Nl.displayName="SidebarMenuSub";const wl=j.forwardRef(({...n},l)=>e.jsx("li",{ref:l,...n}));wl.displayName="SidebarMenuSubItem";const Cl=j.forwardRef(({asChild:n=!1,size:l="md",isActive:a,className:r,...s},o)=>{const x=n?ze:"a";return e.jsx(x,{ref:o,"data-sidebar":"menu-sub-button","data-size":l,"data-active":a,className:$("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",l==="sm"&&"text-xs",l==="md"&&"text-sm","group-data-[collapsible=icon]:hidden",r),...s})});Cl.displayName="SidebarMenuSubButton";const Sl=Ft,kl=Ot,Al=qt,Dl=[{title:"CRM",items:[{title:"Dashboard",url:"CRMDashboard",icon:Ce},{title:"Opportunity",url:"Opportunity",icon:Pt},{title:"Sales",icon:oe,subItems:[{title:"Private Bookings",url:"PrivateBookings",icon:be},{title:"Shared Bookings",url:"SharedBookings",icon:be}]},{title:"Clients",url:"Clients",icon:It},{title:"Agents",url:"Agents",icon:ye},{title:"Yachts & Packages",url:"Yachts",icon:De},{title:"Catering",url:"Catering",icon:oa},{title:"Sales Invoice",url:"Invoices",icon:fe}],pages:["CRMDashboard","Opportunity","PrivateBookings","SharedBookings","Clients","Agents","Yachts","Packages","Catering","Invoices"]},{title:"Purchase & Inventory",items:[{title:"Purchase Dashboard",url:"PurchaseDashboard",icon:Ce},{title:"Vendors",url:"Vendors",icon:Ne},{title:"Purchase Orders",url:"PurchaseOrders",icon:Oe},{title:"Inventory",url:"Inventory",icon:Ke}],pages:["PurchaseDashboard","Vendors","PurchaseOrders","Inventory"]},{title:"HRMS & Payroll",items:[{title:"HRM Dashboard",url:"HRMDashboard",icon:Ce},{title:"Employees",url:"Employees",icon:Re},{title:"Attendance",url:"Attendance",icon:Oe},{title:"Leaves",url:"Leaves",icon:be},{title:"Payroll",url:"Payroll",icon:ls}],pages:["HRMDashboard","Employees","Attendance","Leaves","Payroll"]},{title:"POS System",items:[{title:"POS Dashboard",url:"POSDashboard",icon:Ce},{title:"Restaurant POS",url:"RestaurantPOS",icon:qe},{title:"Bar POS",url:"BarPOS",icon:Me},{title:"POS Orders",url:"POSOrders",icon:fe}],pages:["POSDashboard","RestaurantPOS","BarPOS","POSOrders"]},{title:"Accounts",items:[{title:"Accounts Dashboard",url:"AccountsDashboard",icon:Ce},{title:"Ledger",url:"Ledger",icon:oe},{title:"Financial Reports",url:"FinancialReports",icon:fe}],pages:["AccountsDashboard","Ledger","FinancialReports"]},{title:"Administration",items:[{title:"User Management",url:"Users",icon:ns},{title:"App Settings",url:"AppSettings",icon:ns}],pages:["Users","AppSettings"]}];function Fl({children:n,currentPageName:l}){var m,f;const a=Es();Et();const[r,s]=j.useState(["Sales"]),{data:o=[]}=L({queryKey:["appSettings"],queryFn:()=>k.entities.AppSettings.list()}),x=(m=o.find(v=>v.setting_key==="app_logo"))==null?void 0:m.setting_value,O=((f=o.find(v=>v.setting_key==="app_name"))==null?void 0:f.setting_value)||"YachtFlow",u=v=>{s(q=>q.includes(v)?q.filter(N=>N!==v):[...q,v])},d=()=>{k.auth.logout()},D=a.pathname===de("Dashboard"),g=Dl.find(v=>v.pages.includes(l));return e.jsxs(Oa,{children:[e.jsx("style",{children:`
        :root {
          --ocean-blue: #0A2463;
          --ocean-teal: #247BA0;
          --ocean-light: #1E88E5;
          --sand: #F4E9CD;
          --white: #FFFFFF;
          --gray-50: #F8FAFC;
          --gray-100: #F1F5F9;
          --gray-200: #E2E8F0;
        }
        
        body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
      `}),e.jsxs("div",{className:"min-h-screen flex w-full bg-gradient-to-br from-gray-50 to-blue-50",children:[!D&&g&&e.jsxs(qa,{className:"border-r border-gray-200 bg-white",children:[e.jsx(Pa,{className:"border-b border-gray-100 p-6",children:e.jsxs(ge,{to:de("Dashboard"),className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[x?e.jsx("img",{src:x,alt:O,className:"h-12 object-contain"}):e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-800 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(De,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-xl text-gray-900",children:O}),e.jsx("p",{className:"text-xs text-gray-500",children:g.title})]})]})}),e.jsx(Ta,{className:"p-3",children:e.jsx(Ra,{children:e.jsx(Ma,{children:e.jsx(Ba,{children:g.items.map(v=>{if(v.subItems)return e.jsxs(Sl,{open:r.includes(v.title),onOpenChange:()=>u(v.title),children:[e.jsxs(kl,{className:"flex items-center justify-between w-full px-3 py-2.5 rounded-lg hover:bg-blue-50 hover:text-blue-700 transition-colors mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v.icon,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"font-medium text-sm",children:v.title})]}),e.jsx(ks,{className:`w-4 h-4 transition-transform ${r.includes(v.title)?"rotate-180":""}`})]}),e.jsx(Al,{className:"ml-4 mt-1",children:v.subItems.map(N=>{const b=a.pathname===de(N.url);return e.jsx(Cs,{children:e.jsx(Ss,{asChild:!0,className:`rounded-lg mb-1 transition-all duration-200 ${b?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-md":"hover:bg-blue-50 hover:text-blue-700"}`,children:e.jsxs(ge,{to:de(N.url),className:"flex items-center gap-3 px-3 py-2",children:[e.jsx(N.icon,{className:`w-4 h-4 ${b?"text-white":"text-gray-500"}`}),e.jsx("span",{className:"font-medium text-sm",children:N.title})]})})},N.title)})})]},v.title);const q=a.pathname===de(v.url);return e.jsx(Cs,{children:e.jsx(Ss,{asChild:!0,className:`rounded-lg mb-1 transition-all duration-200 ${q?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-md":"hover:bg-blue-50 hover:text-blue-700"}`,children:e.jsxs(ge,{to:de(v.url),className:"flex items-center gap-3 px-3 py-2.5",children:[e.jsx(v.icon,{className:`w-4 h-4 ${q?"text-white":"text-gray-500"}`}),e.jsx("span",{className:"font-medium text-sm",children:v.title})]})})},v.title)})})})})}),e.jsx(Ia,{className:"border-t border-gray-100 p-4",children:e.jsxs("button",{onClick:d,className:"flex items-center gap-3 w-full px-3 py-2.5 rounded-lg hover:bg-red-50 hover:text-red-600 transition-colors text-gray-600",children:[e.jsx(Tt,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Logout"})]})})]}),e.jsxs("main",{className:"flex-1 flex flex-col",children:[!D&&g&&e.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4 md:hidden shadow-sm",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ea,{className:"hover:bg-gray-100 p-2 rounded-lg transition-colors",children:e.jsx(Rt,{className:"w-5 h-5"})}),e.jsxs("h1",{className:"text-lg font-semibold text-gray-900",children:["YachtFlow - ",g.title]})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:n})]})]})]})}const Ol={Dashboard:on,Yachts:bn,Packages:vn,Agents:_n,Bookings:Nn,BarCounter:wn,Invoices:Cn,Vendors:Sn,PurchaseOrders:kn,Inventory:An,Employees:Dn,Attendance:Fn,Leaves:On,Payroll:qn,RestaurantPOS:En,BarPOS:Pn,POSOrders:In,Ledger:Tn,FinancialReports:Rn,CRMDashboard:Mn,HRMDashboard:Bn,PurchaseDashboard:zn,AccountsDashboard:Ln,POSDashboard:$n,Opportunity:Un,PrivateBookings:Qn,SharedBookings:Yn,Catering:Hn,Clients:Gn,Users:Wn,AppSettings:Jn},za={mainPage:"Dashboard",Pages:Ol,Layout:Fl};function ql(){const n=Es(),{isAuthenticated:l}=_a(),{Pages:a,mainPage:r}=za,s=r;return j.useEffect(()=>{var o;(o=window.parent)==null||o.postMessage({type:"app_changed_url",url:window.location.href},"*")},[n]),j.useEffect(()=>{const o=n.pathname;let x;if(o==="/"||o==="")x=s;else{const O=o.replace(/^\//,"").split("/")[0];x=Object.keys(a).find(D=>D.toLowerCase()===O.toLowerCase())||null}l&&x&&k.appLogs.logUserInApp(x).catch(()=>{})},[n,l,a,s]),null}function El({}){var s;const l=Es().pathname.substring(1),{data:a,isFetched:r}=L({queryKey:["user"],queryFn:async()=>{try{return{user:await k.auth.me(),isAuthenticated:!0}}catch{return{user:null,isAuthenticated:!1}}}});return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-6 bg-slate-50",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-7xl font-light text-slate-300",children:"404"}),e.jsx("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-2xl font-medium text-slate-800",children:"Page Not Found"}),e.jsxs("p",{className:"text-slate-600 leading-relaxed",children:["The page ",e.jsxs("span",{className:"font-medium text-slate-700",children:['"',l,'"']})," could not be found in this application."]})]}),r&&a.isAuthenticated&&((s=a.user)==null?void 0:s.role)==="admin"&&e.jsx("div",{className:"mt-8 p-4 bg-slate-100 rounded-lg border border-slate-200",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-orange-100 flex items-center justify-center mt-0.5",children:e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-400"})}),e.jsxs("div",{className:"text-left space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Admin Note"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:"This could mean that the AI hasn't implemented this page yet. Ask it to implement it in the chat."})]})]})}),e.jsx("div",{className:"pt-6",children:e.jsxs("button",{onClick:()=>window.location.href="/",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 hover:border-slate-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Go Home"]})})]})})})}const Pl=()=>e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-white to-slate-50",children:e.jsx("div",{className:"max-w-md w-full p-8 bg-white rounded-lg shadow-lg border border-slate-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 mb-6 rounded-full bg-orange-100",children:e.jsx("svg",{className:"w-8 h-8 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-4",children:"Access Restricted"}),e.jsx("p",{className:"text-slate-600 mb-8",children:"You are not registered to use this application. Please contact the app administrator to request access."}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-md text-sm text-slate-600",children:[e.jsx("p",{children:"If you believe this is an error, you can:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Verify you are logged in with the correct account"}),e.jsx("li",{children:"Contact the app administrator for access"}),e.jsx("li",{children:"Try logging out and back in again"})]})]})]})})}),{Pages:La,Layout:Ks,mainPage:Il}=za,$a=Il,Tl=La[$a],Us=({children:n,currentPageName:l})=>Ks?e.jsx(Ks,{currentPageName:l,children:n}):e.jsx(e.Fragment,{children:n}),Rl=()=>{const{isLoadingAuth:n,isLoadingPublicSettings:l,authError:a,isAuthenticated:r,navigateToLogin:s}=_a();if(l||n)return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin"})});if(a){if(a.type==="user_not_registered")return e.jsx(Pl,{});if(a.type==="auth_required")return s(),null}return e.jsxs(zt,{children:[e.jsx(ps,{path:"/",element:e.jsx(Us,{currentPageName:$a,children:e.jsx(Tl,{})})}),Object.entries(La).map(([o,x])=>e.jsx(ps,{path:`/${o}`,element:e.jsx(Us,{currentPageName:o,children:e.jsx(x,{})})},o)),e.jsx(ps,{path:"*",element:e.jsx(El,{})})]})};function Ml(){return e.jsx(rn,{children:e.jsxs(Mt,{client:nn,children:[e.jsxs(Bt,{children:[e.jsx(ql,{}),e.jsx(Rl,{})]}),e.jsx(tn,{}),e.jsx(ln,{})]})})}Lt.createRoot(document.getElementById("root")).render(e.jsx(Ml,{}));
